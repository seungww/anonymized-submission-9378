=== Step2. Script Execution Started at Thu Jul 24 03:11:37 PM UTC 2025 ===
Base directory: meta-free-apps
Data prefix: meta
Output directory: output/meta-free-apps/step2
[INFO] pkt_dirlen → Best normalization: token
Running: python vrscanner.py --step2 --path meta-free-apps/meta-pkt_dirlen/meta-pkt_dirlen.csv --norm token --debug_path output/meta-free-apps/step2/step2_meta_pkt_dirlen.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_pkt_dirlen.csv
[2025-07-24 15:11:39,267] [INFO] Namespace(path=['meta-free-apps/meta-pkt_dirlen/meta-pkt_dirlen.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_dirlen.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_dirlen.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dirlen')
[2025-07-24 15:15:49,652] [INFO] Processed data from meta-free-apps/meta-pkt_dirlen/meta-pkt_dirlen.csv:
[2025-07-24 15:15:49,653] [INFO] (84492, 500)
[2025-07-24 15:15:49,653] [INFO] [['656' '-94' '52' ... '1432' '1432' '1432']
 ['423' '-87' '52' ... '52' '-242' '-141']
 ['423' '-87' '52' ... '52' '-40' '-40']
 ...
 ['242' '-87' '52' ... '1432' '1432' '1432']
 ['60' '-60' '52' ... '1432' '1432' '-52']
 ['64' '52' '52' ... '52' '355' '-87']]
[2025-07-24 15:16:39,291] [INFO] Feature 0 normalized using token
[2025-07-24 15:16:39,292] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 15:16:39,335] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2768, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 15:16:39,335] [INFO] Training...
[2025-07-24 15:17:03,212] [INFO] Epoch 1/5, ValAcc: 80.45%, TrainLoss: 2.5047, ValLoss: 0.8010, LR: 0.001
[2025-07-24 15:17:21,631] [INFO] Epoch 2/5, ValAcc: 87.68%, TrainLoss: 0.6916, ValLoss: 0.5249, LR: 0.001
[2025-07-24 15:17:45,157] [INFO] Epoch 3/5, ValAcc: 90.62%, TrainLoss: 0.4898, ValLoss: 0.3969, LR: 0.001
[2025-07-24 15:18:08,684] [INFO] Epoch 4/5, ValAcc: 91.04%, TrainLoss: 0.4035, ValLoss: 0.3769, LR: 0.001
[2025-07-24 15:18:32,324] [INFO] Epoch 5/5, ValAcc: 91.46%, TrainLoss: 0.3744, ValLoss: 0.3777, LR: 0.001
[2025-07-24 15:18:33,689] [INFO] Namespace(path=['meta-free-apps/meta-pkt_dirlen/meta-pkt_dirlen.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_dirlen.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_dirlen.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dirlen', name='pktdirlen_token_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.9170,0.9265,0.9454,0.9174
[2025-07-24 15:19:22,957] [INFO] Feature 0 normalized using token
[2025-07-24 15:19:22,957] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 15:19:22,995] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2768, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 15:19:22,995] [INFO] Training...
[2025-07-24 15:19:48,519] [INFO] Epoch 1/5, ValAcc: 83.81%, TrainLoss: 1.9858, ValLoss: 0.6646, LR: 0.001
[2025-07-24 15:20:14,066] [INFO] Epoch 2/5, ValAcc: 88.24%, TrainLoss: 0.5989, ValLoss: 0.4969, LR: 0.001
[2025-07-24 15:20:39,578] [INFO] Epoch 3/5, ValAcc: 89.70%, TrainLoss: 0.4853, ValLoss: 0.4639, LR: 0.001
[2025-07-24 15:21:05,145] [INFO] Epoch 4/5, ValAcc: 90.27%, TrainLoss: 0.4341, ValLoss: 0.4156, LR: 0.001
[2025-07-24 15:21:30,712] [INFO] Epoch 5/5, ValAcc: 90.39%, TrainLoss: 0.3957, ValLoss: 0.5329, LR: 0.001
[2025-07-24 15:21:33,129] [INFO] Namespace(path=['meta-free-apps/meta-pkt_dirlen/meta-pkt_dirlen.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_dirlen.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_dirlen.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dirlen', name='pktdirlen_token_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.9050,0.9129,0.9402,0.9039
[2025-07-24 15:22:22,340] [INFO] Feature 0 normalized using token
[2025-07-24 15:22:22,340] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 15:22:22,371] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2768, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 15:22:22,371] [INFO] Training...
[2025-07-24 15:22:47,008] [INFO] Epoch 1/5, ValAcc: 64.37%, TrainLoss: 3.2602, ValLoss: 1.3104, LR: 0.001
[2025-07-24 15:23:11,744] [INFO] Epoch 2/5, ValAcc: 85.28%, TrainLoss: 0.9443, ValLoss: 0.6070, LR: 0.001
[2025-07-24 15:23:36,986] [INFO] Epoch 3/5, ValAcc: 87.85%, TrainLoss: 0.5882, ValLoss: 0.5129, LR: 0.001
[2025-07-24 15:24:02,322] [INFO] Epoch 4/5, ValAcc: 89.75%, TrainLoss: 0.4851, ValLoss: 0.4327, LR: 0.001
[2025-07-24 15:24:27,815] [INFO] Epoch 5/5, ValAcc: 90.62%, TrainLoss: 0.4131, ValLoss: 0.3961, LR: 0.001
[2025-07-24 15:24:30,322] [INFO] Namespace(path=['meta-free-apps/meta-pkt_dirlen/meta-pkt_dirlen.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_dirlen.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_dirlen.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dirlen', name='pktdirlen_token_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.9063,0.9123,0.9311,0.9056
[2025-07-24 15:25:19,500] [INFO] Feature 0 normalized using token
[2025-07-24 15:25:19,500] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 15:25:19,534] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2768, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 15:25:19,534] [INFO] Training...
[2025-07-24 15:26:01,074] [INFO] Epoch 1/5, ValAcc: 73.11%, TrainLoss: 2.7366, ValLoss: 1.0083, LR: 0.001
[2025-07-24 15:26:45,559] [INFO] Epoch 2/5, ValAcc: 87.50%, TrainLoss: 0.7457, ValLoss: 0.4925, LR: 0.001
[2025-07-24 15:27:27,131] [INFO] Epoch 3/5, ValAcc: 89.98%, TrainLoss: 0.4720, ValLoss: 0.4076, LR: 0.001
[2025-07-24 15:28:08,702] [INFO] Epoch 4/5, ValAcc: 91.54%, TrainLoss: 0.3793, ValLoss: 0.3512, LR: 0.001
[2025-07-24 15:28:50,284] [INFO] Epoch 5/5, ValAcc: 92.11%, TrainLoss: 0.3324, ValLoss: 0.3404, LR: 0.001
[2025-07-24 15:28:54,966] [INFO] Namespace(path=['meta-free-apps/meta-pkt_dirlen/meta-pkt_dirlen.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_dirlen.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_dirlen.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dirlen', name='pktdirlen_token_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.9189,0.9263,0.9452,0.9184
[2025-07-24 15:29:44,055] [INFO] Feature 0 normalized using token
[2025-07-24 15:29:44,055] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 15:29:44,077] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2768, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 15:29:44,077] [INFO] Training...
[2025-07-24 15:30:05,699] [INFO] Epoch 1/5, ValAcc: 31.82%, TrainLoss: 3.6211, ValLoss: 2.5170, LR: 0.001
[2025-07-24 15:30:26,748] [INFO] Epoch 2/5, ValAcc: 67.83%, TrainLoss: 2.1545, ValLoss: 1.2721, LR: 0.001
[2025-07-24 15:30:47,502] [INFO] Epoch 3/5, ValAcc: 80.64%, TrainLoss: 1.2280, ValLoss: 0.8529, LR: 0.001
[2025-07-24 15:31:08,343] [INFO] Epoch 4/5, ValAcc: 84.40%, TrainLoss: 1.0431, ValLoss: 0.6693, LR: 0.001
[2025-07-24 15:31:29,061] [INFO] Epoch 5/5, ValAcc: 87.05%, TrainLoss: 0.7860, ValLoss: 0.5866, LR: 0.001
[2025-07-24 15:31:29,989] [INFO] Namespace(path=['meta-free-apps/meta-pkt_dirlen/meta-pkt_dirlen.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_dirlen.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_dirlen.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dirlen', name='pktdirlen_token_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.8674,0.8749,0.8954,0.8679
[2025-07-24 15:32:18,987] [INFO] Feature 0 normalized using token
[2025-07-24 15:32:18,988] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 15:32:19,015] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2768, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 15:32:19,015] [INFO] Training...
[2025-07-24 15:32:36,534] [INFO] Epoch 1/5, ValAcc: 29.55%, TrainLoss: 3.6770, ValLoss: 2.6346, LR: 0.001
[2025-07-24 15:33:01,256] [INFO] Epoch 2/5, ValAcc: 70.70%, TrainLoss: 2.0892, ValLoss: 1.2362, LR: 0.001
[2025-07-24 15:33:25,977] [INFO] Epoch 3/5, ValAcc: 81.07%, TrainLoss: 1.2262, ValLoss: 0.8021, LR: 0.001
[2025-07-24 15:33:41,764] [INFO] Epoch 4/5, ValAcc: 84.00%, TrainLoss: 0.8966, ValLoss: 0.6707, LR: 0.001
[2025-07-24 15:34:02,879] [INFO] Epoch 5/5, ValAcc: 85.53%, TrainLoss: 0.7473, ValLoss: 0.6040, LR: 0.001
[2025-07-24 15:34:04,371] [INFO] Namespace(path=['meta-free-apps/meta-pkt_dirlen/meta-pkt_dirlen.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_dirlen.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_dirlen.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dirlen', name='pktdirlen_token_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.8577,0.8667,0.8954,0.8580
[2025-07-24 15:34:05,138] [INFO] best(dirlen): gru, accuracy: 0.9170, f1: 0.9265, precision: 0.9454, recall: 0.9174
[INFO] pkt_dir → Best normalization: robust
Running: python vrscanner.py --step2 --path meta-free-apps/meta-pkt_dir/meta-pkt_dir.csv --norm robust --debug_path output/meta-free-apps/step2/step2_meta_pkt_dir.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_pkt_dir.csv
[2025-07-24 15:34:08,574] [INFO] Namespace(path=['meta-free-apps/meta-pkt_dir/meta-pkt_dir.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_dir.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_dir.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dir')
[2025-07-24 15:37:54,573] [INFO] Processed data from meta-free-apps/meta-pkt_dir/meta-pkt_dir.csv:
[2025-07-24 15:37:54,573] [INFO] (84492, 500)
[2025-07-24 15:37:54,573] [INFO] [['1' '-1' '1' ... '1' '1' '1']
 ['1' '-1' '1' ... '1' '-1' '-1']
 ['1' '-1' '1' ... '1' '-1' '-1']
 ...
 ['1' '-1' '1' ... '1' '1' '1']
 ['1' '-1' '1' ... '1' '1' '-1']
 ['1' '1' '1' ... '1' '1' '-1']]
[2025-07-24 15:38:10,974] [INFO] Feature 0 normalized using robust
[2025-07-24 15:38:10,974] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 15:38:11,012] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 15:38:11,012] [INFO] Training...
[2025-07-24 15:38:32,491] [INFO] Epoch 1/5, ValAcc: 10.66%, TrainLoss: 3.9960, ValLoss: 3.3746, LR: 0.001
[2025-07-24 15:38:53,339] [INFO] Epoch 2/5, ValAcc: 17.31%, TrainLoss: 3.2514, ValLoss: 2.9888, LR: 0.001
[2025-07-24 15:39:17,182] [INFO] Epoch 3/5, ValAcc: 22.84%, TrainLoss: 2.9722, ValLoss: 2.7758, LR: 0.001
[2025-07-24 15:39:40,892] [INFO] Epoch 4/5, ValAcc: 32.93%, TrainLoss: 2.6612, ValLoss: 2.3868, LR: 0.001
[2025-07-24 15:40:04,031] [INFO] Epoch 5/5, ValAcc: 35.08%, TrainLoss: 2.4670, ValLoss: 2.2535, LR: 0.001
[2025-07-24 15:40:05,399] [INFO] Namespace(path=['meta-free-apps/meta-pkt_dir/meta-pkt_dir.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_dir.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_dir.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dir', name='pktdir_robust_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.3486,0.3324,0.3931,0.3498
[2025-07-24 15:40:22,144] [INFO] Feature 0 normalized using robust
[2025-07-24 15:40:22,144] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 15:40:22,160] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 15:40:22,160] [INFO] Training...
[2025-07-24 15:40:51,612] [INFO] Epoch 1/5, ValAcc: 0.91%, TrainLoss: 4.5129, ValLoss: 4.5117, LR: 0.001
[2025-07-24 15:41:21,272] [INFO] Epoch 2/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 15:41:50,746] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 15:42:18,579] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 15:42:47,831] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 15:42:50,241] [INFO] Namespace(path=['meta-free-apps/meta-pkt_dir/meta-pkt_dir.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_dir.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_dir.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dir', name='pktdir_robust_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 15:43:06,797] [INFO] Feature 0 normalized using robust
[2025-07-24 15:43:06,797] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 15:43:06,811] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 15:43:06,811] [INFO] Training...
[2025-07-24 15:43:32,269] [INFO] Epoch 1/5, ValAcc: 0.98%, TrainLoss: 4.5122, ValLoss: 4.5120, LR: 0.001
[2025-07-24 15:43:58,015] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5114, ValLoss: 4.5119, LR: 0.001
[2025-07-24 15:44:23,358] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5120, LR: 0.001
[2025-07-24 15:44:48,649] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 15:45:14,442] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 15:45:16,893] [INFO] Namespace(path=['meta-free-apps/meta-pkt_dir/meta-pkt_dir.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_dir.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_dir.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dir', name='pktdir_robust_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 15:45:33,357] [INFO] Feature 0 normalized using robust
[2025-07-24 15:45:33,357] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 15:45:33,373] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 15:45:33,373] [INFO] Training...
[2025-07-24 15:46:17,008] [INFO] Epoch 1/5, ValAcc: 0.95%, TrainLoss: 4.5122, ValLoss: 4.5117, LR: 0.001
[2025-07-24 15:47:00,447] [INFO] Epoch 2/5, ValAcc: 0.91%, TrainLoss: 4.5112, ValLoss: 4.5123, LR: 0.001
[2025-07-24 15:47:44,161] [INFO] Epoch 3/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 15:48:27,870] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 15:49:11,561] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5107, ValLoss: 4.5122, LR: 0.0005
[2025-07-24 15:49:16,119] [INFO] Namespace(path=['meta-free-apps/meta-pkt_dir/meta-pkt_dir.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_dir.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_dir.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dir', name='pktdir_robust_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 15:49:32,291] [INFO] Feature 0 normalized using robust
[2025-07-24 15:49:32,291] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 15:49:32,303] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 15:49:32,304] [INFO] Training...
[2025-07-24 15:49:52,399] [INFO] Epoch 1/5, ValAcc: 4.32%, TrainLoss: 4.3221, ValLoss: 4.1097, LR: 0.001
[2025-07-24 15:50:12,925] [INFO] Epoch 2/5, ValAcc: 6.62%, TrainLoss: 4.0810, ValLoss: 3.9753, LR: 0.001
[2025-07-24 15:50:37,815] [INFO] Epoch 3/5, ValAcc: 8.21%, TrainLoss: 4.0694, ValLoss: 3.8906, LR: 0.001
[2025-07-24 15:51:00,037] [INFO] Epoch 4/5, ValAcc: 9.55%, TrainLoss: 3.8805, ValLoss: 3.7510, LR: 0.001
[2025-07-24 15:51:21,267] [INFO] Epoch 5/5, ValAcc: 6.50%, TrainLoss: 3.8161, ValLoss: 3.9387, LR: 0.001
[2025-07-24 15:51:22,188] [INFO] Namespace(path=['meta-free-apps/meta-pkt_dir/meta-pkt_dir.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_dir.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_dir.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dir', name='pktdir_robust_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0660,0.0371,0.0373,0.0663
[2025-07-24 15:51:38,269] [INFO] Feature 0 normalized using robust
[2025-07-24 15:51:38,269] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 15:51:38,282] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 15:51:38,282] [INFO] Training...
[2025-07-24 15:51:53,845] [INFO] Epoch 1/5, ValAcc: 1.14%, TrainLoss: 4.5130, ValLoss: 4.5119, LR: 0.001
[2025-07-24 15:52:09,452] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 15:52:25,162] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 15:52:41,182] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 15:53:05,703] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 15:53:07,185] [INFO] Namespace(path=['meta-free-apps/meta-pkt_dir/meta-pkt_dir.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_dir.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_dir.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dir', name='pktdir_robust_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 15:53:07,638] [INFO] best(dir): gru, accuracy: 0.3486, f1: 0.3324, precision: 0.3931, recall: 0.3498
[INFO] pkt_ts_rel → Best normalization: robust
Running: python vrscanner.py --step2 --path meta-free-apps/meta-pkt_ts_rel/meta-pkt_ts_rel.csv --norm robust --debug_path output/meta-free-apps/step2/step2_meta_pkt_ts_rel.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_pkt_ts_rel.csv
[2025-07-24 15:53:10,902] [INFO] Namespace(path=['meta-free-apps/meta-pkt_ts_rel/meta-pkt_ts_rel.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_ts_rel.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_ts_rel.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='rel')
[2025-07-24 15:58:39,565] [INFO] Processed data from meta-free-apps/meta-pkt_ts_rel/meta-pkt_ts_rel.csv:
[2025-07-24 15:58:39,565] [INFO] (84492, 500)
[2025-07-24 15:58:39,565] [INFO] [['0.000000' '0.004568' '0.007503' ... '35.966810' '35.966810'
  '35.966810']
 ['0.000000' '0.004434' '0.007847' ... '24.694136' '24.892737'
  '24.892920']
 ['0.000000' '0.004176' '0.006938' ... '18.650270' '18.653487'
  '18.654598']
 ...
 ['0.000000' '0.005527' '0.040338' ... '10.430344' '10.430345'
  '10.430346']
 ['0.000000' '0.004883' '0.009906' ... '10.663809' '10.663811'
  '10.664173']
 ['0.000000' '0.000003' '0.002250' ... '2.632245' '2.680117' '2.685423']]
[2025-07-24 15:58:53,759] [INFO] Feature 0 normalized using robust
[2025-07-24 15:58:53,760] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 15:58:53,806] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 15:58:53,806] [INFO] Training...
[2025-07-24 15:59:16,998] [INFO] Epoch 1/5, ValAcc: 8.98%, TrainLoss: 3.9577, ValLoss: 3.7475, LR: 0.001
[2025-07-24 15:59:33,233] [INFO] Epoch 2/5, ValAcc: 19.38%, TrainLoss: 3.4703, ValLoss: 3.2555, LR: 0.001
[2025-07-24 15:59:46,144] [INFO] Epoch 3/5, ValAcc: 23.01%, TrainLoss: 3.1964, ValLoss: 3.0805, LR: 0.001
[2025-07-24 16:00:01,223] [INFO] Epoch 4/5, ValAcc: 27.51%, TrainLoss: 2.9880, ValLoss: 2.8186, LR: 0.001
[2025-07-24 16:00:24,014] [INFO] Epoch 5/5, ValAcc: 30.08%, TrainLoss: 2.8437, ValLoss: 2.6888, LR: 0.001
[2025-07-24 16:00:25,373] [INFO] Namespace(path=['meta-free-apps/meta-pkt_ts_rel/meta-pkt_ts_rel.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_ts_rel.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_ts_rel.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='rel', name='pkttsrel_robust_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.3007,0.2863,0.3406,0.3009
[2025-07-24 16:00:39,847] [INFO] Feature 0 normalized using robust
[2025-07-24 16:00:39,848] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:00:39,880] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:00:39,880] [INFO] Training...
[2025-07-24 16:01:09,190] [INFO] Epoch 1/5, ValAcc: 17.70%, TrainLoss: 3.9013, ValLoss: 3.3556, LR: 0.001
[2025-07-24 16:01:38,474] [INFO] Epoch 2/5, ValAcc: 26.00%, TrainLoss: 3.2275, ValLoss: 2.9185, LR: 0.001
[2025-07-24 16:02:07,559] [INFO] Epoch 3/5, ValAcc: 31.80%, TrainLoss: 2.8992, ValLoss: 2.6594, LR: 0.001
[2025-07-24 16:02:37,169] [INFO] Epoch 4/5, ValAcc: 29.27%, TrainLoss: 2.7061, ValLoss: 2.7441, LR: 0.001
[2025-07-24 16:03:06,800] [INFO] Epoch 5/5, ValAcc: 35.31%, TrainLoss: 2.6170, ValLoss: 2.5099, LR: 0.001
[2025-07-24 16:03:09,214] [INFO] Namespace(path=['meta-free-apps/meta-pkt_ts_rel/meta-pkt_ts_rel.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_ts_rel.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_ts_rel.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='rel', name='pkttsrel_robust_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.3477,0.3433,0.4032,0.3480
[2025-07-24 16:03:23,719] [INFO] Feature 0 normalized using robust
[2025-07-24 16:03:23,719] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:03:23,742] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:03:23,742] [INFO] Training...
[2025-07-24 16:03:49,851] [INFO] Epoch 1/5, ValAcc: 8.99%, TrainLoss: 4.1156, ValLoss: 3.7408, LR: 0.001
[2025-07-24 16:04:14,901] [INFO] Epoch 2/5, ValAcc: 15.62%, TrainLoss: 3.6558, ValLoss: 3.4425, LR: 0.001
[2025-07-24 16:04:40,343] [INFO] Epoch 3/5, ValAcc: 19.09%, TrainLoss: 3.4349, ValLoss: 3.3063, LR: 0.001
[2025-07-24 16:05:05,998] [INFO] Epoch 4/5, ValAcc: 22.36%, TrainLoss: 3.2881, ValLoss: 3.1436, LR: 0.001
[2025-07-24 16:05:29,755] [INFO] Epoch 5/5, ValAcc: 25.25%, TrainLoss: 3.1776, ValLoss: 3.0089, LR: 0.001
[2025-07-24 16:05:32,265] [INFO] Namespace(path=['meta-free-apps/meta-pkt_ts_rel/meta-pkt_ts_rel.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_ts_rel.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_ts_rel.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='rel', name='pkttsrel_robust_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.2458,0.2322,0.2923,0.2463
[2025-07-24 16:05:46,681] [INFO] Feature 0 normalized using robust
[2025-07-24 16:05:46,681] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:05:46,715] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:05:46,715] [INFO] Training...
[2025-07-24 16:06:30,432] [INFO] Epoch 1/5, ValAcc: 11.51%, TrainLoss: 4.0099, ValLoss: 3.6240, LR: 0.001
[2025-07-24 16:07:14,163] [INFO] Epoch 2/5, ValAcc: 18.64%, TrainLoss: 3.5723, ValLoss: 3.3375, LR: 0.001
[2025-07-24 16:07:58,618] [INFO] Epoch 3/5, ValAcc: 17.63%, TrainLoss: 3.4093, ValLoss: 3.3643, LR: 0.001
[2025-07-24 16:08:42,786] [INFO] Epoch 4/5, ValAcc: 22.30%, TrainLoss: 3.2324, ValLoss: 3.0865, LR: 0.001
[2025-07-24 16:09:27,357] [INFO] Epoch 5/5, ValAcc: 26.36%, TrainLoss: 3.0801, ValLoss: 2.9230, LR: 0.001
[2025-07-24 16:09:32,035] [INFO] Namespace(path=['meta-free-apps/meta-pkt_ts_rel/meta-pkt_ts_rel.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_ts_rel.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_ts_rel.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='rel', name='pkttsrel_robust_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.2584,0.2454,0.2916,0.2586
[2025-07-24 16:09:46,820] [INFO] Feature 0 normalized using robust
[2025-07-24 16:09:46,820] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:09:46,843] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:09:46,843] [INFO] Training...
[2025-07-24 16:10:08,773] [INFO] Epoch 1/5, ValAcc: 8.91%, TrainLoss: 4.1980, ValLoss: 3.9604, LR: 0.001
[2025-07-24 16:10:29,998] [INFO] Epoch 2/5, ValAcc: 11.66%, TrainLoss: 3.9171, ValLoss: 3.7774, LR: 0.001
[2025-07-24 16:10:51,437] [INFO] Epoch 3/5, ValAcc: 13.66%, TrainLoss: 3.8227, ValLoss: 3.6623, LR: 0.001
[2025-07-24 16:11:12,358] [INFO] Epoch 4/5, ValAcc: 11.96%, TrainLoss: 3.7792, ValLoss: 3.7577, LR: 0.001
[2025-07-24 16:11:33,833] [INFO] Epoch 5/5, ValAcc: 15.12%, TrainLoss: 3.7104, ValLoss: 3.5768, LR: 0.001
[2025-07-24 16:11:34,760] [INFO] Namespace(path=['meta-free-apps/meta-pkt_ts_rel/meta-pkt_ts_rel.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_ts_rel.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_ts_rel.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='rel', name='pkttsrel_robust_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.1549,0.1285,0.1547,0.1542
[2025-07-24 16:11:49,198] [INFO] Feature 0 normalized using robust
[2025-07-24 16:11:49,198] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:11:49,215] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:11:49,215] [INFO] Training...
[2025-07-24 16:12:12,268] [INFO] Epoch 1/5, ValAcc: 8.63%, TrainLoss: 4.2039, ValLoss: 3.9857, LR: 0.001
[2025-07-24 16:12:37,081] [INFO] Epoch 2/5, ValAcc: 7.33%, TrainLoss: 3.9379, ValLoss: 3.9966, LR: 0.001
[2025-07-24 16:13:01,886] [INFO] Epoch 3/5, ValAcc: 11.15%, TrainLoss: 3.8433, ValLoss: 3.7623, LR: 0.001
[2025-07-24 16:13:26,698] [INFO] Epoch 4/5, ValAcc: 13.99%, TrainLoss: 3.8323, ValLoss: 3.6473, LR: 0.001
[2025-07-24 16:13:49,760] [INFO] Epoch 5/5, ValAcc: 13.76%, TrainLoss: 3.7613, ValLoss: 3.6681, LR: 0.001
[2025-07-24 16:13:51,248] [INFO] Namespace(path=['meta-free-apps/meta-pkt_ts_rel/meta-pkt_ts_rel.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_ts_rel.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_ts_rel.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='rel', name='pkttsrel_robust_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.1295,0.1036,0.1291,0.1298
[2025-07-24 16:13:52,504] [INFO] best(rel): bigru, accuracy: 0.3477, f1: 0.3433, precision: 0.4032, recall: 0.3480
[INFO] pkt_ts_diff → Best normalization: power
Running: python vrscanner.py --step2 --path meta-free-apps/meta-pkt_ts_diff/meta-pkt_ts_diff.csv --norm power --debug_path output/meta-free-apps/step2/step2_meta_pkt_ts_diff.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_pkt_ts_diff.csv
[2025-07-24 16:13:56,186] [INFO] Namespace(path=['meta-free-apps/meta-pkt_ts_diff/meta-pkt_ts_diff.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_ts_diff.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_ts_diff.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='diff')
[2025-07-24 16:19:04,550] [INFO] Processed data from meta-free-apps/meta-pkt_ts_diff/meta-pkt_ts_diff.csv:
[2025-07-24 16:19:04,551] [INFO] (84492, 500)
[2025-07-24 16:19:04,551] [INFO] [['0.000000' '0.004568' '0.002935' ... '0.000000' '0.000000' '0.000000']
 ['0.000000' '0.004434' '0.003413' ... '0.002515' '0.198601' '0.000183']
 ['0.000000' '0.004176' '0.002762' ... '0.001243' '0.003217' '0.001111']
 ...
 ['0.000000' '0.005527' '0.034811' ... '0.000004' '0.000001' '0.000001']
 ['0.000000' '0.004883' '0.005023' ... '0.000003' '0.000002' '0.000362']
 ['0.000000' '0.000003' '0.002247' ... '0.002964' '0.047872' '0.005306']]
[2025-07-24 16:19:30,360] [INFO] Feature 0 normalized using power
[2025-07-24 16:19:30,361] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:19:30,401] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:19:30,402] [INFO] Training...
[2025-07-24 16:19:53,405] [INFO] Epoch 1/5, ValAcc: 9.16%, TrainLoss: 4.3315, ValLoss: 3.7079, LR: 0.001
[2025-07-24 16:20:16,583] [INFO] Epoch 2/5, ValAcc: 32.30%, TrainLoss: 3.0524, ValLoss: 2.5142, LR: 0.001
[2025-07-24 16:20:29,834] [INFO] Epoch 3/5, ValAcc: 40.24%, TrainLoss: 2.4004, ValLoss: 2.1141, LR: 0.001
[2025-07-24 16:20:48,856] [INFO] Epoch 4/5, ValAcc: 43.81%, TrainLoss: 2.1177, ValLoss: 1.9722, LR: 0.001
[2025-07-24 16:21:12,313] [INFO] Epoch 5/5, ValAcc: 46.85%, TrainLoss: 1.9876, ValLoss: 1.8218, LR: 0.001
[2025-07-24 16:21:13,680] [INFO] Namespace(path=['meta-free-apps/meta-pkt_ts_diff/meta-pkt_ts_diff.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_ts_diff.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_ts_diff.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='diff', name='pkttsdiff_power_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.4716,0.4705,0.5393,0.4731
[2025-07-24 16:21:40,172] [INFO] Feature 0 normalized using power
[2025-07-24 16:21:40,172] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:21:40,201] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:21:40,202] [INFO] Training...
[2025-07-24 16:22:09,764] [INFO] Epoch 1/5, ValAcc: 5.70%, TrainLoss: 4.4246, ValLoss: 3.9602, LR: 0.001
[2025-07-24 16:22:38,412] [INFO] Epoch 2/5, ValAcc: 33.91%, TrainLoss: 3.2145, ValLoss: 2.5069, LR: 0.001
[2025-07-24 16:23:06,149] [INFO] Epoch 3/5, ValAcc: 43.46%, TrainLoss: 2.4068, ValLoss: 2.0455, LR: 0.001
[2025-07-24 16:23:36,015] [INFO] Epoch 4/5, ValAcc: 46.22%, TrainLoss: 2.0782, ValLoss: 1.8843, LR: 0.001
[2025-07-24 16:24:05,007] [INFO] Epoch 5/5, ValAcc: 48.52%, TrainLoss: 1.9009, ValLoss: 1.7413, LR: 0.001
[2025-07-24 16:24:07,432] [INFO] Namespace(path=['meta-free-apps/meta-pkt_ts_diff/meta-pkt_ts_diff.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_ts_diff.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_ts_diff.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='diff', name='pkttsdiff_power_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.4872,0.4878,0.5461,0.4882
[2025-07-24 16:24:33,969] [INFO] Feature 0 normalized using power
[2025-07-24 16:24:33,969] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:24:33,995] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:24:33,995] [INFO] Training...
[2025-07-24 16:24:59,505] [INFO] Epoch 1/5, ValAcc: 2.54%, TrainLoss: 4.4934, ValLoss: 4.3291, LR: 0.001
[2025-07-24 16:25:24,871] [INFO] Epoch 2/5, ValAcc: 8.63%, TrainLoss: 4.0348, ValLoss: 3.6493, LR: 0.001
[2025-07-24 16:25:49,196] [INFO] Epoch 3/5, ValAcc: 21.25%, TrainLoss: 3.4768, ValLoss: 3.0718, LR: 0.001
[2025-07-24 16:26:15,068] [INFO] Epoch 4/5, ValAcc: 31.69%, TrainLoss: 2.9640, ValLoss: 2.6239, LR: 0.001
[2025-07-24 16:26:40,518] [INFO] Epoch 5/5, ValAcc: 36.06%, TrainLoss: 2.5734, ValLoss: 2.4018, LR: 0.001
[2025-07-24 16:26:43,018] [INFO] Namespace(path=['meta-free-apps/meta-pkt_ts_diff/meta-pkt_ts_diff.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_ts_diff.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_ts_diff.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='diff', name='pkttsdiff_power_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.3585,0.3412,0.4049,0.3588
[2025-07-24 16:27:09,559] [INFO] Feature 0 normalized using power
[2025-07-24 16:27:09,559] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:27:09,585] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:27:09,585] [INFO] Training...
[2025-07-24 16:27:53,730] [INFO] Epoch 1/5, ValAcc: 3.31%, TrainLoss: 4.4623, ValLoss: 4.1739, LR: 0.001
[2025-07-24 16:28:37,925] [INFO] Epoch 2/5, ValAcc: 21.36%, TrainLoss: 3.7915, ValLoss: 3.0902, LR: 0.001
[2025-07-24 16:29:22,289] [INFO] Epoch 3/5, ValAcc: 40.37%, TrainLoss: 2.7608, ValLoss: 2.2173, LR: 0.001
[2025-07-24 16:30:06,898] [INFO] Epoch 4/5, ValAcc: 48.12%, TrainLoss: 2.1816, ValLoss: 1.8549, LR: 0.001
[2025-07-24 16:30:51,372] [INFO] Epoch 5/5, ValAcc: 48.76%, TrainLoss: 1.9455, ValLoss: 1.8210, LR: 0.001
[2025-07-24 16:30:56,049] [INFO] Namespace(path=['meta-free-apps/meta-pkt_ts_diff/meta-pkt_ts_diff.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_ts_diff.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_ts_diff.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='diff', name='pkttsdiff_power_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.4784,0.4732,0.5205,0.4799
[2025-07-24 16:31:22,369] [INFO] Feature 0 normalized using power
[2025-07-24 16:31:22,369] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:31:22,395] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:31:22,395] [INFO] Training...
[2025-07-24 16:31:43,223] [INFO] Epoch 1/5, ValAcc: 2.58%, TrainLoss: 4.4212, ValLoss: 4.2438, LR: 0.001
[2025-07-24 16:32:04,442] [INFO] Epoch 2/5, ValAcc: 4.59%, TrainLoss: 4.1093, ValLoss: 4.0215, LR: 0.001
[2025-07-24 16:32:18,298] [INFO] Epoch 3/5, ValAcc: 8.46%, TrainLoss: 3.9136, ValLoss: 3.7607, LR: 0.001
[2025-07-24 16:32:39,129] [INFO] Epoch 4/5, ValAcc: 10.01%, TrainLoss: 3.7873, ValLoss: 3.6632, LR: 0.001
[2025-07-24 16:32:56,674] [INFO] Epoch 5/5, ValAcc: 11.94%, TrainLoss: 3.6935, ValLoss: 3.5545, LR: 0.001
[2025-07-24 16:32:57,601] [INFO] Namespace(path=['meta-free-apps/meta-pkt_ts_diff/meta-pkt_ts_diff.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_ts_diff.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_ts_diff.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='diff', name='pkttsdiff_power_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.1208,0.1038,0.1327,0.1203
[2025-07-24 16:33:24,114] [INFO] Feature 0 normalized using power
[2025-07-24 16:33:24,114] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:33:24,134] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:33:24,134] [INFO] Training...
[2025-07-24 16:33:49,355] [INFO] Epoch 1/5, ValAcc: 0.91%, TrainLoss: 4.5131, ValLoss: 4.5116, LR: 0.001
[2025-07-24 16:34:14,542] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5116, ValLoss: 4.5119, LR: 0.001
[2025-07-24 16:34:39,661] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 16:35:04,741] [INFO] Epoch 4/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 16:35:29,770] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 16:35:31,267] [INFO] Namespace(path=['meta-free-apps/meta-pkt_ts_diff/meta-pkt_ts_diff.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_pkt_ts_diff.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_pkt_ts_diff.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='diff', name='pkttsdiff_power_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 16:35:32,494] [INFO] best(diff): bigru, accuracy: 0.4872, f1: 0.4878, precision: 0.5461, recall: 0.4882
[INFO] ip_version → Best normalization: none
Running: python vrscanner.py --step2 --path meta-free-apps/meta-ip_version/meta-ip_version.csv --norm none --debug_path output/meta-free-apps/step2/step2_meta_ip_version.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_ip_version.csv
[2025-07-24 16:35:36,376] [INFO] Namespace(path=['meta-free-apps/meta-ip_version/meta-ip_version.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_version.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_version.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='version')
[2025-07-24 16:38:54,206] [INFO] Processed data from meta-free-apps/meta-ip_version/meta-ip_version.csv:
[2025-07-24 16:38:54,207] [INFO] (84492, 500)
[2025-07-24 16:38:54,207] [INFO] [['4' '4' '4' ... '4' '4' '4']
 ['4' '4' '4' ... '4' '4' '4']
 ['4' '4' '4' ... '4' '4' '4']
 ...
 ['4' '4' '4' ... '4' '4' '4']
 ['4' '4' '4' ... '4' '4' '4']
 ['4' '4' '4' ... '4' '4' '4']]
[2025-07-24 16:39:12,614] [INFO] Feature 0 normalized using none
[2025-07-24 16:39:12,614] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:39:12,649] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): GRU(1, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:39:12,649] [INFO] Training...
[2025-07-24 16:39:35,415] [INFO] Epoch 1/5, ValAcc: 0.91%, TrainLoss: 4.5126, ValLoss: 4.5119, LR: 0.001
[2025-07-24 16:39:57,103] [INFO] Epoch 2/5, ValAcc: 0.91%, TrainLoss: 4.5113, ValLoss: 4.5121, LR: 0.001
[2025-07-24 16:40:15,866] [INFO] Epoch 3/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5125, LR: 0.001
[2025-07-24 16:40:38,449] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5110, ValLoss: 4.5123, LR: 0.001
[2025-07-24 16:41:00,871] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 16:41:02,148] [INFO] Namespace(path=['meta-free-apps/meta-ip_version/meta-ip_version.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_version.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_version.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='version', name='ipversion_none_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 16:41:21,158] [INFO] Feature 0 normalized using none
[2025-07-24 16:41:21,158] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:41:21,176] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): GRU(1, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:41:21,176] [INFO] Training...
[2025-07-24 16:41:49,116] [INFO] Epoch 1/5, ValAcc: 0.96%, TrainLoss: 4.5127, ValLoss: 4.5127, LR: 0.001
[2025-07-24 16:42:17,194] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5114, ValLoss: 4.5124, LR: 0.001
[2025-07-24 16:42:45,637] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 16:43:13,541] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 16:43:44,246] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5107, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 16:43:46,519] [INFO] Namespace(path=['meta-free-apps/meta-ip_version/meta-ip_version.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_version.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_version.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='version', name='ipversion_none_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 16:44:05,636] [INFO] Feature 0 normalized using none
[2025-07-24 16:44:05,636] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:44:05,657] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): LSTM(1, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:44:05,657] [INFO] Training...
[2025-07-24 16:44:30,670] [INFO] Epoch 1/5, ValAcc: 0.91%, TrainLoss: 4.5121, ValLoss: 4.5124, LR: 0.001
[2025-07-24 16:44:55,072] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5123, LR: 0.001
[2025-07-24 16:45:19,778] [INFO] Epoch 3/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 16:45:43,792] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 16:46:08,495] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 16:46:10,877] [INFO] Namespace(path=['meta-free-apps/meta-ip_version/meta-ip_version.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_version.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_version.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='version', name='ipversion_none_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 16:46:29,667] [INFO] Feature 0 normalized using none
[2025-07-24 16:46:29,667] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:46:29,685] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): LSTM(1, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:46:29,685] [INFO] Training...
[2025-07-24 16:47:11,162] [INFO] Epoch 1/5, ValAcc: 0.91%, TrainLoss: 4.5121, ValLoss: 4.5121, LR: 0.001
[2025-07-24 16:47:53,063] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5121, LR: 0.001
[2025-07-24 16:48:35,475] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 16:49:17,665] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5127, LR: 0.001
[2025-07-24 16:50:00,018] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5125, LR: 0.0005
[2025-07-24 16:50:04,490] [INFO] Namespace(path=['meta-free-apps/meta-ip_version/meta-ip_version.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_version.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_version.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='version', name='ipversion_none_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 16:50:23,459] [INFO] Feature 0 normalized using none
[2025-07-24 16:50:23,459] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:50:23,480] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): RNN(1, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:50:23,480] [INFO] Training...
[2025-07-24 16:50:41,965] [INFO] Epoch 1/5, ValAcc: 1.12%, TrainLoss: 4.5125, ValLoss: 4.5119, LR: 0.001
[2025-07-24 16:51:02,280] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5113, ValLoss: 4.5122, LR: 0.001
[2025-07-24 16:51:22,523] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 16:51:42,790] [INFO] Epoch 4/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 16:52:03,372] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 16:52:04,259] [INFO] Namespace(path=['meta-free-apps/meta-ip_version/meta-ip_version.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_version.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_version.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='version', name='ipversion_none_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 16:52:23,211] [INFO] Feature 0 normalized using none
[2025-07-24 16:52:23,211] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:52:23,259] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): RNN(1, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:52:23,259] [INFO] Training...
[2025-07-24 16:52:46,629] [INFO] Epoch 1/5, ValAcc: 0.95%, TrainLoss: 4.5128, ValLoss: 4.5123, LR: 0.001
[2025-07-24 16:53:09,316] [INFO] Epoch 2/5, ValAcc: 0.91%, TrainLoss: 4.5112, ValLoss: 4.5122, LR: 0.001
[2025-07-24 16:53:33,135] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 16:53:57,110] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 16:54:18,695] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 16:54:20,137] [INFO] Namespace(path=['meta-free-apps/meta-ip_version/meta-ip_version.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_version.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_version.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='version', name='ipversion_none_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 16:54:20,283] [INFO] best(version): gru, accuracy: 0.0102, f1: 0.0002, precision: 0.0001, recall: 0.0110
[INFO] ip_ihl → Best normalization: zscore
Running: python vrscanner.py --step2 --path meta-free-apps/meta-ip_ihl/meta-ip_ihl.csv --norm zscore --debug_path output/meta-free-apps/step2/step2_meta_ip_ihl.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_ip_ihl.csv
[2025-07-24 16:54:23,350] [INFO] Namespace(path=['meta-free-apps/meta-ip_ihl/meta-ip_ihl.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['zscore'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_ihl.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_ihl.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ihl')
[2025-07-24 16:57:37,301] [INFO] Processed data from meta-free-apps/meta-ip_ihl/meta-ip_ihl.csv:
[2025-07-24 16:57:37,302] [INFO] (84492, 500)
[2025-07-24 16:57:37,302] [INFO] [['5' '5' '5' ... '5' '5' '5']
 ['5' '5' '5' ... '5' '5' '5']
 ['5' '5' '5' ... '5' '5' '5']
 ...
 ['5' '5' '5' ... '5' '5' '5']
 ['5' '5' '5' ... '5' '5' '5']
 ['5' '5' '5' ... '5' '5' '5']]
[2025-07-24 16:57:52,098] [INFO] Feature 0 normalized using zscore
[2025-07-24 16:57:52,099] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 16:57:52,133] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 16:57:52,133] [INFO] Training...
[2025-07-24 16:58:15,238] [INFO] Epoch 1/5, ValAcc: 0.98%, TrainLoss: 4.5125, ValLoss: 4.5119, LR: 0.001
[2025-07-24 16:58:36,830] [INFO] Epoch 2/5, ValAcc: 0.99%, TrainLoss: 4.5116, ValLoss: 4.5124, LR: 0.001
[2025-07-24 16:58:58,995] [INFO] Epoch 3/5, ValAcc: 0.99%, TrainLoss: 4.5096, ValLoss: 4.5101, LR: 0.001
[2025-07-24 16:59:22,301] [INFO] Epoch 4/5, ValAcc: 0.99%, TrainLoss: 4.5084, ValLoss: 4.5093, LR: 0.001
[2025-07-24 16:59:45,509] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5091, ValLoss: 4.5124, LR: 0.001
[2025-07-24 16:59:46,833] [INFO] Namespace(path=['meta-free-apps/meta-ip_ihl/meta-ip_ihl.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['zscore'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_ihl.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_ihl.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ihl', name='ipihl_zscore_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 17:00:02,034] [INFO] Feature 0 normalized using zscore
[2025-07-24 17:00:02,034] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:00:02,051] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:00:02,051] [INFO] Training...
[2025-07-24 17:00:31,365] [INFO] Epoch 1/5, ValAcc: 0.98%, TrainLoss: 4.5132, ValLoss: 4.5117, LR: 0.001
[2025-07-24 17:01:00,687] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 17:01:30,020] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5110, ValLoss: 4.5124, LR: 0.001
[2025-07-24 17:01:59,363] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 17:02:28,740] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 17:02:31,152] [INFO] Namespace(path=['meta-free-apps/meta-ip_ihl/meta-ip_ihl.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['zscore'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_ihl.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_ihl.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ihl', name='ipihl_zscore_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 17:02:46,458] [INFO] Feature 0 normalized using zscore
[2025-07-24 17:02:46,458] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:02:46,471] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:02:46,471] [INFO] Training...
[2025-07-24 17:03:12,087] [INFO] Epoch 1/5, ValAcc: 0.96%, TrainLoss: 4.5117, ValLoss: 4.5090, LR: 0.001
[2025-07-24 17:03:37,348] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5079, ValLoss: 4.5089, LR: 0.001
[2025-07-24 17:04:02,625] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5073, ValLoss: 4.5082, LR: 0.001
[2025-07-24 17:04:27,912] [INFO] Epoch 4/5, ValAcc: 1.03%, TrainLoss: 4.5072, ValLoss: 4.5081, LR: 0.001
[2025-07-24 17:04:53,134] [INFO] Epoch 5/5, ValAcc: 1.03%, TrainLoss: 4.5069, ValLoss: 4.5076, LR: 0.001
[2025-07-24 17:04:55,580] [INFO] Namespace(path=['meta-free-apps/meta-ip_ihl/meta-ip_ihl.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['zscore'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_ihl.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_ihl.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ihl', name='ipihl_zscore_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0104,0.0005,0.0007,0.0112
[2025-07-24 17:05:10,634] [INFO] Feature 0 normalized using zscore
[2025-07-24 17:05:10,634] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:05:10,651] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:05:10,651] [INFO] Training...
[2025-07-24 17:05:52,396] [INFO] Epoch 1/5, ValAcc: 0.96%, TrainLoss: 4.5114, ValLoss: 4.5096, LR: 0.001
[2025-07-24 17:06:32,935] [INFO] Epoch 2/5, ValAcc: 0.91%, TrainLoss: 4.5080, ValLoss: 4.5084, LR: 0.001
[2025-07-24 17:07:13,579] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5075, ValLoss: 4.5084, LR: 0.001
[2025-07-24 17:07:56,421] [INFO] Epoch 4/5, ValAcc: 0.96%, TrainLoss: 4.5070, ValLoss: 4.5080, LR: 0.001
[2025-07-24 17:08:39,809] [INFO] Epoch 5/5, ValAcc: 0.96%, TrainLoss: 4.5071, ValLoss: 4.5081, LR: 0.001
[2025-07-24 17:08:44,383] [INFO] Namespace(path=['meta-free-apps/meta-ip_ihl/meta-ip_ihl.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['zscore'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_ihl.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_ihl.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ihl', name='ipihl_zscore_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0113,0.0005,0.0007,0.0112
[2025-07-24 17:08:59,544] [INFO] Feature 0 normalized using zscore
[2025-07-24 17:08:59,544] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:08:59,557] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:08:59,557] [INFO] Training...
[2025-07-24 17:09:20,970] [INFO] Epoch 1/5, ValAcc: 1.04%, TrainLoss: 4.5127, ValLoss: 4.5117, LR: 0.001
[2025-07-24 17:09:42,028] [INFO] Epoch 2/5, ValAcc: 1.02%, TrainLoss: 4.5114, ValLoss: 4.5109, LR: 0.001
[2025-07-24 17:10:03,510] [INFO] Epoch 3/5, ValAcc: 1.02%, TrainLoss: 4.5098, ValLoss: 4.5099, LR: 0.001
[2025-07-24 17:10:24,608] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5091, ValLoss: 4.5095, LR: 0.001
[2025-07-24 17:10:45,683] [INFO] Epoch 5/5, ValAcc: 1.04%, TrainLoss: 4.5086, ValLoss: 4.5093, LR: 0.001
[2025-07-24 17:10:46,596] [INFO] Namespace(path=['meta-free-apps/meta-ip_ihl/meta-ip_ihl.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['zscore'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_ihl.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_ihl.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ihl', name='ipihl_zscore_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0103,0.0004,0.0006,0.0111
[2025-07-24 17:11:01,797] [INFO] Feature 0 normalized using zscore
[2025-07-24 17:11:01,797] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:11:01,810] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:11:01,810] [INFO] Training...
[2025-07-24 17:11:26,607] [INFO] Epoch 1/5, ValAcc: 1.03%, TrainLoss: 4.5128, ValLoss: 4.5118, LR: 0.001
[2025-07-24 17:11:50,487] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5121, LR: 0.001
[2025-07-24 17:12:14,612] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5110, ValLoss: 4.5121, LR: 0.001
[2025-07-24 17:12:38,937] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5125, LR: 0.001
[2025-07-24 17:13:03,987] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5125, LR: 0.0005
[2025-07-24 17:13:05,473] [INFO] Namespace(path=['meta-free-apps/meta-ip_ihl/meta-ip_ihl.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['zscore'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_ihl.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_ihl.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ihl', name='ipihl_zscore_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 17:13:05,630] [INFO] best(ihl): bilstm, accuracy: 0.0113, f1: 0.0005, precision: 0.0007, recall: 0.0112
[INFO] ip_ttl → Best normalization: token
Running: python vrscanner.py --step2 --path meta-free-apps/meta-ip_ttl/meta-ip_ttl.csv --norm token --debug_path output/meta-free-apps/step2/step2_meta_ip_ttl.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_ip_ttl.csv
[2025-07-24 17:13:08,804] [INFO] Namespace(path=['meta-free-apps/meta-ip_ttl/meta-ip_ttl.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_ttl.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_ttl.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ttl')
[2025-07-24 17:16:44,462] [INFO] Processed data from meta-free-apps/meta-ip_ttl/meta-ip_ttl.csv:
[2025-07-24 17:16:44,463] [INFO] (84492, 500)
[2025-07-24 17:16:44,463] [INFO] [['64' '49' '64' ... '64' '64' '64']
 ['64' '49' '64' ... '64' '49' '49']
 ['64' '49' '64' ... '64' '49' '49']
 ...
 ['64' '50' '64' ... '64' '64' '64']
 ['64' '50' '64' ... '64' '64' '48']
 ['64' '64' '64' ... '64' '64' '48']]
[2025-07-24 17:17:16,649] [INFO] Feature 0 normalized using token
[2025-07-24 17:17:16,649] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:17:16,694] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(18, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:17:16,694] [INFO] Training...
[2025-07-24 17:17:38,017] [INFO] Epoch 1/5, ValAcc: 12.57%, TrainLoss: 3.9178, ValLoss: 3.2943, LR: 0.001
[2025-07-24 17:17:57,053] [INFO] Epoch 2/5, ValAcc: 10.34%, TrainLoss: 3.2761, ValLoss: 3.2762, LR: 0.001
[2025-07-24 17:18:20,246] [INFO] Epoch 3/5, ValAcc: 18.20%, TrainLoss: 3.0490, ValLoss: 2.8810, LR: 0.001
[2025-07-24 17:18:43,609] [INFO] Epoch 4/5, ValAcc: 24.28%, TrainLoss: 2.9115, ValLoss: 2.7098, LR: 0.001
[2025-07-24 17:19:00,632] [INFO] Epoch 5/5, ValAcc: 30.08%, TrainLoss: 2.7692, ValLoss: 2.5311, LR: 0.001
[2025-07-24 17:19:01,996] [INFO] Namespace(path=['meta-free-apps/meta-ip_ttl/meta-ip_ttl.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_ttl.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_ttl.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ttl', name='ipttl_token_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.2921,0.2640,0.3014,0.2933
[2025-07-24 17:19:34,561] [INFO] Feature 0 normalized using token
[2025-07-24 17:19:34,561] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:19:34,620] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(18, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:19:34,620] [INFO] Training...
[2025-07-24 17:20:03,941] [INFO] Epoch 1/5, ValAcc: 9.36%, TrainLoss: 3.9543, ValLoss: 3.4514, LR: 0.001
[2025-07-24 17:20:32,833] [INFO] Epoch 2/5, ValAcc: 14.14%, TrainLoss: 3.3622, ValLoss: 3.1056, LR: 0.001
[2025-07-24 17:21:02,037] [INFO] Epoch 3/5, ValAcc: 17.93%, TrainLoss: 3.1282, ValLoss: 2.9171, LR: 0.001
[2025-07-24 17:21:31,342] [INFO] Epoch 4/5, ValAcc: 19.10%, TrainLoss: 3.0018, ValLoss: 2.8331, LR: 0.001
[2025-07-24 17:22:01,247] [INFO] Epoch 5/5, ValAcc: 21.53%, TrainLoss: 2.9174, ValLoss: 2.7348, LR: 0.001
[2025-07-24 17:22:03,669] [INFO] Namespace(path=['meta-free-apps/meta-ip_ttl/meta-ip_ttl.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_ttl.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_ttl.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ttl', name='ipttl_token_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.2182,0.1733,0.2121,0.2188
[2025-07-24 17:22:36,217] [INFO] Feature 0 normalized using token
[2025-07-24 17:22:36,218] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:22:36,244] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(18, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:22:36,245] [INFO] Training...
[2025-07-24 17:23:01,510] [INFO] Epoch 1/5, ValAcc: 6.75%, TrainLoss: 4.2314, ValLoss: 3.7984, LR: 0.001
[2025-07-24 17:23:27,069] [INFO] Epoch 2/5, ValAcc: 8.08%, TrainLoss: 3.7454, ValLoss: 3.6510, LR: 0.001
[2025-07-24 17:23:52,920] [INFO] Epoch 3/5, ValAcc: 1.07%, TrainLoss: 3.5705, ValLoss: 4.5145, LR: 0.001
[2025-07-24 17:24:18,586] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5125, ValLoss: 4.5124, LR: 0.001
[2025-07-24 17:24:44,150] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5124, LR: 0.001
[2025-07-24 17:24:46,655] [INFO] Namespace(path=['meta-free-apps/meta-ip_ttl/meta-ip_ttl.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_ttl.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_ttl.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ttl', name='ipttl_token_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 17:25:19,193] [INFO] Feature 0 normalized using token
[2025-07-24 17:25:19,193] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:25:19,222] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(18, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:25:19,222] [INFO] Training...
[2025-07-24 17:26:03,602] [INFO] Epoch 1/5, ValAcc: 6.47%, TrainLoss: 4.3037, ValLoss: 3.8925, LR: 0.001
[2025-07-24 17:26:48,037] [INFO] Epoch 2/5, ValAcc: 9.31%, TrainLoss: 3.8921, ValLoss: 3.5222, LR: 0.001
[2025-07-24 17:27:32,416] [INFO] Epoch 3/5, ValAcc: 2.63%, TrainLoss: 3.5196, ValLoss: 4.2761, LR: 0.001
[2025-07-24 17:28:17,396] [INFO] Epoch 4/5, ValAcc: 10.80%, TrainLoss: 3.7054, ValLoss: 3.3106, LR: 0.001
[2025-07-24 17:29:02,281] [INFO] Epoch 5/5, ValAcc: 16.67%, TrainLoss: 3.2253, ValLoss: 3.0032, LR: 0.001
[2025-07-24 17:29:06,972] [INFO] Namespace(path=['meta-free-apps/meta-ip_ttl/meta-ip_ttl.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_ttl.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_ttl.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ttl', name='ipttl_token_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.1655,0.1122,0.1201,0.1641
[2025-07-24 17:29:39,914] [INFO] Feature 0 normalized using token
[2025-07-24 17:29:39,914] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:29:39,941] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(18, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:29:39,941] [INFO] Training...
[2025-07-24 17:29:59,704] [INFO] Epoch 1/5, ValAcc: 4.92%, TrainLoss: 4.2799, ValLoss: 4.1086, LR: 0.001
[2025-07-24 17:30:19,571] [INFO] Epoch 2/5, ValAcc: 6.46%, TrainLoss: 4.0887, ValLoss: 3.9775, LR: 0.001
[2025-07-24 17:30:40,001] [INFO] Epoch 3/5, ValAcc: 8.21%, TrainLoss: 3.9753, ValLoss: 3.8518, LR: 0.001
[2025-07-24 17:31:00,407] [INFO] Epoch 4/5, ValAcc: 9.47%, TrainLoss: 3.9305, ValLoss: 3.7966, LR: 0.001
[2025-07-24 17:31:21,877] [INFO] Epoch 5/5, ValAcc: 8.13%, TrainLoss: 3.8600, ValLoss: 3.8171, LR: 0.001
[2025-07-24 17:31:22,810] [INFO] Namespace(path=['meta-free-apps/meta-ip_ttl/meta-ip_ttl.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_ttl.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_ttl.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ttl', name='ipttl_token_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0813,0.0459,0.0556,0.0806
[2025-07-24 17:31:55,732] [INFO] Feature 0 normalized using token
[2025-07-24 17:31:55,732] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:31:55,790] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(18, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:31:55,790] [INFO] Training...
[2025-07-24 17:32:11,576] [INFO] Epoch 1/5, ValAcc: 5.64%, TrainLoss: 4.2756, ValLoss: 4.1345, LR: 0.001
[2025-07-24 17:32:27,368] [INFO] Epoch 2/5, ValAcc: 1.37%, TrainLoss: 4.0371, ValLoss: 4.5013, LR: 0.001
[2025-07-24 17:32:51,876] [INFO] Epoch 3/5, ValAcc: 7.29%, TrainLoss: 4.0902, ValLoss: 3.8943, LR: 0.001
[2025-07-24 17:33:16,785] [INFO] Epoch 4/5, ValAcc: 8.75%, TrainLoss: 3.9160, ValLoss: 3.7991, LR: 0.001
[2025-07-24 17:33:41,668] [INFO] Epoch 5/5, ValAcc: 11.25%, TrainLoss: 3.8184, ValLoss: 3.6326, LR: 0.001
[2025-07-24 17:33:43,155] [INFO] Namespace(path=['meta-free-apps/meta-ip_ttl/meta-ip_ttl.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_ttl.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_ttl.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ttl', name='ipttl_token_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.1134,0.0868,0.0926,0.1135
[2025-07-24 17:33:43,834] [INFO] best(ttl): gru, accuracy: 0.2921, f1: 0.2640, precision: 0.3014, recall: 0.2933
[INFO] ip_tos → Best normalization: none
Running: python vrscanner.py --step2 --path meta-free-apps/meta-ip_tos/meta-ip_tos.csv --norm none --debug_path output/meta-free-apps/step2/step2_meta_ip_tos.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_ip_tos.csv
[2025-07-24 17:33:47,109] [INFO] Namespace(path=['meta-free-apps/meta-ip_tos/meta-ip_tos.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_tos.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_tos.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='tos')
[2025-07-24 17:37:01,262] [INFO] Processed data from meta-free-apps/meta-ip_tos/meta-ip_tos.csv:
[2025-07-24 17:37:01,262] [INFO] (84492, 500)
[2025-07-24 17:37:01,262] [INFO] [['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']
 ...
 ['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']]
[2025-07-24 17:37:15,659] [INFO] Feature 0 normalized using none
[2025-07-24 17:37:15,659] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:37:15,696] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): GRU(1, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:37:15,697] [INFO] Training...
[2025-07-24 17:37:37,964] [INFO] Epoch 1/5, ValAcc: 0.91%, TrainLoss: 4.5122, ValLoss: 4.5120, LR: 0.001
[2025-07-24 17:37:59,117] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5116, ValLoss: 4.5121, LR: 0.001
[2025-07-24 17:38:18,741] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 17:38:41,131] [INFO] Epoch 4/5, ValAcc: 0.91%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 17:39:03,234] [INFO] Epoch 5/5, ValAcc: 1.04%, TrainLoss: 4.5108, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 17:39:04,505] [INFO] Namespace(path=['meta-free-apps/meta-ip_tos/meta-ip_tos.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_tos.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_tos.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='tos', name='iptos_none_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0100,0.0002,0.0001,0.0110
[2025-07-24 17:39:19,112] [INFO] Feature 0 normalized using none
[2025-07-24 17:39:19,112] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:39:19,140] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): GRU(1, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:39:19,140] [INFO] Training...
[2025-07-24 17:39:46,548] [INFO] Epoch 1/5, ValAcc: 0.98%, TrainLoss: 4.5125, ValLoss: 4.5117, LR: 0.001
[2025-07-24 17:40:12,918] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5113, ValLoss: 4.5121, LR: 0.001
[2025-07-24 17:40:40,753] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 17:41:08,788] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 17:41:36,825] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 17:41:39,090] [INFO] Namespace(path=['meta-free-apps/meta-ip_tos/meta-ip_tos.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_tos.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_tos.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='tos', name='iptos_none_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 17:41:53,761] [INFO] Feature 0 normalized using none
[2025-07-24 17:41:53,761] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:41:53,775] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): LSTM(1, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:41:53,775] [INFO] Training...
[2025-07-24 17:42:18,064] [INFO] Epoch 1/5, ValAcc: 1.07%, TrainLoss: 4.5120, ValLoss: 4.5118, LR: 0.001
[2025-07-24 17:42:42,364] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5121, LR: 0.001
[2025-07-24 17:43:03,705] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 17:43:26,353] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 17:43:50,794] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 17:43:53,182] [INFO] Namespace(path=['meta-free-apps/meta-ip_tos/meta-ip_tos.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_tos.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_tos.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='tos', name='iptos_none_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 17:44:07,731] [INFO] Feature 0 normalized using none
[2025-07-24 17:44:07,731] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:44:07,755] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): LSTM(1, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:44:07,755] [INFO] Training...
[2025-07-24 17:44:50,039] [INFO] Epoch 1/5, ValAcc: 0.91%, TrainLoss: 4.5123, ValLoss: 4.5115, LR: 0.001
[2025-07-24 17:45:32,263] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5114, ValLoss: 4.5118, LR: 0.001
[2025-07-24 17:46:14,560] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5121, LR: 0.001
[2025-07-24 17:46:56,302] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 17:47:36,404] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5107, ValLoss: 4.5122, LR: 0.0005
[2025-07-24 17:47:40,875] [INFO] Namespace(path=['meta-free-apps/meta-ip_tos/meta-ip_tos.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_tos.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_tos.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='tos', name='iptos_none_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 17:47:55,359] [INFO] Feature 0 normalized using none
[2025-07-24 17:47:55,359] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:47:55,371] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): RNN(1, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:47:55,372] [INFO] Training...
[2025-07-24 17:48:15,581] [INFO] Epoch 1/5, ValAcc: 1.01%, TrainLoss: 4.5126, ValLoss: 4.5115, LR: 0.001
[2025-07-24 17:48:34,874] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5121, LR: 0.001
[2025-07-24 17:48:54,555] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 17:49:14,779] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 17:49:35,000] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5107, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 17:49:35,897] [INFO] Namespace(path=['meta-free-apps/meta-ip_tos/meta-ip_tos.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_tos.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_tos.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='tos', name='iptos_none_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 17:49:50,438] [INFO] Feature 0 normalized using none
[2025-07-24 17:49:50,438] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:49:50,452] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): RNN(1, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:49:50,452] [INFO] Training...
[2025-07-24 17:50:14,260] [INFO] Epoch 1/5, ValAcc: 0.99%, TrainLoss: 4.5127, ValLoss: 4.5124, LR: 0.001
[2025-07-24 17:50:37,998] [INFO] Epoch 2/5, ValAcc: 1.04%, TrainLoss: 4.5112, ValLoss: 4.5122, LR: 0.001
[2025-07-24 17:51:01,779] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 17:51:25,553] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 17:51:49,343] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 17:51:50,791] [INFO] Namespace(path=['meta-free-apps/meta-ip_tos/meta-ip_tos.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_tos.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_tos.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='tos', name='iptos_none_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 17:51:50,912] [INFO] best(tos): bigru, accuracy: 0.0102, f1: 0.0002, precision: 0.0001, recall: 0.0110
[INFO] ip_src → Best normalization: token
Running: python vrscanner.py --step2 --path meta-free-apps/meta-ip_src/meta-ip_src.csv --norm token --debug_path output/meta-free-apps/step2/step2_meta_ip_src.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_ip_src.csv
[2025-07-24 17:51:54,111] [INFO] Namespace(path=['meta-free-apps/meta-ip_src/meta-ip_src.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_src.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_src.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='src')
[2025-07-24 17:56:03,485] [INFO] Processed data from meta-free-apps/meta-ip_src/meta-ip_src.csv:
[2025-07-24 17:56:03,485] [INFO] (84492, 500)
[2025-07-24 17:56:03,485] [INFO] [['10.0.0.4' '157.240.215.51' '10.0.0.4' ... '10.0.0.4' '10.0.0.4'
  '10.0.0.4']
 ['10.0.0.4' '157.240.215.51' '10.0.0.4' ... '10.0.0.4' '157.240.215.51'
  '157.240.215.51']
 ['10.0.0.4' '157.240.215.51' '10.0.0.4' ... '10.0.0.4' '157.240.215.51'
  '157.240.215.51']
 ...
 ['10.0.1.8' '157.240.215.51' '10.0.1.8' ... '10.0.1.8' '10.0.1.8'
  '10.0.1.8']
 ['10.0.1.8' '157.240.215.51' '10.0.1.8' ... '10.0.1.8' '10.0.1.8'
  '157.240.215.16']
 ['10.0.1.8' '10.0.1.8' '10.0.1.8' ... '10.0.1.8' '10.0.1.8'
  '157.240.215.51']]
[2025-07-24 17:56:43,504] [INFO] Feature 0 normalized using token
[2025-07-24 17:56:43,504] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:56:43,550] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(102, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:56:43,550] [INFO] Training...
[2025-07-24 17:57:04,903] [INFO] Epoch 1/5, ValAcc: 26.34%, TrainLoss: 3.5846, ValLoss: 2.6954, LR: 0.001
[2025-07-24 17:57:26,497] [INFO] Epoch 2/5, ValAcc: 39.93%, TrainLoss: 2.4986, ValLoss: 2.0785, LR: 0.001
[2025-07-24 17:57:50,098] [INFO] Epoch 3/5, ValAcc: 45.04%, TrainLoss: 2.0397, ValLoss: 1.8175, LR: 0.001
[2025-07-24 17:58:13,373] [INFO] Epoch 4/5, ValAcc: 50.57%, TrainLoss: 1.8264, ValLoss: 1.6076, LR: 0.001
[2025-07-24 17:58:36,401] [INFO] Epoch 5/5, ValAcc: 51.88%, TrainLoss: 1.6967, ValLoss: 1.5323, LR: 0.001
[2025-07-24 17:58:37,771] [INFO] Namespace(path=['meta-free-apps/meta-ip_src/meta-ip_src.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_src.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_src.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='src', name='ipsrc_token_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.5163,0.5113,0.5575,0.5167
[2025-07-24 17:59:18,113] [INFO] Feature 0 normalized using token
[2025-07-24 17:59:18,114] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 17:59:18,148] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(102, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 17:59:18,148] [INFO] Training...
[2025-07-24 17:59:47,274] [INFO] Epoch 1/5, ValAcc: 27.57%, TrainLoss: 3.4752, ValLoss: 2.5441, LR: 0.001
[2025-07-24 18:00:16,285] [INFO] Epoch 2/5, ValAcc: 41.61%, TrainLoss: 2.2571, ValLoss: 1.9557, LR: 0.001
[2025-07-24 18:00:45,612] [INFO] Epoch 3/5, ValAcc: 46.96%, TrainLoss: 1.9278, ValLoss: 1.7609, LR: 0.001
[2025-07-24 18:01:15,401] [INFO] Epoch 4/5, ValAcc: 51.57%, TrainLoss: 1.7686, ValLoss: 1.6060, LR: 0.001
[2025-07-24 18:01:45,041] [INFO] Epoch 5/5, ValAcc: 50.78%, TrainLoss: 1.6648, ValLoss: 1.6002, LR: 0.001
[2025-07-24 18:01:47,461] [INFO] Namespace(path=['meta-free-apps/meta-ip_src/meta-ip_src.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_src.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_src.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='src', name='ipsrc_token_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.5115,0.5051,0.5599,0.5119
[2025-07-24 18:02:27,902] [INFO] Feature 0 normalized using token
[2025-07-24 18:02:27,902] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:02:27,931] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(102, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:02:27,931] [INFO] Training...
[2025-07-24 18:02:53,454] [INFO] Epoch 1/5, ValAcc: 10.11%, TrainLoss: 4.1340, ValLoss: 3.6306, LR: 0.001
[2025-07-24 18:03:19,335] [INFO] Epoch 2/5, ValAcc: 28.84%, TrainLoss: 3.1639, ValLoss: 2.5493, LR: 0.001
[2025-07-24 18:03:44,829] [INFO] Epoch 3/5, ValAcc: 36.92%, TrainLoss: 2.4713, ValLoss: 2.1903, LR: 0.001
[2025-07-24 18:04:10,314] [INFO] Epoch 4/5, ValAcc: 40.72%, TrainLoss: 2.1401, ValLoss: 1.9775, LR: 0.001
[2025-07-24 18:04:35,827] [INFO] Epoch 5/5, ValAcc: 49.42%, TrainLoss: 1.8850, ValLoss: 1.6686, LR: 0.001
[2025-07-24 18:04:38,345] [INFO] Namespace(path=['meta-free-apps/meta-ip_src/meta-ip_src.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_src.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_src.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='src', name='ipsrc_token_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.4955,0.4880,0.5378,0.4971
[2025-07-24 18:05:18,925] [INFO] Feature 0 normalized using token
[2025-07-24 18:05:18,926] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:05:18,956] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(102, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:05:18,957] [INFO] Training...
[2025-07-24 18:06:02,208] [INFO] Epoch 1/5, ValAcc: 20.26%, TrainLoss: 3.7235, ValLoss: 2.8977, LR: 0.001
[2025-07-24 18:06:46,676] [INFO] Epoch 2/5, ValAcc: 38.65%, TrainLoss: 2.5341, ValLoss: 2.1005, LR: 0.001
[2025-07-24 18:07:31,139] [INFO] Epoch 3/5, ValAcc: 47.61%, TrainLoss: 2.0231, ValLoss: 1.7126, LR: 0.001
[2025-07-24 18:08:15,699] [INFO] Epoch 4/5, ValAcc: 52.30%, TrainLoss: 1.7260, ValLoss: 1.5142, LR: 0.001
[2025-07-24 18:09:00,160] [INFO] Epoch 5/5, ValAcc: 56.93%, TrainLoss: 1.5542, ValLoss: 1.3779, LR: 0.001
[2025-07-24 18:09:04,852] [INFO] Namespace(path=['meta-free-apps/meta-ip_src/meta-ip_src.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_src.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_src.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='src', name='ipsrc_token_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.5739,0.5702,0.6113,0.5761
[2025-07-24 18:09:45,223] [INFO] Feature 0 normalized using token
[2025-07-24 18:09:45,223] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:09:45,250] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(102, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:09:45,250] [INFO] Training...
[2025-07-24 18:10:05,926] [INFO] Epoch 1/5, ValAcc: 11.48%, TrainLoss: 3.9811, ValLoss: 3.5762, LR: 0.001
[2025-07-24 18:10:27,243] [INFO] Epoch 2/5, ValAcc: 16.00%, TrainLoss: 3.5061, ValLoss: 3.2771, LR: 0.001
[2025-07-24 18:10:48,045] [INFO] Epoch 3/5, ValAcc: 20.92%, TrainLoss: 3.2755, ValLoss: 3.0362, LR: 0.001
[2025-07-24 18:11:09,124] [INFO] Epoch 4/5, ValAcc: 22.83%, TrainLoss: 3.1050, ValLoss: 2.9054, LR: 0.001
[2025-07-24 18:11:30,421] [INFO] Epoch 5/5, ValAcc: 24.96%, TrainLoss: 3.0137, ValLoss: 2.8424, LR: 0.001
[2025-07-24 18:11:31,359] [INFO] Namespace(path=['meta-free-apps/meta-ip_src/meta-ip_src.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_src.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_src.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='src', name='ipsrc_token_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.2547,0.2246,0.2574,0.2563
[2025-07-24 18:12:11,241] [INFO] Feature 0 normalized using token
[2025-07-24 18:12:11,241] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:12:11,267] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(102, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:12:11,267] [INFO] Training...
[2025-07-24 18:12:36,105] [INFO] Epoch 1/5, ValAcc: 14.11%, TrainLoss: 3.9006, ValLoss: 3.4299, LR: 0.001
[2025-07-24 18:13:01,280] [INFO] Epoch 2/5, ValAcc: 19.95%, TrainLoss: 3.3273, ValLoss: 3.0978, LR: 0.001
[2025-07-24 18:13:26,713] [INFO] Epoch 3/5, ValAcc: 23.17%, TrainLoss: 3.1023, ValLoss: 2.8704, LR: 0.001
[2025-07-24 18:13:51,667] [INFO] Epoch 4/5, ValAcc: 24.06%, TrainLoss: 2.9612, ValLoss: 2.8244, LR: 0.001
[2025-07-24 18:14:16,607] [INFO] Epoch 5/5, ValAcc: 27.27%, TrainLoss: 2.8596, ValLoss: 2.6660, LR: 0.001
[2025-07-24 18:14:18,110] [INFO] Namespace(path=['meta-free-apps/meta-ip_src/meta-ip_src.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_src.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_src.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='src', name='ipsrc_token_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.2719,0.2567,0.3211,0.2717
[2025-07-24 18:14:18,831] [INFO] best(src): bilstm, accuracy: 0.5739, f1: 0.5702, precision: 0.6113, recall: 0.5761
[INFO] ip_dst → Best normalization: token
Running: python vrscanner.py --step2 --path meta-free-apps/meta-ip_dst/meta-ip_dst.csv --norm token --debug_path output/meta-free-apps/step2/step2_meta_ip_dst.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_ip_dst.csv
[2025-07-24 18:14:22,102] [INFO] Namespace(path=['meta-free-apps/meta-ip_dst/meta-ip_dst.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_dst.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_dst.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dst')
[2025-07-24 18:18:35,444] [INFO] Processed data from meta-free-apps/meta-ip_dst/meta-ip_dst.csv:
[2025-07-24 18:18:35,444] [INFO] (84492, 500)
[2025-07-24 18:18:35,444] [INFO] [['157.240.215.51' '10.0.0.4' '157.240.215.51' ... '157.240.215.16'
  '157.240.215.16' '157.240.215.16']
 ['157.240.215.51' '10.0.0.4' '157.240.215.51' ... '157.240.215.51'
  '10.0.0.4' '10.0.0.4']
 ['157.240.215.51' '10.0.0.4' '157.240.215.51' ... '157.240.215.51'
  '10.0.0.4' '10.0.0.4']
 ...
 ['157.240.215.51' '10.0.1.8' '157.240.215.51' ... '157.240.215.16'
  '157.240.215.16' '157.240.215.16']
 ['157.240.215.51' '10.0.1.8' '157.240.215.51' ... '157.240.215.16'
  '157.240.215.16' '10.0.1.8']
 ['157.240.215.16' '157.240.215.16' '157.240.215.16' ... '157.240.215.51'
  '157.240.215.51' '10.0.1.8']]
[2025-07-24 18:19:17,507] [INFO] Feature 0 normalized using token
[2025-07-24 18:19:17,507] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:19:17,555] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(102, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:19:17,555] [INFO] Training...
[2025-07-24 18:19:40,610] [INFO] Epoch 1/5, ValAcc: 25.36%, TrainLoss: 3.7301, ValLoss: 2.7708, LR: 0.001
[2025-07-24 18:20:04,461] [INFO] Epoch 2/5, ValAcc: 37.78%, TrainLoss: 2.5486, ValLoss: 2.1684, LR: 0.001
[2025-07-24 18:20:27,959] [INFO] Epoch 3/5, ValAcc: 43.12%, TrainLoss: 2.1374, ValLoss: 1.9163, LR: 0.001
[2025-07-24 18:20:51,647] [INFO] Epoch 4/5, ValAcc: 47.57%, TrainLoss: 1.9440, ValLoss: 1.7466, LR: 0.001
[2025-07-24 18:21:14,190] [INFO] Epoch 5/5, ValAcc: 49.56%, TrainLoss: 1.8244, ValLoss: 1.6726, LR: 0.001
[2025-07-24 18:21:15,564] [INFO] Namespace(path=['meta-free-apps/meta-ip_dst/meta-ip_dst.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_dst.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_dst.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dst', name='ipdst_token_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.4939,0.4891,0.5378,0.4947
[2025-07-24 18:21:57,209] [INFO] Feature 0 normalized using token
[2025-07-24 18:21:57,209] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:21:57,233] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(102, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:21:57,233] [INFO] Training...
[2025-07-24 18:22:26,700] [INFO] Epoch 1/5, ValAcc: 21.56%, TrainLoss: 3.7756, ValLoss: 2.9606, LR: 0.001
[2025-07-24 18:22:56,900] [INFO] Epoch 2/5, ValAcc: 35.17%, TrainLoss: 2.5896, ValLoss: 2.2445, LR: 0.001
[2025-07-24 18:23:27,432] [INFO] Epoch 3/5, ValAcc: 38.09%, TrainLoss: 2.1252, ValLoss: 2.1182, LR: 0.001
[2025-07-24 18:23:57,722] [INFO] Epoch 4/5, ValAcc: 46.44%, TrainLoss: 1.9161, ValLoss: 1.8063, LR: 0.001
[2025-07-24 18:24:27,128] [INFO] Epoch 5/5, ValAcc: 46.27%, TrainLoss: 1.7926, ValLoss: 1.7840, LR: 0.001
[2025-07-24 18:24:29,543] [INFO] Namespace(path=['meta-free-apps/meta-ip_dst/meta-ip_dst.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_dst.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_dst.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dst', name='ipdst_token_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.4614,0.4659,0.5276,0.4627
[2025-07-24 18:25:10,004] [INFO] Feature 0 normalized using token
[2025-07-24 18:25:10,005] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:25:10,024] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(102, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:25:10,024] [INFO] Training...
[2025-07-24 18:25:35,357] [INFO] Epoch 1/5, ValAcc: 7.42%, TrainLoss: 4.1848, ValLoss: 3.8104, LR: 0.001
[2025-07-24 18:26:01,102] [INFO] Epoch 2/5, ValAcc: 28.83%, TrainLoss: 3.2929, ValLoss: 2.6073, LR: 0.001
[2025-07-24 18:26:26,707] [INFO] Epoch 3/5, ValAcc: 40.88%, TrainLoss: 2.4769, ValLoss: 2.0913, LR: 0.001
[2025-07-24 18:26:52,304] [INFO] Epoch 4/5, ValAcc: 40.04%, TrainLoss: 2.1236, ValLoss: 2.0146, LR: 0.001
[2025-07-24 18:27:18,092] [INFO] Epoch 5/5, ValAcc: 47.85%, TrainLoss: 1.9080, ValLoss: 1.7586, LR: 0.001
[2025-07-24 18:27:20,586] [INFO] Namespace(path=['meta-free-apps/meta-ip_dst/meta-ip_dst.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_dst.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_dst.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dst', name='ipdst_token_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.4774,0.4679,0.5220,0.4784
[2025-07-24 18:28:01,077] [INFO] Feature 0 normalized using token
[2025-07-24 18:28:01,078] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:28:01,102] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(102, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:28:01,102] [INFO] Training...
[2025-07-24 18:28:45,300] [INFO] Epoch 1/5, ValAcc: 21.40%, TrainLoss: 3.8365, ValLoss: 2.9521, LR: 0.001
[2025-07-24 18:29:29,176] [INFO] Epoch 2/5, ValAcc: 29.44%, TrainLoss: 2.5820, ValLoss: 2.4750, LR: 0.001
[2025-07-24 18:30:11,742] [INFO] Epoch 3/5, ValAcc: 47.41%, TrainLoss: 2.0516, ValLoss: 1.7720, LR: 0.001
[2025-07-24 18:30:56,102] [INFO] Epoch 4/5, ValAcc: 50.66%, TrainLoss: 1.8015, ValLoss: 1.6078, LR: 0.001
[2025-07-24 18:31:40,736] [INFO] Epoch 5/5, ValAcc: 55.22%, TrainLoss: 1.6416, ValLoss: 1.4534, LR: 0.001
[2025-07-24 18:31:45,410] [INFO] Namespace(path=['meta-free-apps/meta-ip_dst/meta-ip_dst.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_dst.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_dst.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dst', name='ipdst_token_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.5437,0.5369,0.5742,0.5475
[2025-07-24 18:32:25,685] [INFO] Feature 0 normalized using token
[2025-07-24 18:32:25,685] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:32:25,702] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(102, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:32:25,702] [INFO] Training...
[2025-07-24 18:32:47,158] [INFO] Epoch 1/5, ValAcc: 8.40%, TrainLoss: 4.0670, ValLoss: 3.7513, LR: 0.001
[2025-07-24 18:33:08,565] [INFO] Epoch 2/5, ValAcc: 11.95%, TrainLoss: 3.6932, ValLoss: 3.5391, LR: 0.001
[2025-07-24 18:33:30,024] [INFO] Epoch 3/5, ValAcc: 15.87%, TrainLoss: 3.4700, ValLoss: 3.3033, LR: 0.001
[2025-07-24 18:33:51,409] [INFO] Epoch 4/5, ValAcc: 18.60%, TrainLoss: 3.3185, ValLoss: 3.1546, LR: 0.001
[2025-07-24 18:34:12,737] [INFO] Epoch 5/5, ValAcc: 22.25%, TrainLoss: 3.1775, ValLoss: 2.9890, LR: 0.001
[2025-07-24 18:34:13,645] [INFO] Namespace(path=['meta-free-apps/meta-ip_dst/meta-ip_dst.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_dst.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_dst.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dst', name='ipdst_token_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.2262,0.2138,0.2568,0.2272
[2025-07-24 18:34:53,472] [INFO] Feature 0 normalized using token
[2025-07-24 18:34:53,472] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:34:53,493] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(102, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:34:53,493] [INFO] Training...
[2025-07-24 18:35:18,463] [INFO] Epoch 1/5, ValAcc: 10.76%, TrainLoss: 3.9836, ValLoss: 3.6176, LR: 0.001
[2025-07-24 18:35:43,555] [INFO] Epoch 2/5, ValAcc: 16.77%, TrainLoss: 3.4852, ValLoss: 3.2395, LR: 0.001
[2025-07-24 18:36:08,832] [INFO] Epoch 3/5, ValAcc: 19.99%, TrainLoss: 3.2359, ValLoss: 3.0719, LR: 0.001
[2025-07-24 18:36:34,011] [INFO] Epoch 4/5, ValAcc: 24.00%, TrainLoss: 3.0810, ValLoss: 2.8681, LR: 0.001
[2025-07-24 18:36:59,024] [INFO] Epoch 5/5, ValAcc: 23.05%, TrainLoss: 2.9552, ValLoss: 2.9103, LR: 0.001
[2025-07-24 18:37:00,498] [INFO] Namespace(path=['meta-free-apps/meta-ip_dst/meta-ip_dst.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_dst.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_dst.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dst', name='ipdst_token_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.2288,0.2110,0.2512,0.2290
[2025-07-24 18:37:01,206] [INFO] best(dst): bilstm, accuracy: 0.5437, f1: 0.5369, precision: 0.5742, recall: 0.5475
[INFO] ip_proto → Best normalization: token
Running: python vrscanner.py --step2 --path meta-free-apps/meta-ip_proto/meta-ip_proto.csv --norm token --debug_path output/meta-free-apps/step2/step2_meta_ip_proto.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_ip_proto.csv
[2025-07-24 18:37:04,564] [INFO] Namespace(path=['meta-free-apps/meta-ip_proto/meta-ip_proto.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_proto.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_proto.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='proto')
[2025-07-24 18:40:20,342] [INFO] Processed data from meta-free-apps/meta-ip_proto/meta-ip_proto.csv:
[2025-07-24 18:40:20,342] [INFO] (84492, 500)
[2025-07-24 18:40:20,342] [INFO] [['6' '6' '6' ... '6' '6' '6']
 ['6' '6' '6' ... '6' '6' '6']
 ['6' '6' '6' ... '6' '6' '6']
 ...
 ['6' '6' '6' ... '6' '6' '6']
 ['6' '6' '6' ... '6' '6' '6']
 ['6' '6' '6' ... '6' '6' '6']]
[2025-07-24 18:40:38,236] [INFO] Feature 0 normalized using token
[2025-07-24 18:40:38,236] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:40:38,279] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(4, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:40:38,279] [INFO] Training...
[2025-07-24 18:41:01,800] [INFO] Epoch 1/5, ValAcc: 0.98%, TrainLoss: 4.5127, ValLoss: 4.5118, LR: 0.001
[2025-07-24 18:41:24,610] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5113, ValLoss: 4.5122, LR: 0.001
[2025-07-24 18:41:47,247] [INFO] Epoch 3/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 18:42:11,898] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 18:42:35,629] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 18:42:36,998] [INFO] Namespace(path=['meta-free-apps/meta-ip_proto/meta-ip_proto.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_proto.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_proto.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='proto', name='ipproto_token_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 18:42:55,174] [INFO] Feature 0 normalized using token
[2025-07-24 18:42:55,175] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:42:55,225] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(4, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:42:55,225] [INFO] Training...
[2025-07-24 18:43:24,257] [INFO] Epoch 1/5, ValAcc: 1.05%, TrainLoss: 4.5126, ValLoss: 4.5102, LR: 0.001
[2025-07-24 18:43:55,634] [INFO] Epoch 2/5, ValAcc: 0.99%, TrainLoss: 4.5087, ValLoss: 4.5083, LR: 0.001
[2025-07-24 18:44:26,342] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5086, ValLoss: 4.5124, LR: 0.001
[2025-07-24 18:44:56,455] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 18:45:26,414] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5125, LR: 0.001
[2025-07-24 18:45:28,835] [INFO] Namespace(path=['meta-free-apps/meta-ip_proto/meta-ip_proto.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_proto.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_proto.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='proto', name='ipproto_token_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 18:45:47,045] [INFO] Feature 0 normalized using token
[2025-07-24 18:45:47,045] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:45:47,092] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(4, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:45:47,093] [INFO] Training...
[2025-07-24 18:46:12,675] [INFO] Epoch 1/5, ValAcc: 1.85%, TrainLoss: 4.5022, ValLoss: 4.4873, LR: 0.001
[2025-07-24 18:46:38,238] [INFO] Epoch 2/5, ValAcc: 1.83%, TrainLoss: 4.4906, ValLoss: 4.4856, LR: 0.001
[2025-07-24 18:47:03,930] [INFO] Epoch 3/5, ValAcc: 1.99%, TrainLoss: 4.4873, ValLoss: 4.4813, LR: 0.001
[2025-07-24 18:47:29,631] [INFO] Epoch 4/5, ValAcc: 1.98%, TrainLoss: 4.4865, ValLoss: 4.4809, LR: 0.001
[2025-07-24 18:47:54,971] [INFO] Epoch 5/5, ValAcc: 2.00%, TrainLoss: 4.4858, ValLoss: 4.4819, LR: 0.001
[2025-07-24 18:47:57,437] [INFO] Namespace(path=['meta-free-apps/meta-ip_proto/meta-ip_proto.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_proto.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_proto.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='proto', name='ipproto_token_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0195,0.0031,0.0022,0.0196
[2025-07-24 18:48:15,544] [INFO] Feature 0 normalized using token
[2025-07-24 18:48:15,544] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:48:15,591] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(4, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:48:15,591] [INFO] Training...
[2025-07-24 18:48:59,384] [INFO] Epoch 1/5, ValAcc: 2.04%, TrainLoss: 4.4992, ValLoss: 4.4839, LR: 0.001
[2025-07-24 18:49:43,442] [INFO] Epoch 2/5, ValAcc: 1.99%, TrainLoss: 4.4874, ValLoss: 4.4865, LR: 0.001
[2025-07-24 18:50:27,603] [INFO] Epoch 3/5, ValAcc: 1.86%, TrainLoss: 4.4853, ValLoss: 4.4801, LR: 0.001
[2025-07-24 18:51:12,121] [INFO] Epoch 4/5, ValAcc: 2.01%, TrainLoss: 4.4826, ValLoss: 4.4750, LR: 0.001
[2025-07-24 18:51:56,301] [INFO] Epoch 5/5, ValAcc: 1.98%, TrainLoss: 4.4788, ValLoss: 4.4721, LR: 0.001
[2025-07-24 18:52:00,890] [INFO] Namespace(path=['meta-free-apps/meta-ip_proto/meta-ip_proto.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_proto.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_proto.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='proto', name='ipproto_token_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0195,0.0032,0.0042,0.0196
[2025-07-24 18:52:19,017] [INFO] Feature 0 normalized using token
[2025-07-24 18:52:19,017] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:52:19,060] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(4, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:52:19,061] [INFO] Training...
[2025-07-24 18:52:41,112] [INFO] Epoch 1/5, ValAcc: 1.89%, TrainLoss: 4.5052, ValLoss: 4.4889, LR: 0.001
[2025-07-24 18:53:02,697] [INFO] Epoch 2/5, ValAcc: 1.92%, TrainLoss: 4.4941, ValLoss: 4.4881, LR: 0.001
[2025-07-24 18:53:24,226] [INFO] Epoch 3/5, ValAcc: 1.87%, TrainLoss: 4.4920, ValLoss: 4.4882, LR: 0.001
[2025-07-24 18:53:42,358] [INFO] Epoch 4/5, ValAcc: 1.86%, TrainLoss: 4.4890, ValLoss: 4.4894, LR: 0.001
[2025-07-24 18:54:03,909] [INFO] Epoch 5/5, ValAcc: 1.98%, TrainLoss: 4.4889, ValLoss: 4.4824, LR: 0.001
[2025-07-24 18:54:04,835] [INFO] Namespace(path=['meta-free-apps/meta-ip_proto/meta-ip_proto.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_proto.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_proto.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='proto', name='ipproto_token_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0192,0.0030,0.0019,0.0193
[2025-07-24 18:54:22,972] [INFO] Feature 0 normalized using token
[2025-07-24 18:54:22,972] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 18:54:23,011] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(4, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 18:54:23,011] [INFO] Training...
[2025-07-24 18:54:48,533] [INFO] Epoch 1/5, ValAcc: 0.99%, TrainLoss: 4.5134, ValLoss: 4.5118, LR: 0.001
[2025-07-24 18:55:13,818] [INFO] Epoch 2/5, ValAcc: 1.04%, TrainLoss: 4.5112, ValLoss: 4.5122, LR: 0.001
[2025-07-24 18:55:39,090] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5121, LR: 0.001
[2025-07-24 18:56:04,365] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 18:56:29,545] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5107, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 18:56:31,055] [INFO] Namespace(path=['meta-free-apps/meta-ip_proto/meta-ip_proto.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_proto.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_proto.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='proto', name='ipproto_token_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 18:56:31,225] [INFO] best(proto): bilstm, accuracy: 0.0195, f1: 0.0032, precision: 0.0042, recall: 0.0196
[INFO] ip_len → Best normalization: token
Running: python vrscanner.py --step2 --path meta-free-apps/meta-ip_len/meta-ip_len.csv --norm token --debug_path output/meta-free-apps/step2/step2_meta_ip_len.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_ip_len.csv
[2025-07-24 18:56:34,418] [INFO] Namespace(path=['meta-free-apps/meta-ip_len/meta-ip_len.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_len.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_len.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='len')
[2025-07-24 19:00:34,219] [INFO] Processed data from meta-free-apps/meta-ip_len/meta-ip_len.csv:
[2025-07-24 19:00:34,220] [INFO] (84492, 500)
[2025-07-24 19:00:34,220] [INFO] [['656' '94' '52' ... '1432' '1432' '1432']
 ['423' '87' '52' ... '52' '242' '141']
 ['423' '87' '52' ... '52' '40' '40']
 ...
 ['242' '87' '52' ... '1432' '1432' '1432']
 ['60' '60' '52' ... '1432' '1432' '52']
 ['64' '52' '52' ... '52' '355' '87']]
[2025-07-24 19:01:23,339] [INFO] Feature 0 normalized using token
[2025-07-24 19:01:23,340] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:01:23,397] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(1385, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:01:23,397] [INFO] Training...
[2025-07-24 19:01:48,047] [INFO] Epoch 1/5, ValAcc: 72.30%, TrainLoss: 3.0009, ValLoss: 1.0793, LR: 0.001
[2025-07-24 19:02:11,702] [INFO] Epoch 2/5, ValAcc: 90.84%, TrainLoss: 0.6128, ValLoss: 0.3730, LR: 0.001
[2025-07-24 19:02:35,481] [INFO] Epoch 3/5, ValAcc: 92.15%, TrainLoss: 0.3617, ValLoss: 0.3294, LR: 0.001
[2025-07-24 19:02:59,278] [INFO] Epoch 4/5, ValAcc: 92.20%, TrainLoss: 0.3071, ValLoss: 0.3482, LR: 0.001
[2025-07-24 19:03:21,456] [INFO] Epoch 5/5, ValAcc: 92.38%, TrainLoss: 0.2933, ValLoss: 0.3154, LR: 0.001
[2025-07-24 19:03:22,845] [INFO] Namespace(path=['meta-free-apps/meta-ip_len/meta-ip_len.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_len.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_len.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='len', name='iplen_token_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.9246,0.9256,0.9353,0.9252
[2025-07-24 19:04:13,439] [INFO] Feature 0 normalized using token
[2025-07-24 19:04:13,439] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:04:13,473] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(1385, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:04:13,473] [INFO] Training...
[2025-07-24 19:04:43,067] [INFO] Epoch 1/5, ValAcc: 85.08%, TrainLoss: 2.4102, ValLoss: 0.6254, LR: 0.001
[2025-07-24 19:05:12,642] [INFO] Epoch 2/5, ValAcc: 91.14%, TrainLoss: 0.4809, ValLoss: 0.3593, LR: 0.001
[2025-07-24 19:05:42,248] [INFO] Epoch 3/5, ValAcc: 91.76%, TrainLoss: 0.3435, ValLoss: 0.3567, LR: 0.001
[2025-07-24 19:06:11,908] [INFO] Epoch 4/5, ValAcc: 92.24%, TrainLoss: 0.3108, ValLoss: 0.3464, LR: 0.001
[2025-07-24 19:06:41,571] [INFO] Epoch 5/5, ValAcc: 92.45%, TrainLoss: 0.2968, ValLoss: 0.3295, LR: 0.001
[2025-07-24 19:06:43,987] [INFO] Namespace(path=['meta-free-apps/meta-ip_len/meta-ip_len.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_len.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_len.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='len', name='iplen_token_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.9250,0.9360,0.9544,0.9248
[2025-07-24 19:07:33,085] [INFO] Feature 0 normalized using token
[2025-07-24 19:07:33,085] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:07:33,142] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(1385, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:07:33,142] [INFO] Training...
[2025-07-24 19:07:58,945] [INFO] Epoch 1/5, ValAcc: 44.88%, TrainLoss: 3.5939, ValLoss: 1.8194, LR: 0.001
[2025-07-24 19:08:24,661] [INFO] Epoch 2/5, ValAcc: 87.38%, TrainLoss: 0.9855, ValLoss: 0.5471, LR: 0.001
[2025-07-24 19:08:50,496] [INFO] Epoch 3/5, ValAcc: 88.47%, TrainLoss: 0.5487, ValLoss: 0.4952, LR: 0.001
[2025-07-24 19:09:16,023] [INFO] Epoch 4/5, ValAcc: 89.51%, TrainLoss: 0.4499, ValLoss: 0.4386, LR: 0.001
[2025-07-24 19:09:41,248] [INFO] Epoch 5/5, ValAcc: 90.66%, TrainLoss: 0.3963, ValLoss: 0.4034, LR: 0.001
[2025-07-24 19:09:43,745] [INFO] Namespace(path=['meta-free-apps/meta-ip_len/meta-ip_len.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_len.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_len.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='len', name='iplen_token_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.9088,0.9141,0.9301,0.9090
[2025-07-24 19:10:32,811] [INFO] Feature 0 normalized using token
[2025-07-24 19:10:32,812] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:10:32,842] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(1385, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:10:32,842] [INFO] Training...
[2025-07-24 19:11:17,425] [INFO] Epoch 1/5, ValAcc: 85.10%, TrainLoss: 2.8267, ValLoss: 0.5919, LR: 0.001
[2025-07-24 19:12:02,090] [INFO] Epoch 2/5, ValAcc: 90.65%, TrainLoss: 0.4758, ValLoss: 0.3729, LR: 0.001
[2025-07-24 19:12:46,931] [INFO] Epoch 3/5, ValAcc: 91.73%, TrainLoss: 0.3571, ValLoss: 0.3394, LR: 0.001
[2025-07-24 19:13:31,974] [INFO] Epoch 4/5, ValAcc: 91.96%, TrainLoss: 0.3166, ValLoss: 0.3242, LR: 0.001
[2025-07-24 19:14:15,674] [INFO] Epoch 5/5, ValAcc: 92.01%, TrainLoss: 0.2934, ValLoss: 0.3332, LR: 0.001
[2025-07-24 19:14:20,350] [INFO] Namespace(path=['meta-free-apps/meta-ip_len/meta-ip_len.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_len.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_len.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='len', name='iplen_token_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.9216,0.9248,0.9393,0.9220
[2025-07-24 19:15:10,397] [INFO] Feature 0 normalized using token
[2025-07-24 19:15:10,397] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:15:10,425] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(1385, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:15:10,425] [INFO] Training...
[2025-07-24 19:15:31,456] [INFO] Epoch 1/5, ValAcc: 10.79%, TrainLoss: 4.1055, ValLoss: 3.6504, LR: 0.001
[2025-07-24 19:15:52,170] [INFO] Epoch 2/5, ValAcc: 28.46%, TrainLoss: 3.3511, ValLoss: 2.7541, LR: 0.001
[2025-07-24 19:16:13,367] [INFO] Epoch 3/5, ValAcc: 38.84%, TrainLoss: 2.6799, ValLoss: 2.3208, LR: 0.001
[2025-07-24 19:16:34,654] [INFO] Epoch 4/5, ValAcc: 48.77%, TrainLoss: 2.2783, ValLoss: 1.9202, LR: 0.001
[2025-07-24 19:16:56,273] [INFO] Epoch 5/5, ValAcc: 57.21%, TrainLoss: 1.9344, ValLoss: 1.5996, LR: 0.001
[2025-07-24 19:16:57,184] [INFO] Namespace(path=['meta-free-apps/meta-ip_len/meta-ip_len.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_len.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_len.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='len', name='iplen_token_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.5648,0.5749,0.6350,0.5660
[2025-07-24 19:17:46,294] [INFO] Feature 0 normalized using token
[2025-07-24 19:17:46,294] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:17:46,323] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(1385, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:17:46,324] [INFO] Training...
[2025-07-24 19:18:11,450] [INFO] Epoch 1/5, ValAcc: 39.04%, TrainLoss: 3.4345, ValLoss: 2.2110, LR: 0.001
[2025-07-24 19:18:35,385] [INFO] Epoch 2/5, ValAcc: 56.88%, TrainLoss: 2.0118, ValLoss: 1.6582, LR: 0.001
[2025-07-24 19:19:00,823] [INFO] Epoch 3/5, ValAcc: 71.20%, TrainLoss: 1.5820, ValLoss: 1.1642, LR: 0.001
[2025-07-24 19:19:25,928] [INFO] Epoch 4/5, ValAcc: 79.95%, TrainLoss: 1.1038, ValLoss: 0.8261, LR: 0.001
[2025-07-24 19:19:50,874] [INFO] Epoch 5/5, ValAcc: 83.02%, TrainLoss: 0.8909, ValLoss: 0.7225, LR: 0.001
[2025-07-24 19:19:52,347] [INFO] Namespace(path=['meta-free-apps/meta-ip_len/meta-ip_len.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_len.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_len.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='len', name='iplen_token_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.8309,0.8463,0.8738,0.8309
[2025-07-24 19:19:53,047] [INFO] best(len): bigru, accuracy: 0.9250, f1: 0.9360, precision: 0.9544, recall: 0.9248
[INFO] ip_id → Best normalization: robust
Running: python vrscanner.py --step2 --path meta-free-apps/meta-ip_id/meta-ip_id.csv --norm robust --debug_path output/meta-free-apps/step2/step2_meta_ip_id.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_ip_id.csv
[2025-07-24 19:19:56,541] [INFO] Namespace(path=['meta-free-apps/meta-ip_id/meta-ip_id.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_id.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_id.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='id')
[2025-07-24 19:25:09,111] [INFO] Processed data from meta-free-apps/meta-ip_id/meta-ip_id.csv:
[2025-07-24 19:25:09,111] [INFO] (84492, 500)
[2025-07-24 19:25:09,111] [INFO] [['10160' '13005' '10161' ... '51552' '51553' '51554']
 ['26258' '53706' '26259' ... '46841' '17747' '17748']
 ['2466' '1471' '2467' ... '26232' '0' '0']
 ...
 ['8991' '56715' '8992' ... '11761' '11762' '11763']
 ['9357' '0' '9358' ... '25008' '25009' '44536']
 ['32464' '32465' '32466' ... '31279' '47584' '14019']]
[2025-07-24 19:25:31,658] [INFO] Feature 0 normalized using robust
[2025-07-24 19:25:31,658] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:25:31,695] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:25:31,695] [INFO] Training...
[2025-07-24 19:25:53,988] [INFO] Epoch 1/5, ValAcc: 1.07%, TrainLoss: 4.5133, ValLoss: 4.5121, LR: 0.001
[2025-07-24 19:26:14,605] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5113, ValLoss: 4.5120, LR: 0.001
[2025-07-24 19:26:37,799] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 19:27:01,062] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 19:27:18,367] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5107, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 19:27:19,705] [INFO] Namespace(path=['meta-free-apps/meta-ip_id/meta-ip_id.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_id.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_id.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='id', name='ipid_robust_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 19:27:42,365] [INFO] Feature 0 normalized using robust
[2025-07-24 19:27:42,365] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:27:42,382] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:27:42,382] [INFO] Training...
[2025-07-24 19:28:12,040] [INFO] Epoch 1/5, ValAcc: 0.98%, TrainLoss: 4.5132, ValLoss: 4.5119, LR: 0.001
[2025-07-24 19:28:41,446] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 19:29:11,016] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 19:29:40,036] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 19:30:09,814] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 19:30:12,227] [INFO] Namespace(path=['meta-free-apps/meta-ip_id/meta-ip_id.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_id.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_id.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='id', name='ipid_robust_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 19:30:35,252] [INFO] Feature 0 normalized using robust
[2025-07-24 19:30:35,252] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:30:35,265] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:30:35,265] [INFO] Training...
[2025-07-24 19:31:00,677] [INFO] Epoch 1/5, ValAcc: 0.98%, TrainLoss: 4.5122, ValLoss: 4.5121, LR: 0.001
[2025-07-24 19:31:25,908] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5124, LR: 0.001
[2025-07-24 19:31:51,327] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 19:32:16,671] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5110, ValLoss: 4.5126, LR: 0.001
[2025-07-24 19:32:41,128] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5125, LR: 0.0005
[2025-07-24 19:32:43,576] [INFO] Namespace(path=['meta-free-apps/meta-ip_id/meta-ip_id.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_id.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_id.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='id', name='ipid_robust_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 19:33:06,992] [INFO] Feature 0 normalized using robust
[2025-07-24 19:33:06,993] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:33:07,010] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:33:07,010] [INFO] Training...
[2025-07-24 19:33:50,544] [INFO] Epoch 1/5, ValAcc: 0.91%, TrainLoss: 4.5123, ValLoss: 4.5122, LR: 0.001
[2025-07-24 19:34:34,037] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5113, ValLoss: 4.5122, LR: 0.001
[2025-07-24 19:35:17,557] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 19:36:01,065] [INFO] Epoch 4/5, ValAcc: 0.91%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 19:36:44,538] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 19:36:49,083] [INFO] Namespace(path=['meta-free-apps/meta-ip_id/meta-ip_id.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_id.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_id.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='id', name='ipid_robust_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 19:37:11,533] [INFO] Feature 0 normalized using robust
[2025-07-24 19:37:11,533] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:37:11,545] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:37:11,545] [INFO] Training...
[2025-07-24 19:37:31,186] [INFO] Epoch 1/5, ValAcc: 0.98%, TrainLoss: 4.5130, ValLoss: 4.5122, LR: 0.001
[2025-07-24 19:37:51,589] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5113, ValLoss: 4.5121, LR: 0.001
[2025-07-24 19:38:13,095] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 19:38:34,524] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 19:38:55,057] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 19:38:55,968] [INFO] Namespace(path=['meta-free-apps/meta-ip_id/meta-ip_id.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_id.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_id.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='id', name='ipid_robust_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 19:39:18,426] [INFO] Feature 0 normalized using robust
[2025-07-24 19:39:18,426] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:39:18,440] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:39:18,440] [INFO] Training...
[2025-07-24 19:39:42,727] [INFO] Epoch 1/5, ValAcc: 0.98%, TrainLoss: 4.5135, ValLoss: 4.5124, LR: 0.001
[2025-07-24 19:40:07,328] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5116, ValLoss: 4.5123, LR: 0.001
[2025-07-24 19:40:31,890] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 19:40:56,605] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5110, ValLoss: 4.5124, LR: 0.001
[2025-07-24 19:41:21,190] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 19:41:22,666] [INFO] Namespace(path=['meta-free-apps/meta-ip_id/meta-ip_id.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_id.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_id.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='id', name='ipid_robust_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 19:41:23,726] [INFO] best(id): gru, accuracy: 0.0102, f1: 0.0002, precision: 0.0001, recall: 0.0110
[INFO] ip_frag → Best normalization: none
Running: python vrscanner.py --step2 --path meta-free-apps/meta-ip_frag/meta-ip_frag.csv --norm none --debug_path output/meta-free-apps/step2/step2_meta_ip_frag.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_ip_frag.csv
[2025-07-24 19:41:27,414] [INFO] Namespace(path=['meta-free-apps/meta-ip_frag/meta-ip_frag.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_frag.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_frag.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='frag')
[2025-07-24 19:44:42,793] [INFO] Processed data from meta-free-apps/meta-ip_frag/meta-ip_frag.csv:
[2025-07-24 19:44:42,794] [INFO] (84492, 500)
[2025-07-24 19:44:42,794] [INFO] [['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']
 ...
 ['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']]
[2025-07-24 19:44:56,996] [INFO] Feature 0 normalized using none
[2025-07-24 19:44:56,997] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:44:57,032] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): GRU(1, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:44:57,033] [INFO] Training...
[2025-07-24 19:45:18,830] [INFO] Epoch 1/5, ValAcc: 0.91%, TrainLoss: 4.5124, ValLoss: 4.5121, LR: 0.001
[2025-07-24 19:45:37,426] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5113, ValLoss: 4.5121, LR: 0.001
[2025-07-24 19:45:59,542] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 19:46:22,002] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 19:46:44,150] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 19:46:45,432] [INFO] Namespace(path=['meta-free-apps/meta-ip_frag/meta-ip_frag.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_frag.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_frag.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='frag', name='ipfrag_none_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 19:47:00,213] [INFO] Feature 0 normalized using none
[2025-07-24 19:47:00,213] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:47:00,227] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): GRU(1, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:47:00,227] [INFO] Training...
[2025-07-24 19:47:23,699] [INFO] Epoch 1/5, ValAcc: 1.07%, TrainLoss: 4.5124, ValLoss: 4.5121, LR: 0.001
[2025-07-24 19:47:50,858] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5122, LR: 0.001
[2025-07-24 19:48:14,316] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 19:48:38,167] [INFO] Epoch 4/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 19:49:04,677] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 19:49:06,947] [INFO] Namespace(path=['meta-free-apps/meta-ip_frag/meta-ip_frag.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_frag.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_frag.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='frag', name='ipfrag_none_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 19:49:21,655] [INFO] Feature 0 normalized using none
[2025-07-24 19:49:21,655] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:49:21,681] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): LSTM(1, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:49:21,681] [INFO] Training...
[2025-07-24 19:49:44,816] [INFO] Epoch 1/5, ValAcc: 1.11%, TrainLoss: 4.5120, ValLoss: 4.5124, LR: 0.001
[2025-07-24 19:50:08,524] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5124, LR: 0.001
[2025-07-24 19:50:33,085] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 19:50:56,843] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 19:51:21,233] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 19:51:23,620] [INFO] Namespace(path=['meta-free-apps/meta-ip_frag/meta-ip_frag.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_frag.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_frag.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='frag', name='ipfrag_none_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 19:51:38,252] [INFO] Feature 0 normalized using none
[2025-07-24 19:51:38,253] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:51:38,268] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): LSTM(1, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:51:38,268] [INFO] Training...
[2025-07-24 19:52:20,157] [INFO] Epoch 1/5, ValAcc: 0.91%, TrainLoss: 4.5124, ValLoss: 4.5121, LR: 0.001
[2025-07-24 19:53:01,940] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5113, ValLoss: 4.5120, LR: 0.001
[2025-07-24 19:53:44,087] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5121, LR: 0.001
[2025-07-24 19:54:26,468] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5110, ValLoss: 4.5121, LR: 0.001
[2025-07-24 19:55:08,711] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5121, LR: 0.0005
[2025-07-24 19:55:13,190] [INFO] Namespace(path=['meta-free-apps/meta-ip_frag/meta-ip_frag.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_frag.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_frag.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='frag', name='ipfrag_none_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 19:55:27,861] [INFO] Feature 0 normalized using none
[2025-07-24 19:55:27,861] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:55:27,912] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): RNN(1, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:55:27,912] [INFO] Training...
[2025-07-24 19:55:47,638] [INFO] Epoch 1/5, ValAcc: 0.99%, TrainLoss: 4.5125, ValLoss: 4.5122, LR: 0.001
[2025-07-24 19:56:07,414] [INFO] Epoch 2/5, ValAcc: 1.04%, TrainLoss: 4.5112, ValLoss: 4.5122, LR: 0.001
[2025-07-24 19:56:27,492] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 19:56:47,538] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 19:57:07,309] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 19:57:08,222] [INFO] Namespace(path=['meta-free-apps/meta-ip_frag/meta-ip_frag.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_frag.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_frag.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='frag', name='ipfrag_none_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 19:57:22,785] [INFO] Feature 0 normalized using none
[2025-07-24 19:57:22,785] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 19:57:22,797] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): RNN(1, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 19:57:22,797] [INFO] Training...
[2025-07-24 19:57:46,591] [INFO] Epoch 1/5, ValAcc: 0.91%, TrainLoss: 4.5129, ValLoss: 4.5121, LR: 0.001
[2025-07-24 19:58:10,236] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5121, LR: 0.001
[2025-07-24 19:58:33,957] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 19:58:57,682] [INFO] Epoch 4/5, ValAcc: 0.91%, TrainLoss: 4.5111, ValLoss: 4.5125, LR: 0.001
[2025-07-24 19:59:21,719] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 19:59:23,169] [INFO] Namespace(path=['meta-free-apps/meta-ip_frag/meta-ip_frag.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_frag.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_frag.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='frag', name='ipfrag_none_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 19:59:23,284] [INFO] best(frag): gru, accuracy: 0.0102, f1: 0.0002, precision: 0.0001, recall: 0.0110
[INFO] ip_flags → Best normalization: token
Running: python vrscanner.py --step2 --path meta-free-apps/meta-ip_flags/meta-ip_flags.csv --norm token --debug_path output/meta-free-apps/step2/step2_meta_ip_flags.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_ip_flags.csv
[2025-07-24 19:59:26,414] [INFO] Namespace(path=['meta-free-apps/meta-ip_flags/meta-ip_flags.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_flags.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_flags.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='flags')
[2025-07-24 20:02:46,375] [INFO] Processed data from meta-free-apps/meta-ip_flags/meta-ip_flags.csv:
[2025-07-24 20:02:46,376] [INFO] (84492, 500)
[2025-07-24 20:02:46,376] [INFO] [['DF' 'DF' 'DF' ... 'DF' 'DF' 'DF']
 ['DF' 'DF' 'DF' ... 'DF' 'DF' 'DF']
 ['DF' 'DF' 'DF' ... 'DF' 'DF' 'DF']
 ...
 ['DF' 'DF' 'DF' ... 'DF' 'DF' 'DF']
 ['DF' 'DF' 'DF' ... 'DF' 'DF' 'DF']
 ['DF' 'DF' 'DF' ... 'DF' 'DF' 'DF']]
[2025-07-24 20:03:10,627] [INFO] Feature 0 normalized using token
[2025-07-24 20:03:10,627] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 20:03:10,679] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 20:03:10,680] [INFO] Training...
[2025-07-24 20:03:30,883] [INFO] Epoch 1/5, ValAcc: 0.99%, TrainLoss: 4.4893, ValLoss: 4.5118, LR: 0.001
[2025-07-24 20:03:54,045] [INFO] Epoch 2/5, ValAcc: 2.06%, TrainLoss: 4.4752, ValLoss: 4.4628, LR: 0.001
[2025-07-24 20:04:11,620] [INFO] Epoch 3/5, ValAcc: 2.09%, TrainLoss: 4.4581, ValLoss: 4.4580, LR: 0.001
[2025-07-24 20:04:34,993] [INFO] Epoch 4/5, ValAcc: 2.06%, TrainLoss: 4.4543, ValLoss: 4.4613, LR: 0.001
[2025-07-24 20:04:59,421] [INFO] Epoch 5/5, ValAcc: 2.14%, TrainLoss: 4.4523, ValLoss: 4.4558, LR: 0.001
[2025-07-24 20:05:00,790] [INFO] Namespace(path=['meta-free-apps/meta-ip_flags/meta-ip_flags.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_flags.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_flags.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='flags', name='ipflags_token_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0233,0.0179,0.0320,0.0235
[2025-07-24 20:05:25,454] [INFO] Feature 0 normalized using token
[2025-07-24 20:05:25,455] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 20:05:25,479] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 20:05:25,479] [INFO] Training...
[2025-07-24 20:05:55,073] [INFO] Epoch 1/5, ValAcc: 1.91%, TrainLoss: 4.4689, ValLoss: 4.4576, LR: 0.001
[2025-07-24 20:06:24,563] [INFO] Epoch 2/5, ValAcc: 1.99%, TrainLoss: 4.4571, ValLoss: 4.4575, LR: 0.001
[2025-07-24 20:06:55,159] [INFO] Epoch 3/5, ValAcc: 2.11%, TrainLoss: 4.4547, ValLoss: 4.4551, LR: 0.001
[2025-07-24 20:07:25,792] [INFO] Epoch 4/5, ValAcc: 2.17%, TrainLoss: 4.4527, ValLoss: 4.4551, LR: 0.001
[2025-07-24 20:07:55,853] [INFO] Epoch 5/5, ValAcc: 2.11%, TrainLoss: 4.4517, ValLoss: 4.4545, LR: 0.001
[2025-07-24 20:07:58,269] [INFO] Namespace(path=['meta-free-apps/meta-ip_flags/meta-ip_flags.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_flags.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_flags.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='flags', name='ipflags_token_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0237,0.0185,0.0327,0.0239
[2025-07-24 20:08:22,594] [INFO] Feature 0 normalized using token
[2025-07-24 20:08:22,594] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 20:08:22,614] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 20:08:22,614] [INFO] Training...
[2025-07-24 20:08:48,055] [INFO] Epoch 1/5, ValAcc: 1.59%, TrainLoss: 4.4806, ValLoss: 4.4688, LR: 0.001
[2025-07-24 20:09:13,590] [INFO] Epoch 2/5, ValAcc: 2.13%, TrainLoss: 4.4594, ValLoss: 4.4587, LR: 0.001
[2025-07-24 20:09:38,913] [INFO] Epoch 3/5, ValAcc: 2.04%, TrainLoss: 4.4534, ValLoss: 4.4586, LR: 0.001
[2025-07-24 20:10:00,405] [INFO] Epoch 4/5, ValAcc: 2.12%, TrainLoss: 4.4518, ValLoss: 4.4566, LR: 0.001
[2025-07-24 20:10:21,911] [INFO] Epoch 5/5, ValAcc: 2.07%, TrainLoss: 4.4511, ValLoss: 4.4560, LR: 0.001
[2025-07-24 20:10:24,376] [INFO] Namespace(path=['meta-free-apps/meta-ip_flags/meta-ip_flags.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_flags.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_flags.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='flags', name='ipflags_token_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0233,0.0171,0.0298,0.0235
[2025-07-24 20:10:48,560] [INFO] Feature 0 normalized using token
[2025-07-24 20:10:48,560] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 20:10:48,582] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 20:10:48,583] [INFO] Training...
[2025-07-24 20:11:31,600] [INFO] Epoch 1/5, ValAcc: 2.09%, TrainLoss: 4.4696, ValLoss: 4.4644, LR: 0.001
[2025-07-24 20:12:15,548] [INFO] Epoch 2/5, ValAcc: 1.92%, TrainLoss: 4.4573, ValLoss: 4.4632, LR: 0.001
[2025-07-24 20:12:59,727] [INFO] Epoch 3/5, ValAcc: 2.01%, TrainLoss: 4.4584, ValLoss: 4.4587, LR: 0.001
[2025-07-24 20:13:43,906] [INFO] Epoch 4/5, ValAcc: 2.15%, TrainLoss: 4.4528, ValLoss: 4.4554, LR: 0.001
[2025-07-24 20:14:28,182] [INFO] Epoch 5/5, ValAcc: 2.14%, TrainLoss: 4.4519, ValLoss: 4.4546, LR: 0.001
[2025-07-24 20:14:32,819] [INFO] Namespace(path=['meta-free-apps/meta-ip_flags/meta-ip_flags.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_flags.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_flags.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='flags', name='ipflags_token_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0234,0.0181,0.0323,0.0236
[2025-07-24 20:14:56,935] [INFO] Feature 0 normalized using token
[2025-07-24 20:14:56,935] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 20:14:56,958] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 20:14:56,958] [INFO] Training...
[2025-07-24 20:15:15,353] [INFO] Epoch 1/5, ValAcc: 1.21%, TrainLoss: 4.5136, ValLoss: 4.5115, LR: 0.001
[2025-07-24 20:15:36,541] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5121, LR: 0.001
[2025-07-24 20:15:53,992] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 20:16:15,447] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5110, ValLoss: 4.5124, LR: 0.001
[2025-07-24 20:16:36,856] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 20:16:37,769] [INFO] Namespace(path=['meta-free-apps/meta-ip_flags/meta-ip_flags.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_flags.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_flags.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='flags', name='ipflags_token_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 20:17:01,855] [INFO] Feature 0 normalized using token
[2025-07-24 20:17:01,856] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 20:17:01,875] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 20:17:01,875] [INFO] Training...
[2025-07-24 20:17:26,843] [INFO] Epoch 1/5, ValAcc: 1.04%, TrainLoss: 4.5133, ValLoss: 4.5117, LR: 0.001
[2025-07-24 20:17:52,062] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5122, LR: 0.001
[2025-07-24 20:18:17,072] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 20:18:42,058] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5110, ValLoss: 4.5122, LR: 0.001
[2025-07-24 20:19:07,027] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 20:19:08,504] [INFO] Namespace(path=['meta-free-apps/meta-ip_flags/meta-ip_flags.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_flags.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_flags.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='flags', name='ipflags_token_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 20:19:08,826] [INFO] best(flags): bigru, accuracy: 0.0237, f1: 0.0185, precision: 0.0327, recall: 0.0239
[INFO] ip_chksum → Best normalization: token
Running: python vrscanner.py --step2 --path meta-free-apps/meta-ip_chksum/meta-ip_chksum.csv --norm token --debug_path output/meta-free-apps/step2/step2_meta_ip_chksum.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_ip_chksum.csv
[2025-07-24 20:19:11,939] [INFO] Namespace(path=['meta-free-apps/meta-ip_chksum/meta-ip_chksum.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_chksum.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_chksum.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='chksum')
[2025-07-24 20:24:26,894] [INFO] Processed data from meta-free-apps/meta-ip_chksum/meta-ip_chksum.csv:
[2025-07-24 20:24:26,894] [INFO] (84492, 500)
[2025-07-24 20:24:26,894] [INFO] [['37264' '38821' '37867' ... '60666' '60665' '60664']
 ['21399' '63662' '21769' ... '1187' '33931' '34031']
 ['45191' '50362' '45561' ... '21796' '51880' '51880']
 ...
 ['38587' '60137' '38776' ... '34662' '34661' '34660']
 ['38403' '51344' '38410' ... '21415' '21414' '7363']
 ['15327' '15338' '15337' ... '16489' '65416' '37810']]
[2025-07-24 20:25:31,069] [INFO] Feature 0 normalized using token
[2025-07-24 20:25:31,070] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 20:25:31,165] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(65536, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 20:25:31,166] [INFO] Training...
[2025-07-24 20:25:54,680] [INFO] Epoch 1/5, ValAcc: 1.63%, TrainLoss: 4.5000, ValLoss: 4.4272, LR: 0.001
[2025-07-24 20:26:18,263] [INFO] Epoch 2/5, ValAcc: 4.38%, TrainLoss: 4.3422, ValLoss: 4.1960, LR: 0.001
[2025-07-24 20:26:42,717] [INFO] Epoch 3/5, ValAcc: 6.79%, TrainLoss: 4.0492, ValLoss: 4.0157, LR: 0.001
[2025-07-24 20:27:07,185] [INFO] Epoch 4/5, ValAcc: 8.32%, TrainLoss: 3.7841, ValLoss: 3.9823, LR: 0.001
[2025-07-24 20:27:31,411] [INFO] Epoch 5/5, ValAcc: 11.51%, TrainLoss: 3.4268, ValLoss: 3.9348, LR: 0.001
[2025-07-24 20:27:32,776] [INFO] Namespace(path=['meta-free-apps/meta-ip_chksum/meta-ip_chksum.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_chksum.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_chksum.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='chksum', name='ipchksum_token_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.1181,0.1023,0.1196,0.1181
[2025-07-24 20:28:37,041] [INFO] Feature 0 normalized using token
[2025-07-24 20:28:37,041] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 20:28:37,104] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(65536, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 20:28:37,104] [INFO] Training...
[2025-07-24 20:29:08,646] [INFO] Epoch 1/5, ValAcc: 2.01%, TrainLoss: 4.4823, ValLoss: 4.3906, LR: 0.001
[2025-07-24 20:29:40,302] [INFO] Epoch 2/5, ValAcc: 6.77%, TrainLoss: 4.1976, ValLoss: 3.9324, LR: 0.001
[2025-07-24 20:30:10,810] [INFO] Epoch 3/5, ValAcc: 14.07%, TrainLoss: 3.7179, ValLoss: 3.5253, LR: 0.001
[2025-07-24 20:30:42,665] [INFO] Epoch 4/5, ValAcc: 17.25%, TrainLoss: 3.3166, ValLoss: 3.4027, LR: 0.001
[2025-07-24 20:31:15,500] [INFO] Epoch 5/5, ValAcc: 19.04%, TrainLoss: 3.0251, ValLoss: 3.3885, LR: 0.001
[2025-07-24 20:31:17,967] [INFO] Namespace(path=['meta-free-apps/meta-ip_chksum/meta-ip_chksum.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_chksum.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_chksum.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='chksum', name='ipchksum_token_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.1952,0.1940,0.2293,0.1959
[2025-07-24 20:32:22,278] [INFO] Feature 0 normalized using token
[2025-07-24 20:32:22,278] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 20:32:22,338] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(65536, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 20:32:22,338] [INFO] Training...
[2025-07-24 20:32:50,055] [INFO] Epoch 1/5, ValAcc: 1.46%, TrainLoss: 4.5101, ValLoss: 4.4979, LR: 0.001
[2025-07-24 20:33:16,005] [INFO] Epoch 2/5, ValAcc: 2.15%, TrainLoss: 4.4298, ValLoss: 4.3975, LR: 0.001
[2025-07-24 20:33:43,645] [INFO] Epoch 3/5, ValAcc: 2.58%, TrainLoss: 4.3355, ValLoss: 4.3706, LR: 0.001
[2025-07-24 20:34:11,131] [INFO] Epoch 4/5, ValAcc: 2.96%, TrainLoss: 4.1892, ValLoss: 4.4422, LR: 0.001
[2025-07-24 20:34:38,718] [INFO] Epoch 5/5, ValAcc: 2.83%, TrainLoss: 3.9876, ValLoss: 4.6804, LR: 0.001
[2025-07-24 20:34:41,203] [INFO] Namespace(path=['meta-free-apps/meta-ip_chksum/meta-ip_chksum.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_chksum.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_chksum.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='chksum', name='ipchksum_token_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0330,0.0206,0.0261,0.0320
[2025-07-24 20:35:45,592] [INFO] Feature 0 normalized using token
[2025-07-24 20:35:45,592] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 20:35:45,665] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(65536, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 20:35:45,665] [INFO] Training...
[2025-07-24 20:36:31,613] [INFO] Epoch 1/5, ValAcc: 1.29%, TrainLoss: 4.5117, ValLoss: 4.5080, LR: 0.001
[2025-07-24 20:37:15,404] [INFO] Epoch 2/5, ValAcc: 2.58%, TrainLoss: 4.4213, ValLoss: 4.3511, LR: 0.001
[2025-07-24 20:38:01,338] [INFO] Epoch 3/5, ValAcc: 2.80%, TrainLoss: 4.3376, ValLoss: 4.3344, LR: 0.001
[2025-07-24 20:38:47,596] [INFO] Epoch 4/5, ValAcc: 3.07%, TrainLoss: 4.2483, ValLoss: 4.3460, LR: 0.001
[2025-07-24 20:39:33,588] [INFO] Epoch 5/5, ValAcc: 3.78%, TrainLoss: 4.0478, ValLoss: 4.3487, LR: 0.001
[2025-07-24 20:39:38,207] [INFO] Namespace(path=['meta-free-apps/meta-ip_chksum/meta-ip_chksum.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_chksum.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_chksum.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='chksum', name='ipchksum_token_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0399,0.0322,0.0526,0.0395
[2025-07-24 20:40:42,619] [INFO] Feature 0 normalized using token
[2025-07-24 20:40:42,620] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 20:40:42,680] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(65536, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 20:40:42,680] [INFO] Training...
[2025-07-24 20:41:04,380] [INFO] Epoch 1/5, ValAcc: 1.43%, TrainLoss: 4.5117, ValLoss: 4.5064, LR: 0.001
[2025-07-24 20:41:22,824] [INFO] Epoch 2/5, ValAcc: 1.03%, TrainLoss: 4.5095, ValLoss: 4.5124, LR: 0.001
[2025-07-24 20:41:44,529] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5123, LR: 0.001
[2025-07-24 20:42:06,344] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5119, ValLoss: 4.5122, LR: 0.001
[2025-07-24 20:42:28,597] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5122, LR: 0.0005
[2025-07-24 20:42:29,512] [INFO] Namespace(path=['meta-free-apps/meta-ip_chksum/meta-ip_chksum.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_chksum.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_chksum.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='chksum', name='ipchksum_token_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 20:43:34,679] [INFO] Feature 0 normalized using token
[2025-07-24 20:43:34,679] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 20:43:34,745] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(65536, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 20:43:34,745] [INFO] Training...
[2025-07-24 20:44:00,239] [INFO] Epoch 1/5, ValAcc: 0.82%, TrainLoss: 4.5113, ValLoss: 4.5130, LR: 0.001
[2025-07-24 20:44:25,458] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5120, ValLoss: 4.5121, LR: 0.001
[2025-07-24 20:44:51,302] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 20:45:16,798] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 20:45:42,206] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 20:45:43,679] [INFO] Namespace(path=['meta-free-apps/meta-ip_chksum/meta-ip_chksum.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_ip_chksum.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_ip_chksum.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='chksum', name='ipchksum_token_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 20:45:44,750] [INFO] best(chksum): bigru, accuracy: 0.1952, f1: 0.1940, precision: 0.2293, recall: 0.1959
[INFO] tcp_window → Best normalization: token
Running: python vrscanner.py --step2 --path meta-free-apps/meta-tcp_window/meta-tcp_window.csv --norm token --debug_path output/meta-free-apps/step2/step2_meta_tcp_window.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_tcp_window.csv
[2025-07-24 20:45:48,438] [INFO] Namespace(path=['meta-free-apps/meta-tcp_window/meta-tcp_window.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_window.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_window.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='window')
[2025-07-24 20:50:18,642] [INFO] Processed data from meta-free-apps/meta-tcp_window/meta-tcp_window.csv:
[2025-07-24 20:50:18,642] [INFO] (84492, 500)
[2025-07-24 20:50:18,642] [INFO] [['2747' '2038' '2747' ... '289' '289' '289']
 ['307' '307' '307' ... '645' '1121' '1121']
 ['307' '307' '307' ... '310' '0' '0']
 ...
 ['774' '1301' '774' ... '300' '300' '300']
 ['65535' '65535' '256' ... '300' '300' '1030']
 ['267' '278' '289' ... '1119' '1539' '2631']]
[2025-07-24 20:51:13,330] [INFO] Feature 0 normalized using token
[2025-07-24 20:51:13,331] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 20:51:13,380] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(5813, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 20:51:13,381] [INFO] Training...
[2025-07-24 20:51:33,343] [INFO] Epoch 1/5, ValAcc: 36.07%, TrainLoss: 3.3672, ValLoss: 2.3571, LR: 0.001
[2025-07-24 20:51:53,631] [INFO] Epoch 2/5, ValAcc: 51.79%, TrainLoss: 2.0729, ValLoss: 1.7098, LR: 0.001
[2025-07-24 20:52:16,687] [INFO] Epoch 3/5, ValAcc: 56.88%, TrainLoss: 1.6379, ValLoss: 1.4840, LR: 0.001
[2025-07-24 20:52:40,277] [INFO] Epoch 4/5, ValAcc: 58.43%, TrainLoss: 1.4436, ValLoss: 1.4429, LR: 0.001
[2025-07-24 20:53:03,981] [INFO] Epoch 5/5, ValAcc: 64.01%, TrainLoss: 1.3007, ValLoss: 1.2341, LR: 0.001
[2025-07-24 20:53:05,348] [INFO] Namespace(path=['meta-free-apps/meta-tcp_window/meta-tcp_window.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_window.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_window.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='window', name='tcpwindow_token_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.6470,0.6446,0.6851,0.6469
[2025-07-24 20:53:59,392] [INFO] Feature 0 normalized using token
[2025-07-24 20:53:59,392] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 20:53:59,426] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(5813, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 20:53:59,426] [INFO] Training...
[2025-07-24 20:54:28,140] [INFO] Epoch 1/5, ValAcc: 49.01%, TrainLoss: 3.0064, ValLoss: 1.8825, LR: 0.001
[2025-07-24 20:54:57,687] [INFO] Epoch 2/5, ValAcc: 58.47%, TrainLoss: 1.7221, ValLoss: 1.4240, LR: 0.001
[2025-07-24 20:55:27,531] [INFO] Epoch 3/5, ValAcc: 63.01%, TrainLoss: 1.3996, ValLoss: 1.2878, LR: 0.001
[2025-07-24 20:55:57,300] [INFO] Epoch 4/5, ValAcc: 64.50%, TrainLoss: 1.2340, ValLoss: 1.1942, LR: 0.001
[2025-07-24 20:56:27,119] [INFO] Epoch 5/5, ValAcc: 65.44%, TrainLoss: 1.1254, ValLoss: 1.1431, LR: 0.001
[2025-07-24 20:56:29,544] [INFO] Namespace(path=['meta-free-apps/meta-tcp_window/meta-tcp_window.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_window.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_window.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='window', name='tcpwindow_token_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.6602,0.6658,0.6974,0.6600
[2025-07-24 20:57:23,127] [INFO] Feature 0 normalized using token
[2025-07-24 20:57:23,127] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 20:57:23,162] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(5813, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 20:57:23,162] [INFO] Training...
[2025-07-24 20:57:48,442] [INFO] Epoch 1/5, ValAcc: 25.09%, TrainLoss: 3.6430, ValLoss: 2.8989, LR: 0.001
[2025-07-24 20:58:14,301] [INFO] Epoch 2/5, ValAcc: 40.25%, TrainLoss: 2.6050, ValLoss: 2.2312, LR: 0.001
[2025-07-24 20:58:39,887] [INFO] Epoch 3/5, ValAcc: 49.49%, TrainLoss: 2.0971, ValLoss: 1.8291, LR: 0.001
[2025-07-24 20:59:02,546] [INFO] Epoch 4/5, ValAcc: 48.00%, TrainLoss: 1.9353, ValLoss: 1.9004, LR: 0.001
[2025-07-24 20:59:28,399] [INFO] Epoch 5/5, ValAcc: 51.73%, TrainLoss: 1.8885, ValLoss: 1.7378, LR: 0.001
[2025-07-24 20:59:30,921] [INFO] Namespace(path=['meta-free-apps/meta-tcp_window/meta-tcp_window.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_window.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_window.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='window', name='tcpwindow_token_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.5277,0.5400,0.5988,0.5275
[2025-07-24 21:00:25,643] [INFO] Feature 0 normalized using token
[2025-07-24 21:00:25,644] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:00:25,679] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(5813, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:00:25,679] [INFO] Training...
[2025-07-24 21:01:09,560] [INFO] Epoch 1/5, ValAcc: 33.21%, TrainLoss: 3.4437, ValLoss: 2.4425, LR: 0.001
[2025-07-24 21:01:54,174] [INFO] Epoch 2/5, ValAcc: 52.22%, TrainLoss: 2.1272, ValLoss: 1.6492, LR: 0.001
[2025-07-24 21:02:38,919] [INFO] Epoch 3/5, ValAcc: 56.79%, TrainLoss: 1.6394, ValLoss: 1.4071, LR: 0.001
[2025-07-24 21:03:23,641] [INFO] Epoch 4/5, ValAcc: 60.77%, TrainLoss: 1.4067, ValLoss: 1.2694, LR: 0.001
[2025-07-24 21:04:08,225] [INFO] Epoch 5/5, ValAcc: 62.92%, TrainLoss: 1.2768, ValLoss: 1.2025, LR: 0.001
[2025-07-24 21:04:12,905] [INFO] Namespace(path=['meta-free-apps/meta-tcp_window/meta-tcp_window.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_window.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_window.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='window', name='tcpwindow_token_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.6230,0.6209,0.6675,0.6238
[2025-07-24 21:05:06,321] [INFO] Feature 0 normalized using token
[2025-07-24 21:05:06,322] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:05:06,352] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(5813, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:05:06,352] [INFO] Training...
[2025-07-24 21:05:27,714] [INFO] Epoch 1/5, ValAcc: 3.17%, TrainLoss: 4.0320, ValLoss: 4.3408, LR: 0.001
[2025-07-24 21:05:49,044] [INFO] Epoch 2/5, ValAcc: 2.00%, TrainLoss: 4.0342, ValLoss: 4.4404, LR: 0.001
[2025-07-24 21:06:10,485] [INFO] Epoch 3/5, ValAcc: 14.95%, TrainLoss: 3.9896, ValLoss: 3.4917, LR: 0.001
[2025-07-24 21:06:31,870] [INFO] Epoch 4/5, ValAcc: 19.15%, TrainLoss: 3.4548, ValLoss: 3.2059, LR: 0.001
[2025-07-24 21:06:53,637] [INFO] Epoch 5/5, ValAcc: 22.53%, TrainLoss: 3.3381, ValLoss: 3.0951, LR: 0.001
[2025-07-24 21:06:54,566] [INFO] Namespace(path=['meta-free-apps/meta-tcp_window/meta-tcp_window.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_window.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_window.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='window', name='tcpwindow_token_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.2244,0.2027,0.2363,0.2242
[2025-07-24 21:07:47,768] [INFO] Feature 0 normalized using token
[2025-07-24 21:07:47,768] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:07:47,799] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(5813, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:07:47,799] [INFO] Training...
[2025-07-24 21:08:12,763] [INFO] Epoch 1/5, ValAcc: 16.83%, TrainLoss: 3.8122, ValLoss: 3.3309, LR: 0.001
[2025-07-24 21:08:37,964] [INFO] Epoch 2/5, ValAcc: 27.86%, TrainLoss: 3.1444, ValLoss: 2.8290, LR: 0.001
[2025-07-24 21:09:03,028] [INFO] Epoch 3/5, ValAcc: 32.45%, TrainLoss: 2.7577, ValLoss: 2.5748, LR: 0.001
[2025-07-24 21:09:28,959] [INFO] Epoch 4/5, ValAcc: 34.34%, TrainLoss: 2.6970, ValLoss: 2.4591, LR: 0.001
[2025-07-24 21:09:54,082] [INFO] Epoch 5/5, ValAcc: 37.96%, TrainLoss: 2.4750, ValLoss: 2.3502, LR: 0.001
[2025-07-24 21:09:55,585] [INFO] Namespace(path=['meta-free-apps/meta-tcp_window/meta-tcp_window.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_window.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_window.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='window', name='tcpwindow_token_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.3766,0.3703,0.4748,0.3780
[2025-07-24 21:09:56,355] [INFO] best(window): bigru, accuracy: 0.6602, f1: 0.6658, precision: 0.6974, recall: 0.6600
[INFO] tcp_urgptr → Best normalization: none
Running: python vrscanner.py --step2 --path meta-free-apps/meta-tcp_urgptr/meta-tcp_urgptr.csv --norm none --debug_path output/meta-free-apps/step2/step2_meta_tcp_urgptr.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_tcp_urgptr.csv
[2025-07-24 21:09:59,909] [INFO] Namespace(path=['meta-free-apps/meta-tcp_urgptr/meta-tcp_urgptr.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_urgptr.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_urgptr.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='urgptr')
[2025-07-24 21:13:13,995] [INFO] Processed data from meta-free-apps/meta-tcp_urgptr/meta-tcp_urgptr.csv:
[2025-07-24 21:13:13,996] [INFO] (84492, 500)
[2025-07-24 21:13:13,996] [INFO] [['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']
 ...
 ['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']]
[2025-07-24 21:13:28,260] [INFO] Feature 0 normalized using none
[2025-07-24 21:13:28,261] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:13:28,306] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): GRU(1, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:13:28,306] [INFO] Training...
[2025-07-24 21:13:48,590] [INFO] Epoch 1/5, ValAcc: 1.04%, TrainLoss: 4.5122, ValLoss: 4.5113, LR: 0.001
[2025-07-24 21:14:09,946] [INFO] Epoch 2/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 21:14:31,899] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 21:14:53,192] [INFO] Epoch 4/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5125, LR: 0.001
[2025-07-24 21:15:14,112] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 21:15:15,397] [INFO] Namespace(path=['meta-free-apps/meta-tcp_urgptr/meta-tcp_urgptr.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_urgptr.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_urgptr.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='urgptr', name='tcpurgptr_none_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 21:15:30,489] [INFO] Feature 0 normalized using none
[2025-07-24 21:15:30,489] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:15:30,563] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): GRU(1, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:15:30,563] [INFO] Training...
[2025-07-24 21:15:58,300] [INFO] Epoch 1/5, ValAcc: 0.98%, TrainLoss: 4.5125, ValLoss: 4.5122, LR: 0.001
[2025-07-24 21:16:26,430] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5114, ValLoss: 4.5121, LR: 0.001
[2025-07-24 21:16:54,564] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 21:17:23,032] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 21:17:49,467] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 21:17:51,735] [INFO] Namespace(path=['meta-free-apps/meta-tcp_urgptr/meta-tcp_urgptr.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_urgptr.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_urgptr.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='urgptr', name='tcpurgptr_none_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 21:18:06,458] [INFO] Feature 0 normalized using none
[2025-07-24 21:18:06,459] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:18:06,489] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): LSTM(1, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:18:06,489] [INFO] Training...
[2025-07-24 21:18:28,351] [INFO] Epoch 1/5, ValAcc: 0.91%, TrainLoss: 4.5122, ValLoss: 4.5121, LR: 0.001
[2025-07-24 21:18:53,798] [INFO] Epoch 2/5, ValAcc: 1.04%, TrainLoss: 4.5112, ValLoss: 4.5122, LR: 0.001
[2025-07-24 21:19:18,376] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 21:19:42,977] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 21:20:07,594] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 21:20:09,989] [INFO] Namespace(path=['meta-free-apps/meta-tcp_urgptr/meta-tcp_urgptr.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_urgptr.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_urgptr.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='urgptr', name='tcpurgptr_none_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 21:20:24,680] [INFO] Feature 0 normalized using none
[2025-07-24 21:20:24,680] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:20:24,705] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): LSTM(1, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:20:24,705] [INFO] Training...
[2025-07-24 21:21:06,819] [INFO] Epoch 1/5, ValAcc: 1.04%, TrainLoss: 4.5120, ValLoss: 4.5122, LR: 0.001
[2025-07-24 21:21:48,830] [INFO] Epoch 2/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 21:22:31,011] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 21:23:13,307] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 21:23:55,640] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5107, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 21:24:00,121] [INFO] Namespace(path=['meta-free-apps/meta-tcp_urgptr/meta-tcp_urgptr.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_urgptr.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_urgptr.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='urgptr', name='tcpurgptr_none_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 21:24:15,006] [INFO] Feature 0 normalized using none
[2025-07-24 21:24:15,006] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:24:15,036] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): RNN(1, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:24:15,036] [INFO] Training...
[2025-07-24 21:24:34,930] [INFO] Epoch 1/5, ValAcc: 0.99%, TrainLoss: 4.5124, ValLoss: 4.5121, LR: 0.001
[2025-07-24 21:24:54,561] [INFO] Epoch 2/5, ValAcc: 1.04%, TrainLoss: 4.5112, ValLoss: 4.5122, LR: 0.001
[2025-07-24 21:25:14,096] [INFO] Epoch 3/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5121, LR: 0.001
[2025-07-24 21:25:34,500] [INFO] Epoch 4/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5121, LR: 0.001
[2025-07-24 21:25:54,890] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5122, LR: 0.0005
[2025-07-24 21:25:55,767] [INFO] Namespace(path=['meta-free-apps/meta-tcp_urgptr/meta-tcp_urgptr.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_urgptr.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_urgptr.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='urgptr', name='tcpurgptr_none_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 21:26:10,425] [INFO] Feature 0 normalized using none
[2025-07-24 21:26:10,425] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:26:10,476] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): RNN(1, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:26:10,476] [INFO] Training...
[2025-07-24 21:26:34,693] [INFO] Epoch 1/5, ValAcc: 1.07%, TrainLoss: 4.5125, ValLoss: 4.5119, LR: 0.001
[2025-07-24 21:26:58,518] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5122, LR: 0.001
[2025-07-24 21:27:22,405] [INFO] Epoch 3/5, ValAcc: 0.91%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 21:27:46,335] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 21:28:10,259] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 21:28:11,694] [INFO] Namespace(path=['meta-free-apps/meta-tcp_urgptr/meta-tcp_urgptr.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_urgptr.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_urgptr.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='urgptr', name='tcpurgptr_none_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 21:28:11,859] [INFO] best(urgptr): gru, accuracy: 0.0102, f1: 0.0002, precision: 0.0001, recall: 0.0110
[INFO] tcp_sport → Best normalization: maxabs
Running: python vrscanner.py --step2 --path meta-free-apps/meta-tcp_sport/meta-tcp_sport.csv --norm maxabs --debug_path output/meta-free-apps/step2/step2_meta_tcp_sport.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_tcp_sport.csv
[2025-07-24 21:28:14,881] [INFO] Namespace(path=['meta-free-apps/meta-tcp_sport/meta-tcp_sport.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['maxabs'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_sport.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_sport.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='sport')
[2025-07-24 21:32:56,567] [INFO] Processed data from meta-free-apps/meta-tcp_sport/meta-tcp_sport.csv:
[2025-07-24 21:32:56,568] [INFO] (84492, 500)
[2025-07-24 21:32:56,568] [INFO] [['41794' '443' '41794' ... '53280' '53280' '53280']
 ['43074' '443' '43074' ... '40458' '443' '443']
 ['47326' '443' '47326' ... '47338' '443' '443']
 ...
 ['55810' '443' '55810' ... '50002' '50002' '50002']
 ['60006' '443' '60006' ... '43894' '43894' '443']
 ['57406' '57406' '57406' ... '41738' '58350' '443']]
[2025-07-24 21:33:18,311] [INFO] Feature 0 normalized using maxabs
[2025-07-24 21:33:18,311] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:33:18,349] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:33:18,349] [INFO] Training...
[2025-07-24 21:33:40,455] [INFO] Epoch 1/5, ValAcc: 10.91%, TrainLoss: 3.9899, ValLoss: 3.3293, LR: 0.001
[2025-07-24 21:33:53,360] [INFO] Epoch 2/5, ValAcc: 16.88%, TrainLoss: 3.2277, ValLoss: 3.0033, LR: 0.001
[2025-07-24 21:34:16,543] [INFO] Epoch 3/5, ValAcc: 17.20%, TrainLoss: 3.0019, ValLoss: 2.9389, LR: 0.001
[2025-07-24 21:34:40,549] [INFO] Epoch 4/5, ValAcc: 17.79%, TrainLoss: 2.8522, ValLoss: 2.9094, LR: 0.001
[2025-07-24 21:35:04,600] [INFO] Epoch 5/5, ValAcc: 24.27%, TrainLoss: 2.7876, ValLoss: 2.6194, LR: 0.001
[2025-07-24 21:35:05,971] [INFO] Namespace(path=['meta-free-apps/meta-tcp_sport/meta-tcp_sport.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['maxabs'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_sport.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_sport.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='sport', name='tcpsport_maxabs_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.2449,0.1862,0.2032,0.2443
[2025-07-24 21:35:27,923] [INFO] Feature 0 normalized using maxabs
[2025-07-24 21:35:27,923] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:35:27,952] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:35:27,952] [INFO] Training...
[2025-07-24 21:35:57,173] [INFO] Epoch 1/5, ValAcc: 0.98%, TrainLoss: 4.5131, ValLoss: 4.5119, LR: 0.001
[2025-07-24 21:36:25,807] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 21:36:55,010] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 21:37:24,322] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5121, LR: 0.001
[2025-07-24 21:37:53,595] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5122, LR: 0.0005
[2025-07-24 21:37:55,994] [INFO] Namespace(path=['meta-free-apps/meta-tcp_sport/meta-tcp_sport.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['maxabs'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_sport.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_sport.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='sport', name='tcpsport_maxabs_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 21:38:17,887] [INFO] Feature 0 normalized using maxabs
[2025-07-24 21:38:17,887] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:38:17,903] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:38:17,903] [INFO] Training...
[2025-07-24 21:38:43,171] [INFO] Epoch 1/5, ValAcc: 0.98%, TrainLoss: 4.5121, ValLoss: 4.5118, LR: 0.001
[2025-07-24 21:39:08,532] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5123, LR: 0.001
[2025-07-24 21:39:33,870] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 21:39:59,188] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 21:40:24,606] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5122, LR: 0.0005
[2025-07-24 21:40:27,052] [INFO] Namespace(path=['meta-free-apps/meta-tcp_sport/meta-tcp_sport.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['maxabs'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_sport.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_sport.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='sport', name='tcpsport_maxabs_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 21:40:48,618] [INFO] Feature 0 normalized using maxabs
[2025-07-24 21:40:48,618] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:40:48,635] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:40:48,635] [INFO] Training...
[2025-07-24 21:41:32,322] [INFO] Epoch 1/5, ValAcc: 1.01%, TrainLoss: 4.5126, ValLoss: 4.5118, LR: 0.001
[2025-07-24 21:42:15,896] [INFO] Epoch 2/5, ValAcc: 1.04%, TrainLoss: 4.5113, ValLoss: 4.5122, LR: 0.001
[2025-07-24 21:42:59,662] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 21:43:43,397] [INFO] Epoch 4/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5125, LR: 0.001
[2025-07-24 21:44:27,109] [INFO] Epoch 5/5, ValAcc: 1.04%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 21:44:31,675] [INFO] Namespace(path=['meta-free-apps/meta-tcp_sport/meta-tcp_sport.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['maxabs'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_sport.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_sport.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='sport', name='tcpsport_maxabs_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0100,0.0002,0.0001,0.0110
[2025-07-24 21:44:53,179] [INFO] Feature 0 normalized using maxabs
[2025-07-24 21:44:53,179] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:44:53,194] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:44:53,194] [INFO] Training...
[2025-07-24 21:45:14,342] [INFO] Epoch 1/5, ValAcc: 0.98%, TrainLoss: 4.5130, ValLoss: 4.5117, LR: 0.001
[2025-07-24 21:45:35,169] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5120, LR: 0.001
[2025-07-24 21:45:56,251] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 21:46:17,362] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 21:46:38,563] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5107, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 21:46:39,479] [INFO] Namespace(path=['meta-free-apps/meta-tcp_sport/meta-tcp_sport.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['maxabs'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_sport.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_sport.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='sport', name='tcpsport_maxabs_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 21:47:00,838] [INFO] Feature 0 normalized using maxabs
[2025-07-24 21:47:00,838] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:47:00,853] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:47:00,853] [INFO] Training...
[2025-07-24 21:47:25,530] [INFO] Epoch 1/5, ValAcc: 0.99%, TrainLoss: 4.5131, ValLoss: 4.5118, LR: 0.001
[2025-07-24 21:47:50,220] [INFO] Epoch 2/5, ValAcc: 0.91%, TrainLoss: 4.5111, ValLoss: 4.5120, LR: 0.001
[2025-07-24 21:48:14,889] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 21:48:39,541] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 21:49:04,302] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 21:49:05,778] [INFO] Namespace(path=['meta-free-apps/meta-tcp_sport/meta-tcp_sport.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['maxabs'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_sport.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_sport.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='sport', name='tcpsport_maxabs_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 21:49:06,644] [INFO] best(sport): gru, accuracy: 0.2449, f1: 0.1862, precision: 0.2032, recall: 0.2443
[INFO] tcp_dport → Best normalization: robust
Running: python vrscanner.py --step2 --path meta-free-apps/meta-tcp_dport/meta-tcp_dport.csv --norm robust --debug_path output/meta-free-apps/step2/step2_meta_tcp_dport.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_tcp_dport.csv
[2025-07-24 21:49:10,332] [INFO] Namespace(path=['meta-free-apps/meta-tcp_dport/meta-tcp_dport.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_dport.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_dport.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dport')
[2025-07-24 21:53:32,000] [INFO] Processed data from meta-free-apps/meta-tcp_dport/meta-tcp_dport.csv:
[2025-07-24 21:53:32,001] [INFO] (84492, 500)
[2025-07-24 21:53:32,001] [INFO] [['443' '41794' '443' ... '443' '443' '443']
 ['443' '43074' '443' ... '443' '40458' '40458']
 ['443' '47326' '443' ... '443' '47338' '47338']
 ...
 ['443' '55810' '443' ... '443' '443' '443']
 ['443' '60006' '443' ... '443' '443' '43894']
 ['443' '443' '443' ... '443' '443' '58350']]
[2025-07-24 21:53:53,631] [INFO] Feature 0 normalized using robust
[2025-07-24 21:53:53,631] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:53:53,668] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:53:53,668] [INFO] Training...
[2025-07-24 21:54:18,078] [INFO] Epoch 1/5, ValAcc: 11.40%, TrainLoss: 4.0346, ValLoss: 3.4162, LR: 0.001
[2025-07-24 21:54:31,000] [INFO] Epoch 2/5, ValAcc: 14.72%, TrainLoss: 3.2965, ValLoss: 3.0230, LR: 0.001
[2025-07-24 21:54:54,196] [INFO] Epoch 3/5, ValAcc: 23.28%, TrainLoss: 3.0353, ValLoss: 2.7542, LR: 0.001
[2025-07-24 21:55:17,884] [INFO] Epoch 4/5, ValAcc: 27.94%, TrainLoss: 2.7763, ValLoss: 2.5602, LR: 0.001
[2025-07-24 21:55:36,323] [INFO] Epoch 5/5, ValAcc: 35.18%, TrainLoss: 2.5705, ValLoss: 2.3296, LR: 0.001
[2025-07-24 21:55:37,697] [INFO] Namespace(path=['meta-free-apps/meta-tcp_dport/meta-tcp_dport.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_dport.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_dport.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dport', name='tcpdport_robust_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.3522,0.3376,0.4020,0.3533
[2025-07-24 21:55:59,616] [INFO] Feature 0 normalized using robust
[2025-07-24 21:55:59,617] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:55:59,643] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:55:59,643] [INFO] Training...
[2025-07-24 21:56:28,715] [INFO] Epoch 1/5, ValAcc: 1.04%, TrainLoss: 4.5126, ValLoss: 4.5117, LR: 0.001
[2025-07-24 21:56:54,100] [INFO] Epoch 2/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 21:57:19,467] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5125, LR: 0.001
[2025-07-24 21:57:48,683] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 21:58:18,114] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 21:58:20,526] [INFO] Namespace(path=['meta-free-apps/meta-tcp_dport/meta-tcp_dport.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_dport.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_dport.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dport', name='tcpdport_robust_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 21:58:42,365] [INFO] Feature 0 normalized using robust
[2025-07-24 21:58:42,365] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 21:58:42,388] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 21:58:42,389] [INFO] Training...
[2025-07-24 21:59:07,808] [INFO] Epoch 1/5, ValAcc: 0.92%, TrainLoss: 4.5123, ValLoss: 4.5138, LR: 0.001
[2025-07-24 21:59:29,002] [INFO] Epoch 2/5, ValAcc: 1.80%, TrainLoss: 4.4987, ValLoss: 4.3142, LR: 0.001
[2025-07-24 21:59:50,431] [INFO] Epoch 3/5, ValAcc: 9.17%, TrainLoss: 4.0067, ValLoss: 3.5951, LR: 0.001
[2025-07-24 22:00:11,936] [INFO] Epoch 4/5, ValAcc: 13.46%, TrainLoss: 3.5441, ValLoss: 3.2677, LR: 0.001
[2025-07-24 22:00:35,863] [INFO] Epoch 5/5, ValAcc: 17.36%, TrainLoss: 3.3186, ValLoss: 3.0731, LR: 0.001
[2025-07-24 22:00:38,366] [INFO] Namespace(path=['meta-free-apps/meta-tcp_dport/meta-tcp_dport.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_dport.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_dport.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dport', name='tcpdport_robust_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.1668,0.1012,0.1018,0.1664
[2025-07-24 22:01:00,159] [INFO] Feature 0 normalized using robust
[2025-07-24 22:01:00,159] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:01:00,186] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:01:00,186] [INFO] Training...
[2025-07-24 22:01:43,277] [INFO] Epoch 1/5, ValAcc: 1.07%, TrainLoss: 4.5125, ValLoss: 4.5117, LR: 0.001
[2025-07-24 22:02:26,758] [INFO] Epoch 2/5, ValAcc: 0.99%, TrainLoss: 4.5115, ValLoss: 4.5119, LR: 0.001
[2025-07-24 22:03:10,362] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5121, LR: 0.001
[2025-07-24 22:03:54,111] [INFO] Epoch 4/5, ValAcc: 3.48%, TrainLoss: 4.4242, ValLoss: 4.1620, LR: 0.001
[2025-07-24 22:04:35,382] [INFO] Epoch 5/5, ValAcc: 11.92%, TrainLoss: 3.9277, ValLoss: 3.4614, LR: 0.001
[2025-07-24 22:04:40,049] [INFO] Namespace(path=['meta-free-apps/meta-tcp_dport/meta-tcp_dport.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_dport.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_dport.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dport', name='tcpdport_robust_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.1122,0.0762,0.0830,0.1122
[2025-07-24 22:05:01,676] [INFO] Feature 0 normalized using robust
[2025-07-24 22:05:01,676] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:05:01,697] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:05:01,697] [INFO] Training...
[2025-07-24 22:05:22,441] [INFO] Epoch 1/5, ValAcc: 4.51%, TrainLoss: 4.3477, ValLoss: 4.1365, LR: 0.001
[2025-07-24 22:05:43,656] [INFO] Epoch 2/5, ValAcc: 7.23%, TrainLoss: 4.0813, ValLoss: 3.9315, LR: 0.001
[2025-07-24 22:06:04,861] [INFO] Epoch 3/5, ValAcc: 9.99%, TrainLoss: 3.9307, ValLoss: 3.7894, LR: 0.001
[2025-07-24 22:06:26,155] [INFO] Epoch 4/5, ValAcc: 12.82%, TrainLoss: 3.8174, ValLoss: 3.6348, LR: 0.001
[2025-07-24 22:06:47,399] [INFO] Epoch 5/5, ValAcc: 13.46%, TrainLoss: 3.7102, ValLoss: 3.5269, LR: 0.001
[2025-07-24 22:06:48,317] [INFO] Namespace(path=['meta-free-apps/meta-tcp_dport/meta-tcp_dport.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_dport.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_dport.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dport', name='tcpdport_robust_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.1391,0.1079,0.1152,0.1395
[2025-07-24 22:07:09,722] [INFO] Feature 0 normalized using robust
[2025-07-24 22:07:09,723] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:07:09,736] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:07:09,736] [INFO] Training...
[2025-07-24 22:07:35,327] [INFO] Epoch 1/5, ValAcc: 0.98%, TrainLoss: 4.5130, ValLoss: 4.5116, LR: 0.001
[2025-07-24 22:08:00,181] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 22:08:15,774] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 22:08:31,367] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5125, LR: 0.001
[2025-07-24 22:08:54,008] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5107, ValLoss: 4.5125, LR: 0.0005
[2025-07-24 22:08:55,490] [INFO] Namespace(path=['meta-free-apps/meta-tcp_dport/meta-tcp_dport.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['robust'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_dport.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_dport.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dport', name='tcpdport_robust_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 22:08:56,277] [INFO] best(dport): gru, accuracy: 0.3522, f1: 0.3376, precision: 0.4020, recall: 0.3533
[INFO] tcp_seq → Best normalization: none
Running: python vrscanner.py --step2 --path meta-free-apps/meta-tcp_seq/meta-tcp_seq.csv --norm none --debug_path output/meta-free-apps/step2/step2_meta_tcp_seq.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_tcp_seq.csv
[2025-07-24 22:08:59,870] [INFO] Namespace(path=['meta-free-apps/meta-tcp_seq/meta-tcp_seq.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_seq.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_seq.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='seq')
[2025-07-24 22:14:31,484] [INFO] Processed data from meta-free-apps/meta-tcp_seq/meta-tcp_seq.csv:
[2025-07-24 22:14:31,484] [INFO] (84492, 500)
[2025-07-24 22:14:31,484] [INFO] [['373911389' '3188113863' '373911993' ... '2767987839' '2767989219'
  '2767990599']
 ['1860534623' '4142732732' '1860534994' ... '1606477932' '2408831983'
  '2408832173']
 ['1593607284' '1822707587' '1593607655' ... '1086615676' '2190392372'
  '2190392372']
 ...
 ['3327834499' '2152894062' '3327834689' ... '4210053151' '4210054531'
  '4210055911']
 ['1950926062' '921263049' '1950926063' ... '4018860604' '4018861984'
  '1045777300']
 ['2408022165' '2408022165' '2408022165' ... '3791291834' '3271260733'
  '2310297835']]
[2025-07-24 22:14:53,673] [INFO] Feature 0 normalized using none
[2025-07-24 22:14:53,673] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:14:53,710] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): GRU(1, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:14:53,710] [INFO] Training...
[2025-07-24 22:15:16,632] [INFO] Epoch 1/5, ValAcc: 1.68%, TrainLoss: 4.5010, ValLoss: 4.4882, LR: 0.001
[2025-07-24 22:15:39,385] [INFO] Epoch 2/5, ValAcc: 1.88%, TrainLoss: 4.4935, ValLoss: 4.4810, LR: 0.001
[2025-07-24 22:16:02,328] [INFO] Epoch 3/5, ValAcc: 1.68%, TrainLoss: 4.4938, ValLoss: 4.4861, LR: 0.001
[2025-07-24 22:16:25,327] [INFO] Epoch 4/5, ValAcc: 1.92%, TrainLoss: 4.4926, ValLoss: 4.4827, LR: 0.001
[2025-07-24 22:16:47,964] [INFO] Epoch 5/5, ValAcc: 1.94%, TrainLoss: 4.4880, ValLoss: 4.4852, LR: 0.001
[2025-07-24 22:16:49,272] [INFO] Namespace(path=['meta-free-apps/meta-tcp_seq/meta-tcp_seq.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_seq.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_seq.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='seq', name='tcpseq_none_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0190,0.0023,0.0016,0.0189
[2025-07-24 22:17:12,172] [INFO] Feature 0 normalized using none
[2025-07-24 22:17:12,172] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:17:12,198] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): GRU(1, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:17:12,198] [INFO] Training...
[2025-07-24 22:17:36,206] [INFO] Epoch 1/5, ValAcc: 1.98%, TrainLoss: 4.5034, ValLoss: 4.4886, LR: 0.001
[2025-07-24 22:18:00,625] [INFO] Epoch 2/5, ValAcc: 2.01%, TrainLoss: 4.4938, ValLoss: 4.4859, LR: 0.001
[2025-07-24 22:18:28,897] [INFO] Epoch 3/5, ValAcc: 1.99%, TrainLoss: 4.4877, ValLoss: 4.4860, LR: 0.001
[2025-07-24 22:18:57,159] [INFO] Epoch 4/5, ValAcc: 1.87%, TrainLoss: 4.4854, ValLoss: 4.4767, LR: 0.001
[2025-07-24 22:19:25,367] [INFO] Epoch 5/5, ValAcc: 1.80%, TrainLoss: 4.4838, ValLoss: 4.4797, LR: 0.001
[2025-07-24 22:19:27,697] [INFO] Namespace(path=['meta-free-apps/meta-tcp_seq/meta-tcp_seq.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_seq.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_seq.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='seq', name='tcpseq_none_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0175,0.0031,0.0024,0.0178
[2025-07-24 22:19:50,382] [INFO] Feature 0 normalized using none
[2025-07-24 22:19:50,382] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:19:50,408] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): LSTM(1, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:19:50,408] [INFO] Training...
[2025-07-24 22:20:15,057] [INFO] Epoch 1/5, ValAcc: 1.82%, TrainLoss: 4.4999, ValLoss: 4.4853, LR: 0.001
[2025-07-24 22:20:39,315] [INFO] Epoch 2/5, ValAcc: 1.99%, TrainLoss: 4.4899, ValLoss: 4.4810, LR: 0.001
[2025-07-24 22:21:03,582] [INFO] Epoch 3/5, ValAcc: 1.96%, TrainLoss: 4.4878, ValLoss: 4.4797, LR: 0.001
[2025-07-24 22:21:28,222] [INFO] Epoch 4/5, ValAcc: 1.98%, TrainLoss: 4.4855, ValLoss: 4.4755, LR: 0.001
[2025-07-24 22:21:52,835] [INFO] Epoch 5/5, ValAcc: 1.94%, TrainLoss: 4.4830, ValLoss: 4.4714, LR: 0.001
[2025-07-24 22:21:55,257] [INFO] Namespace(path=['meta-free-apps/meta-tcp_seq/meta-tcp_seq.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_seq.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_seq.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='seq', name='tcpseq_none_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0192,0.0032,0.0024,0.0194
[2025-07-24 22:22:17,728] [INFO] Feature 0 normalized using none
[2025-07-24 22:22:17,729] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:22:17,757] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): LSTM(1, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:22:17,757] [INFO] Training...
[2025-07-24 22:22:59,976] [INFO] Epoch 1/5, ValAcc: 1.85%, TrainLoss: 4.4974, ValLoss: 4.4828, LR: 0.001
[2025-07-24 22:23:42,584] [INFO] Epoch 2/5, ValAcc: 1.99%, TrainLoss: 4.4885, ValLoss: 4.4758, LR: 0.001
[2025-07-24 22:24:25,576] [INFO] Epoch 3/5, ValAcc: 1.82%, TrainLoss: 4.4821, ValLoss: 4.4809, LR: 0.001
[2025-07-24 22:25:08,548] [INFO] Epoch 4/5, ValAcc: 1.95%, TrainLoss: 4.4782, ValLoss: 4.4685, LR: 0.001
[2025-07-24 22:25:51,554] [INFO] Epoch 5/5, ValAcc: 1.99%, TrainLoss: 4.4758, ValLoss: 4.4710, LR: 0.001
[2025-07-24 22:25:56,136] [INFO] Namespace(path=['meta-free-apps/meta-tcp_seq/meta-tcp_seq.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_seq.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_seq.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='seq', name='tcpseq_none_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0194,0.0030,0.0022,0.0195
[2025-07-24 22:26:18,493] [INFO] Feature 0 normalized using none
[2025-07-24 22:26:18,493] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:26:18,516] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): RNN(1, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:26:18,516] [INFO] Training...
[2025-07-24 22:26:36,348] [INFO] Epoch 1/5, ValAcc: 1.04%, TrainLoss: 4.5128, ValLoss: 4.5116, LR: 0.001
[2025-07-24 22:26:56,553] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5120, LR: 0.001
[2025-07-24 22:27:16,747] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 22:27:37,030] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5110, ValLoss: 4.5125, LR: 0.001
[2025-07-24 22:27:57,262] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5125, LR: 0.0005
[2025-07-24 22:27:58,145] [INFO] Namespace(path=['meta-free-apps/meta-tcp_seq/meta-tcp_seq.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_seq.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_seq.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='seq', name='tcpseq_none_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 22:28:20,889] [INFO] Feature 0 normalized using none
[2025-07-24 22:28:20,889] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:28:20,912] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Identity()
  )
  (rnn_layers): ModuleList(
    (0): RNN(1, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:28:20,913] [INFO] Training...
[2025-07-24 22:28:43,756] [INFO] Epoch 1/5, ValAcc: 1.95%, TrainLoss: 4.5042, ValLoss: 4.4925, LR: 0.001
[2025-07-24 22:29:07,131] [INFO] Epoch 2/5, ValAcc: 1.82%, TrainLoss: 4.4945, ValLoss: 4.4873, LR: 0.001
[2025-07-24 22:29:22,045] [INFO] Epoch 3/5, ValAcc: 1.92%, TrainLoss: 4.4907, ValLoss: 4.4839, LR: 0.001
[2025-07-24 22:29:45,845] [INFO] Epoch 4/5, ValAcc: 1.89%, TrainLoss: 4.4898, ValLoss: 4.4867, LR: 0.001
[2025-07-24 22:30:09,572] [INFO] Epoch 5/5, ValAcc: 1.91%, TrainLoss: 4.4884, ValLoss: 4.4813, LR: 0.001
[2025-07-24 22:30:11,002] [INFO] Namespace(path=['meta-free-apps/meta-tcp_seq/meta-tcp_seq.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['none'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_seq.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_seq.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='seq', name='tcpseq_none_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0192,0.0030,0.0022,0.0193
[2025-07-24 22:30:12,170] [INFO] best(seq): lstm, accuracy: 0.0192, f1: 0.0032, precision: 0.0024, recall: 0.0194
[INFO] tcp_ack → Best normalization: power
Running: python vrscanner.py --step2 --path meta-free-apps/meta-tcp_ack/meta-tcp_ack.csv --norm power --debug_path output/meta-free-apps/step2/step2_meta_tcp_ack.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_tcp_ack.csv
[2025-07-24 22:30:15,933] [INFO] Namespace(path=['meta-free-apps/meta-tcp_ack/meta-tcp_ack.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_ack.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_ack.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ack')
[2025-07-24 22:37:53,392] [INFO] Processed data from meta-free-apps/meta-tcp_ack/meta-tcp_ack.csv:
[2025-07-24 22:37:53,393] [INFO] (84492, 500)
[2025-07-24 22:37:53,393] [INFO] [['3188113863' '373911993' '3188113905' ... '306085429' '306085429'
  '306085429']
 ['4142732732' '1860534994' '4142732767' ... '2408831983' '1606477932'
  '1606477932']
 ['1822707587' '1593607655' '1822707622' ... '2190392372' '0' '0']
 ...
 ['2152894062' '3327834689' '2152894097' ... '2105443833' '2105443833'
  '2105443833']
 ['0' '1950926063' '921263050' ... '1045777300' '1045777300' '4018850944']
 ['2911133304' '2911136064' '2911136549' ... '3588866530' '2310297835'
  '3271261036']]
[2025-07-24 22:38:33,766] [INFO] Feature 0 normalized using power
[2025-07-24 22:38:33,766] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:38:33,801] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:38:33,801] [INFO] Training...
[2025-07-24 22:38:57,699] [INFO] Epoch 1/5, ValAcc: 1.38%, TrainLoss: 4.5126, ValLoss: 4.5083, LR: 0.001
[2025-07-24 22:39:16,102] [INFO] Epoch 2/5, ValAcc: 3.05%, TrainLoss: 4.4302, ValLoss: 4.2994, LR: 0.001
[2025-07-24 22:39:39,975] [INFO] Epoch 3/5, ValAcc: 8.51%, TrainLoss: 4.1587, ValLoss: 3.8845, LR: 0.001
[2025-07-24 22:39:52,852] [INFO] Epoch 4/5, ValAcc: 22.33%, TrainLoss: 3.5757, ValLoss: 3.0801, LR: 0.001
[2025-07-24 22:40:05,718] [INFO] Epoch 5/5, ValAcc: 28.60%, TrainLoss: 3.0544, ValLoss: 2.7457, LR: 0.001
[2025-07-24 22:40:07,076] [INFO] Namespace(path=['meta-free-apps/meta-tcp_ack/meta-tcp_ack.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_ack.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_ack.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ack', name='tcpack_power_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.2871,0.2736,0.3181,0.2872
[2025-07-24 22:40:47,207] [INFO] Feature 0 normalized using power
[2025-07-24 22:40:47,207] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:40:47,227] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:40:47,227] [INFO] Training...
[2025-07-24 22:41:15,591] [INFO] Epoch 1/5, ValAcc: 0.91%, TrainLoss: 4.5130, ValLoss: 4.5122, LR: 0.001
[2025-07-24 22:41:40,932] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5123, LR: 0.001
[2025-07-24 22:42:06,293] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 22:42:31,650] [INFO] Epoch 4/5, ValAcc: 0.91%, TrainLoss: 4.5111, ValLoss: 4.5125, LR: 0.001
[2025-07-24 22:42:56,994] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 22:42:59,408] [INFO] Namespace(path=['meta-free-apps/meta-tcp_ack/meta-tcp_ack.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_ack.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_ack.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ack', name='tcpack_power_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 22:43:39,572] [INFO] Feature 0 normalized using power
[2025-07-24 22:43:39,572] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:43:39,589] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:43:39,589] [INFO] Training...
[2025-07-24 22:44:00,677] [INFO] Epoch 1/5, ValAcc: 0.99%, TrainLoss: 4.5122, ValLoss: 4.5119, LR: 0.001
[2025-07-24 22:44:21,792] [INFO] Epoch 2/5, ValAcc: 1.04%, TrainLoss: 4.5112, ValLoss: 4.5122, LR: 0.001
[2025-07-24 22:44:46,391] [INFO] Epoch 3/5, ValAcc: 0.91%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 22:45:11,755] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 22:45:37,119] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 22:45:39,568] [INFO] Namespace(path=['meta-free-apps/meta-tcp_ack/meta-tcp_ack.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_ack.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_ack.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ack', name='tcpack_power_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 22:46:19,811] [INFO] Feature 0 normalized using power
[2025-07-24 22:46:19,811] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:46:19,832] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:46:19,832] [INFO] Training...
[2025-07-24 22:47:03,495] [INFO] Epoch 1/5, ValAcc: 0.99%, TrainLoss: 4.5125, ValLoss: 4.5121, LR: 0.001
[2025-07-24 22:47:47,195] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5113, ValLoss: 4.5123, LR: 0.001
[2025-07-24 22:48:30,966] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 22:49:14,749] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 22:49:58,521] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 22:50:03,092] [INFO] Namespace(path=['meta-free-apps/meta-tcp_ack/meta-tcp_ack.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_ack.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_ack.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ack', name='tcpack_power_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 22:50:43,119] [INFO] Feature 0 normalized using power
[2025-07-24 22:50:43,119] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:50:43,133] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:50:43,133] [INFO] Training...
[2025-07-24 22:51:04,367] [INFO] Epoch 1/5, ValAcc: 0.97%, TrainLoss: 4.5129, ValLoss: 4.5124, LR: 0.001
[2025-07-24 22:51:25,593] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5120, ValLoss: 4.5123, LR: 0.001
[2025-07-24 22:51:46,772] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 22:52:08,826] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5115, ValLoss: 4.5123, LR: 0.001
[2025-07-24 22:52:30,041] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5123, LR: 0.0005
[2025-07-24 22:52:30,955] [INFO] Namespace(path=['meta-free-apps/meta-tcp_ack/meta-tcp_ack.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_ack.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_ack.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ack', name='tcpack_power_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 22:53:10,912] [INFO] Feature 0 normalized using power
[2025-07-24 22:53:10,912] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:53:10,928] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:53:10,928] [INFO] Training...
[2025-07-24 22:53:35,753] [INFO] Epoch 1/5, ValAcc: 1.07%, TrainLoss: 4.5141, ValLoss: 4.5120, LR: 0.001
[2025-07-24 22:54:00,504] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5123, LR: 0.001
[2025-07-24 22:54:25,253] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 22:54:50,060] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5125, LR: 0.001
[2025-07-24 22:55:14,863] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 22:55:16,367] [INFO] Namespace(path=['meta-free-apps/meta-tcp_ack/meta-tcp_ack.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_ack.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_ack.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='ack', name='tcpack_power_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 22:55:17,650] [INFO] best(ack): gru, accuracy: 0.2871, f1: 0.2736, precision: 0.3181, recall: 0.2872
[INFO] tcp_reserved → Best normalization: token
Running: python vrscanner.py --step2 --path meta-free-apps/meta-tcp_reserved/meta-tcp_reserved.csv --norm token --debug_path output/meta-free-apps/step2/step2_meta_tcp_reserved.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_tcp_reserved.csv
[2025-07-24 22:55:21,446] [INFO] Namespace(path=['meta-free-apps/meta-tcp_reserved/meta-tcp_reserved.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_reserved.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_reserved.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='reserved')
[2025-07-24 22:58:36,166] [INFO] Processed data from meta-free-apps/meta-tcp_reserved/meta-tcp_reserved.csv:
[2025-07-24 22:58:36,166] [INFO] (84492, 500)
[2025-07-24 22:58:36,166] [INFO] [['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']
 ...
 ['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']
 ['0' '0' '0' ... '0' '0' '0']]
[2025-07-24 22:58:53,884] [INFO] Feature 0 normalized using token
[2025-07-24 22:58:53,884] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 22:58:53,925] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 22:58:53,925] [INFO] Training...
[2025-07-24 22:59:17,422] [INFO] Epoch 1/5, ValAcc: 0.90%, TrainLoss: 4.5109, ValLoss: 4.5122, LR: 0.001
[2025-07-24 22:59:30,595] [INFO] Epoch 2/5, ValAcc: 0.95%, TrainLoss: 4.5113, ValLoss: 4.5135, LR: 0.001
[2025-07-24 22:59:52,082] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5123, LR: 0.001
[2025-07-24 23:00:07,364] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5113, ValLoss: 4.5127, LR: 0.001
[2025-07-24 23:00:25,433] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 23:00:26,804] [INFO] Namespace(path=['meta-free-apps/meta-tcp_reserved/meta-tcp_reserved.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_reserved.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_reserved.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='reserved', name='tcpreserved_token_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 23:00:44,767] [INFO] Feature 0 normalized using token
[2025-07-24 23:00:44,767] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:00:44,824] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:00:44,824] [INFO] Training...
[2025-07-24 23:01:14,781] [INFO] Epoch 1/5, ValAcc: 0.99%, TrainLoss: 4.5130, ValLoss: 4.5119, LR: 0.001
[2025-07-24 23:01:40,512] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 23:02:06,219] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 23:02:31,917] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5122, LR: 0.001
[2025-07-24 23:02:57,605] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5108, ValLoss: 4.5122, LR: 0.0005
[2025-07-24 23:03:00,031] [INFO] Namespace(path=['meta-free-apps/meta-tcp_reserved/meta-tcp_reserved.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_reserved.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_reserved.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='reserved', name='tcpreserved_token_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 23:03:17,922] [INFO] Feature 0 normalized using token
[2025-07-24 23:03:17,923] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:03:17,961] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:03:17,961] [INFO] Training...
[2025-07-24 23:03:40,013] [INFO] Epoch 1/5, ValAcc: 1.82%, TrainLoss: 4.5040, ValLoss: 4.4892, LR: 0.001
[2025-07-24 23:04:01,391] [INFO] Epoch 2/5, ValAcc: 1.95%, TrainLoss: 4.4934, ValLoss: 4.4911, LR: 0.001
[2025-07-24 23:04:23,772] [INFO] Epoch 3/5, ValAcc: 1.83%, TrainLoss: 4.4909, ValLoss: 4.4829, LR: 0.001
[2025-07-24 23:04:45,194] [INFO] Epoch 4/5, ValAcc: 1.91%, TrainLoss: 4.4875, ValLoss: 4.4796, LR: 0.001
[2025-07-24 23:05:06,634] [INFO] Epoch 5/5, ValAcc: 1.95%, TrainLoss: 4.4846, ValLoss: 4.4758, LR: 0.001
[2025-07-24 23:05:09,102] [INFO] Namespace(path=['meta-free-apps/meta-tcp_reserved/meta-tcp_reserved.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_reserved.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_reserved.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='reserved', name='tcpreserved_token_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0191,0.0031,0.0021,0.0192
[2025-07-24 23:05:26,977] [INFO] Feature 0 normalized using token
[2025-07-24 23:05:26,977] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:05:27,014] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:05:27,014] [INFO] Training...
[2025-07-24 23:06:10,230] [INFO] Epoch 1/5, ValAcc: 1.94%, TrainLoss: 4.5037, ValLoss: 4.4869, LR: 0.001
[2025-07-24 23:06:52,906] [INFO] Epoch 2/5, ValAcc: 2.00%, TrainLoss: 4.4903, ValLoss: 4.4825, LR: 0.001
[2025-07-24 23:07:34,114] [INFO] Epoch 3/5, ValAcc: 2.01%, TrainLoss: 4.4859, ValLoss: 4.4761, LR: 0.001
[2025-07-24 23:08:15,333] [INFO] Epoch 4/5, ValAcc: 1.99%, TrainLoss: 4.4828, ValLoss: 4.4740, LR: 0.001
[2025-07-24 23:08:56,541] [INFO] Epoch 5/5, ValAcc: 1.99%, TrainLoss: 4.4803, ValLoss: 4.4709, LR: 0.001
[2025-07-24 23:09:01,173] [INFO] Namespace(path=['meta-free-apps/meta-tcp_reserved/meta-tcp_reserved.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_reserved.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_reserved.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='reserved', name='tcpreserved_token_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0195,0.0035,0.0035,0.0196
[2025-07-24 23:09:18,940] [INFO] Feature 0 normalized using token
[2025-07-24 23:09:18,940] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:09:18,958] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:09:18,958] [INFO] Training...
[2025-07-24 23:09:40,181] [INFO] Epoch 1/5, ValAcc: 0.98%, TrainLoss: 4.5131, ValLoss: 4.5120, LR: 0.001
[2025-07-24 23:10:01,275] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5123, LR: 0.001
[2025-07-24 23:10:22,018] [INFO] Epoch 3/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5125, LR: 0.001
[2025-07-24 23:10:43,594] [INFO] Epoch 4/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 23:11:04,577] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5107, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 23:11:05,506] [INFO] Namespace(path=['meta-free-apps/meta-tcp_reserved/meta-tcp_reserved.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_reserved.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_reserved.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='reserved', name='tcpreserved_token_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 23:11:23,303] [INFO] Feature 0 normalized using token
[2025-07-24 23:11:23,303] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:11:23,321] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(2, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:11:23,321] [INFO] Training...
[2025-07-24 23:11:46,129] [INFO] Epoch 1/5, ValAcc: 0.99%, TrainLoss: 4.5132, ValLoss: 4.5118, LR: 0.001
[2025-07-24 23:12:11,038] [INFO] Epoch 2/5, ValAcc: 0.98%, TrainLoss: 4.5112, ValLoss: 4.5121, LR: 0.001
[2025-07-24 23:12:35,930] [INFO] Epoch 3/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 23:13:00,834] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-24 23:13:25,728] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5107, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 23:13:27,221] [INFO] Namespace(path=['meta-free-apps/meta-tcp_reserved/meta-tcp_reserved.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_reserved.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_reserved.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='reserved', name='tcpreserved_token_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 23:13:27,337] [INFO] best(reserved): bilstm, accuracy: 0.0195, f1: 0.0035, precision: 0.0035, recall: 0.0196
[INFO] tcp_flags → Best normalization: token
Running: python vrscanner.py --step2 --path meta-free-apps/meta-tcp_flags/meta-tcp_flags.csv --norm token --debug_path output/meta-free-apps/step2/step2_meta_tcp_flags.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_tcp_flags.csv
[2025-07-24 23:13:30,420] [INFO] Namespace(path=['meta-free-apps/meta-tcp_flags/meta-tcp_flags.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_flags.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_flags.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='flags')
[2025-07-24 23:17:25,950] [INFO] Processed data from meta-free-apps/meta-tcp_flags/meta-tcp_flags.csv:
[2025-07-24 23:17:25,950] [INFO] (84492, 500)
[2025-07-24 23:17:25,950] [INFO] [['PA' 'PA' 'A' ... 'A' 'A' 'A']
 ['PA' 'PA' 'A' ... 'A' 'A' 'PA']
 ['PA' 'PA' 'A' ... 'FA' 'R' 'R']
 ...
 ['PA' 'PA' 'A' ... 'A' 'A' 'A']
 ['S' 'SA' 'A' ... 'A' 'A' 'A']
 ['A' 'A' 'A' ... 'A' 'PA' 'PA']]
[2025-07-24 23:17:49,570] [INFO] Feature 0 normalized using token
[2025-07-24 23:17:49,570] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:17:49,608] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(9, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:17:49,608] [INFO] Training...
[2025-07-24 23:18:13,843] [INFO] Epoch 1/5, ValAcc: 17.47%, TrainLoss: 4.0182, ValLoss: 3.2690, LR: 0.001
[2025-07-24 23:18:29,756] [INFO] Epoch 2/5, ValAcc: 33.04%, TrainLoss: 2.9450, ValLoss: 2.5209, LR: 0.001
[2025-07-24 23:18:42,899] [INFO] Epoch 3/5, ValAcc: 38.56%, TrainLoss: 2.4800, ValLoss: 2.2653, LR: 0.001
[2025-07-24 23:18:56,004] [INFO] Epoch 4/5, ValAcc: 40.75%, TrainLoss: 2.2439, ValLoss: 2.0876, LR: 0.001
[2025-07-24 23:19:09,082] [INFO] Epoch 5/5, ValAcc: 37.50%, TrainLoss: 2.1044, ValLoss: 2.2672, LR: 0.001
[2025-07-24 23:19:10,438] [INFO] Namespace(path=['meta-free-apps/meta-tcp_flags/meta-tcp_flags.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_flags.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_flags.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='flags', name='tcpflags_token_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.3803,0.3709,0.4249,0.3811
[2025-07-24 23:19:34,464] [INFO] Feature 0 normalized using token
[2025-07-24 23:19:34,464] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:19:34,494] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(9, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:19:34,494] [INFO] Training...
[2025-07-24 23:20:03,574] [INFO] Epoch 1/5, ValAcc: 17.21%, TrainLoss: 4.0334, ValLoss: 3.3120, LR: 0.001
[2025-07-24 23:20:29,105] [INFO] Epoch 2/5, ValAcc: 33.28%, TrainLoss: 2.9274, ValLoss: 2.5302, LR: 0.001
[2025-07-24 23:20:54,703] [INFO] Epoch 3/5, ValAcc: 38.89%, TrainLoss: 2.4222, ValLoss: 2.2264, LR: 0.001
[2025-07-24 23:21:24,142] [INFO] Epoch 4/5, ValAcc: 42.91%, TrainLoss: 2.1756, ValLoss: 2.0371, LR: 0.001
[2025-07-24 23:21:53,684] [INFO] Epoch 5/5, ValAcc: 44.06%, TrainLoss: 2.0317, ValLoss: 1.9497, LR: 0.001
[2025-07-24 23:21:56,109] [INFO] Namespace(path=['meta-free-apps/meta-tcp_flags/meta-tcp_flags.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_flags.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_flags.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='flags', name='tcpflags_token_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.4438,0.4461,0.5095,0.4446
[2025-07-24 23:22:19,853] [INFO] Feature 0 normalized using token
[2025-07-24 23:22:19,853] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:22:19,882] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(9, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:22:19,882] [INFO] Training...
[2025-07-24 23:22:41,504] [INFO] Epoch 1/5, ValAcc: 7.60%, TrainLoss: 4.2760, ValLoss: 3.9459, LR: 0.001
[2025-07-24 23:23:03,228] [INFO] Epoch 2/5, ValAcc: 18.82%, TrainLoss: 3.6035, ValLoss: 3.2609, LR: 0.001
[2025-07-24 23:23:27,953] [INFO] Epoch 3/5, ValAcc: 32.53%, TrainLoss: 3.0110, ValLoss: 2.6244, LR: 0.001
[2025-07-24 23:23:53,755] [INFO] Epoch 4/5, ValAcc: 37.08%, TrainLoss: 2.6415, ValLoss: 2.3502, LR: 0.001
[2025-07-24 23:24:19,610] [INFO] Epoch 5/5, ValAcc: 40.22%, TrainLoss: 2.3860, ValLoss: 2.1912, LR: 0.001
[2025-07-24 23:24:22,123] [INFO] Namespace(path=['meta-free-apps/meta-tcp_flags/meta-tcp_flags.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_flags.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_flags.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='flags', name='tcpflags_token_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.4033,0.4034,0.4640,0.4039
[2025-07-24 23:24:46,038] [INFO] Feature 0 normalized using token
[2025-07-24 23:24:46,038] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:24:46,059] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(9, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:24:46,059] [INFO] Training...
[2025-07-24 23:25:27,442] [INFO] Epoch 1/5, ValAcc: 14.57%, TrainLoss: 4.0668, ValLoss: 3.5296, LR: 0.001
[2025-07-24 23:26:09,051] [INFO] Epoch 2/5, ValAcc: 29.53%, TrainLoss: 3.2290, ValLoss: 2.7347, LR: 0.001
[2025-07-24 23:26:53,707] [INFO] Epoch 3/5, ValAcc: 37.51%, TrainLoss: 2.6048, ValLoss: 2.3187, LR: 0.001
[2025-07-24 23:27:38,246] [INFO] Epoch 4/5, ValAcc: 42.33%, TrainLoss: 2.2440, ValLoss: 2.0728, LR: 0.001
[2025-07-24 23:28:22,881] [INFO] Epoch 5/5, ValAcc: 44.95%, TrainLoss: 2.0466, ValLoss: 1.9387, LR: 0.001
[2025-07-24 23:28:27,572] [INFO] Namespace(path=['meta-free-apps/meta-tcp_flags/meta-tcp_flags.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_flags.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_flags.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='flags', name='tcpflags_token_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.4534,0.4575,0.5163,0.4536
[2025-07-24 23:28:50,930] [INFO] Feature 0 normalized using token
[2025-07-24 23:28:50,930] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:28:50,947] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(9, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:28:50,948] [INFO] Training...
[2025-07-24 23:29:11,692] [INFO] Epoch 1/5, ValAcc: 6.60%, TrainLoss: 4.2945, ValLoss: 4.0134, LR: 0.001
[2025-07-24 23:29:32,365] [INFO] Epoch 2/5, ValAcc: 10.67%, TrainLoss: 3.9337, ValLoss: 3.7517, LR: 0.001
[2025-07-24 23:29:53,505] [INFO] Epoch 3/5, ValAcc: 13.82%, TrainLoss: 3.7335, ValLoss: 3.5564, LR: 0.001
[2025-07-24 23:30:15,121] [INFO] Epoch 4/5, ValAcc: 15.61%, TrainLoss: 3.6007, ValLoss: 3.4472, LR: 0.001
[2025-07-24 23:30:36,622] [INFO] Epoch 5/5, ValAcc: 15.79%, TrainLoss: 3.5269, ValLoss: 3.4216, LR: 0.001
[2025-07-24 23:30:37,561] [INFO] Namespace(path=['meta-free-apps/meta-tcp_flags/meta-tcp_flags.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_flags.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_flags.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='flags', name='tcpflags_token_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.1639,0.1455,0.1779,0.1647
[2025-07-24 23:31:00,799] [INFO] Feature 0 normalized using token
[2025-07-24 23:31:00,800] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:31:00,827] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(9, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:31:00,827] [INFO] Training...
[2025-07-24 23:31:22,473] [INFO] Epoch 1/5, ValAcc: 6.96%, TrainLoss: 4.2124, ValLoss: 3.9183, LR: 0.001
[2025-07-24 23:31:47,621] [INFO] Epoch 2/5, ValAcc: 13.88%, TrainLoss: 3.7694, ValLoss: 3.5457, LR: 0.001
[2025-07-24 23:32:12,670] [INFO] Epoch 3/5, ValAcc: 15.08%, TrainLoss: 3.5726, ValLoss: 3.4390, LR: 0.001
[2025-07-24 23:32:37,629] [INFO] Epoch 4/5, ValAcc: 16.60%, TrainLoss: 3.4717, ValLoss: 3.3840, LR: 0.001
[2025-07-24 23:33:02,663] [INFO] Epoch 5/5, ValAcc: 18.13%, TrainLoss: 3.4147, ValLoss: 3.3183, LR: 0.001
[2025-07-24 23:33:04,155] [INFO] Namespace(path=['meta-free-apps/meta-tcp_flags/meta-tcp_flags.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_flags.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_flags.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='flags', name='tcpflags_token_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.1880,0.1751,0.2204,0.1890
[2025-07-24 23:33:04,616] [INFO] best(flags): bilstm, accuracy: 0.4534, f1: 0.4575, precision: 0.5163, recall: 0.4536
[INFO] tcp_dataofs → Best normalization: power
Running: python vrscanner.py --step2 --path meta-free-apps/meta-tcp_dataofs/meta-tcp_dataofs.csv --norm power --debug_path output/meta-free-apps/step2/step2_meta_tcp_dataofs.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_tcp_dataofs.csv
[2025-07-24 23:33:07,936] [INFO] Namespace(path=['meta-free-apps/meta-tcp_dataofs/meta-tcp_dataofs.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_dataofs.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_dataofs.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dataofs')
[2025-07-24 23:36:34,824] [INFO] Processed data from meta-free-apps/meta-tcp_dataofs/meta-tcp_dataofs.csv:
[2025-07-24 23:36:34,824] [INFO] (84492, 500)
[2025-07-24 23:36:34,824] [INFO] [['8' '8' '8' ... '8' '8' '8']
 ['8' '8' '8' ... '8' '8' '8']
 ['8' '8' '8' ... '8' '5' '5']
 ...
 ['8' '8' '8' ... '8' '8' '8']
 ['10' '10' '8' ... '8' '8' '8']
 ['11' '8' '8' ... '8' '8' '8']]
[2025-07-24 23:37:00,842] [INFO] Feature 0 normalized using power
[2025-07-24 23:37:00,842] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:37:00,875] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:37:00,875] [INFO] Training...
[2025-07-24 23:37:23,143] [INFO] Epoch 1/5, ValAcc: 6.06%, TrainLoss: 4.3824, ValLoss: 4.1625, LR: 0.001
[2025-07-24 23:37:46,831] [INFO] Epoch 2/5, ValAcc: 14.34%, TrainLoss: 3.9108, ValLoss: 3.6052, LR: 0.001
[2025-07-24 23:38:06,233] [INFO] Epoch 3/5, ValAcc: 18.93%, TrainLoss: 3.5475, ValLoss: 3.4010, LR: 0.001
[2025-07-24 23:38:29,741] [INFO] Epoch 4/5, ValAcc: 21.38%, TrainLoss: 3.3899, ValLoss: 3.2638, LR: 0.001
[2025-07-24 23:38:42,643] [INFO] Epoch 5/5, ValAcc: 21.15%, TrainLoss: 3.3020, ValLoss: 3.2493, LR: 0.001
[2025-07-24 23:38:44,015] [INFO] Namespace(path=['meta-free-apps/meta-tcp_dataofs/meta-tcp_dataofs.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_dataofs.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_dataofs.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dataofs', name='tcpdataofs_power_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.2217,0.2071,0.2321,0.2226
[2025-07-24 23:39:10,406] [INFO] Feature 0 normalized using power
[2025-07-24 23:39:10,406] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:39:10,433] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:39:10,433] [INFO] Training...
[2025-07-24 23:39:35,750] [INFO] Epoch 1/5, ValAcc: 6.38%, TrainLoss: 4.3936, ValLoss: 4.1604, LR: 0.001
[2025-07-24 23:40:01,091] [INFO] Epoch 2/5, ValAcc: 12.11%, TrainLoss: 4.0267, ValLoss: 3.7772, LR: 0.001
[2025-07-24 23:40:26,433] [INFO] Epoch 3/5, ValAcc: 15.11%, TrainLoss: 3.6778, ValLoss: 3.6362, LR: 0.001
[2025-07-24 23:40:51,780] [INFO] Epoch 4/5, ValAcc: 18.44%, TrainLoss: 3.4658, ValLoss: 3.3817, LR: 0.001
[2025-07-24 23:41:19,060] [INFO] Epoch 5/5, ValAcc: 21.69%, TrainLoss: 3.3395, ValLoss: 3.2217, LR: 0.001
[2025-07-24 23:41:21,478] [INFO] Namespace(path=['meta-free-apps/meta-tcp_dataofs/meta-tcp_dataofs.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_dataofs.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_dataofs.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dataofs', name='tcpdataofs_power_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.2228,0.2179,0.2580,0.2234
[2025-07-24 23:41:47,785] [INFO] Feature 0 normalized using power
[2025-07-24 23:41:47,786] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:41:47,810] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:41:47,810] [INFO] Training...
[2025-07-24 23:42:08,972] [INFO] Epoch 1/5, ValAcc: 1.67%, TrainLoss: 4.5036, ValLoss: 4.4979, LR: 0.001
[2025-07-24 23:42:30,260] [INFO] Epoch 2/5, ValAcc: 4.36%, TrainLoss: 4.4372, ValLoss: 4.2852, LR: 0.001
[2025-07-24 23:42:54,017] [INFO] Epoch 3/5, ValAcc: 6.84%, TrainLoss: 4.2121, ValLoss: 4.1090, LR: 0.001
[2025-07-24 23:43:15,468] [INFO] Epoch 4/5, ValAcc: 8.83%, TrainLoss: 4.0736, ValLoss: 3.9710, LR: 0.001
[2025-07-24 23:43:37,622] [INFO] Epoch 5/5, ValAcc: 10.08%, TrainLoss: 3.9586, ValLoss: 3.8788, LR: 0.001
[2025-07-24 23:43:40,132] [INFO] Namespace(path=['meta-free-apps/meta-tcp_dataofs/meta-tcp_dataofs.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_dataofs.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_dataofs.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dataofs', name='tcpdataofs_power_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.1070,0.0836,0.1035,0.1065
[2025-07-24 23:44:06,441] [INFO] Feature 0 normalized using power
[2025-07-24 23:44:06,441] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:44:06,471] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:44:06,472] [INFO] Training...
[2025-07-24 23:44:50,295] [INFO] Epoch 1/5, ValAcc: 5.14%, TrainLoss: 4.4198, ValLoss: 4.2692, LR: 0.001
[2025-07-24 23:45:34,605] [INFO] Epoch 2/5, ValAcc: 8.44%, TrainLoss: 4.1623, ValLoss: 4.0293, LR: 0.001
[2025-07-24 23:46:15,946] [INFO] Epoch 3/5, ValAcc: 8.02%, TrainLoss: 4.0806, ValLoss: 4.0227, LR: 0.001
[2025-07-24 23:46:58,274] [INFO] Epoch 4/5, ValAcc: 14.04%, TrainLoss: 3.8411, ValLoss: 3.6280, LR: 0.001
[2025-07-24 23:47:42,179] [INFO] Epoch 5/5, ValAcc: 16.53%, TrainLoss: 3.6519, ValLoss: 3.4948, LR: 0.001
[2025-07-24 23:47:46,858] [INFO] Namespace(path=['meta-free-apps/meta-tcp_dataofs/meta-tcp_dataofs.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_dataofs.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_dataofs.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dataofs', name='tcpdataofs_power_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.1689,0.1529,0.1845,0.1699
[2025-07-24 23:48:13,081] [INFO] Feature 0 normalized using power
[2025-07-24 23:48:13,082] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:48:13,104] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:48:13,104] [INFO] Training...
[2025-07-24 23:48:34,661] [INFO] Epoch 1/5, ValAcc: 2.52%, TrainLoss: 4.4889, ValLoss: 4.4512, LR: 0.001
[2025-07-24 23:48:56,144] [INFO] Epoch 2/5, ValAcc: 3.42%, TrainLoss: 4.4139, ValLoss: 4.3557, LR: 0.001
[2025-07-24 23:49:17,681] [INFO] Epoch 3/5, ValAcc: 5.67%, TrainLoss: 4.3061, ValLoss: 4.2445, LR: 0.001
[2025-07-24 23:49:38,991] [INFO] Epoch 4/5, ValAcc: 5.89%, TrainLoss: 4.2442, ValLoss: 4.1914, LR: 0.001
[2025-07-24 23:50:00,458] [INFO] Epoch 5/5, ValAcc: 6.33%, TrainLoss: 4.2030, ValLoss: 4.1740, LR: 0.001
[2025-07-24 23:50:01,390] [INFO] Namespace(path=['meta-free-apps/meta-tcp_dataofs/meta-tcp_dataofs.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_dataofs.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_dataofs.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dataofs', name='tcpdataofs_power_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0666,0.0450,0.0421,0.0656
[2025-07-24 23:50:27,738] [INFO] Feature 0 normalized using power
[2025-07-24 23:50:27,738] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-24 23:50:27,753] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Linear(in_features=1, out_features=128, bias=True)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-24 23:50:27,753] [INFO] Training...
[2025-07-24 23:50:43,374] [INFO] Epoch 1/5, ValAcc: 0.91%, TrainLoss: 4.5134, ValLoss: 4.5122, LR: 0.001
[2025-07-24 23:50:58,965] [INFO] Epoch 2/5, ValAcc: 0.91%, TrainLoss: 4.5116, ValLoss: 4.5123, LR: 0.001
[2025-07-24 23:51:15,487] [INFO] Epoch 3/5, ValAcc: 1.04%, TrainLoss: 4.5120, ValLoss: 4.5123, LR: 0.001
[2025-07-24 23:51:37,262] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5123, LR: 0.001
[2025-07-24 23:51:59,667] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5107, ValLoss: 4.5124, LR: 0.0005
[2025-07-24 23:52:01,157] [INFO] Namespace(path=['meta-free-apps/meta-tcp_dataofs/meta-tcp_dataofs.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['power'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_dataofs.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_dataofs.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='dataofs', name='tcpdataofs_power_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-24 23:52:01,341] [INFO] best(dataofs): bigru, accuracy: 0.2228, f1: 0.2179, precision: 0.2580, recall: 0.2234
[INFO] tcp_chksum → Best normalization: token
Running: python vrscanner.py --step2 --path meta-free-apps/meta-tcp_chksum/meta-tcp_chksum.csv --norm token --debug_path output/meta-free-apps/step2/step2_meta_tcp_chksum.debug --leaderboard_path output/meta-free-apps/step2/step2_meta_tcp_chksum.csv
[2025-07-24 23:52:04,664] [INFO] Namespace(path=['meta-free-apps/meta-tcp_chksum/meta-tcp_chksum.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_chksum.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_chksum.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='chksum')
[2025-07-24 23:59:04,841] [INFO] Processed data from meta-free-apps/meta-tcp_chksum/meta-tcp_chksum.csv:
[2025-07-24 23:59:04,841] [INFO] (84492, 500)
[2025-07-24 23:59:04,841] [INFO] [['2068' '41411' '18148' ... '37587' '1701' '34460']
 ['25780' '15074' '4277' ... '33082' '51130' '61461']
 ['57731' '61081' '55057' ... '61252' '14160' '14160']
 ...
 ['19379' '32169' '5845' ... '55570' '63296' '13801']
 ['49176' '41396' '53038' ... '5044' '53168' '61622']
 ['41597' '62950' '62451' ... '57283' '29685' '32759']]
[2025-07-25 00:00:08,882] [INFO] Feature 0 normalized using token
[2025-07-25 00:00:08,883] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-25 00:00:08,964] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(65537, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-25 00:00:08,964] [INFO] Training...
[2025-07-25 00:00:33,597] [INFO] Epoch 1/5, ValAcc: 1.92%, TrainLoss: 4.5025, ValLoss: 4.4887, LR: 0.001
[2025-07-25 00:00:48,740] [INFO] Epoch 2/5, ValAcc: 1.86%, TrainLoss: 4.4909, ValLoss: 4.4828, LR: 0.001
[2025-07-25 00:01:03,886] [INFO] Epoch 3/5, ValAcc: 1.53%, TrainLoss: 4.4753, ValLoss: 4.4935, LR: 0.001
[2025-07-25 00:01:19,042] [INFO] Epoch 4/5, ValAcc: 1.61%, TrainLoss: 4.4258, ValLoss: 4.5299, LR: 0.001
[2025-07-25 00:01:34,263] [INFO] Epoch 5/5, ValAcc: 1.31%, TrainLoss: 4.2645, ValLoss: 4.8002, LR: 0.001
[2025-07-25 00:01:35,630] [INFO] Namespace(path=['meta-free-apps/meta-tcp_chksum/meta-tcp_chksum.csv'], pktcount=500, importance=False, kfold=1, model=['gru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_chksum.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_chksum.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='chksum', name='tcpchksum_token_gru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0139,0.0048,0.0045,0.0137
[2025-07-25 00:02:39,888] [INFO] Feature 0 normalized using token
[2025-07-25 00:02:39,888] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-25 00:02:39,957] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(65537, 128)
  )
  (rnn_layers): ModuleList(
    (0): GRU(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-25 00:02:39,957] [INFO] Training...
[2025-07-25 00:03:07,490] [INFO] Epoch 1/5, ValAcc: 1.83%, TrainLoss: 4.5072, ValLoss: 4.4903, LR: 0.001
[2025-07-25 00:03:37,226] [INFO] Epoch 2/5, ValAcc: 1.92%, TrainLoss: 4.4917, ValLoss: 4.4811, LR: 0.001
[2025-07-25 00:04:08,971] [INFO] Epoch 3/5, ValAcc: 1.79%, TrainLoss: 4.4798, ValLoss: 4.4939, LR: 0.001
[2025-07-25 00:04:40,784] [INFO] Epoch 4/5, ValAcc: 1.55%, TrainLoss: 4.4584, ValLoss: 4.4997, LR: 0.001
[2025-07-25 00:05:12,580] [INFO] Epoch 5/5, ValAcc: 1.30%, TrainLoss: 4.4337, ValLoss: 4.5226, LR: 0.001
[2025-07-25 00:05:15,000] [INFO] Namespace(path=['meta-free-apps/meta-tcp_chksum/meta-tcp_chksum.csv'], pktcount=500, importance=False, kfold=1, model=['bigru'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_chksum.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_chksum.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='chksum', name='tcpchksum_token_bigru_500_32_5_0.001_128_128_3_0.3_128_128'),0.0107,0.0030,0.0055,0.0112
[2025-07-25 00:06:19,404] [INFO] Feature 0 normalized using token
[2025-07-25 00:06:19,405] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-25 00:06:19,473] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(65537, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-25 00:06:19,473] [INFO] Training...
[2025-07-25 00:06:47,120] [INFO] Epoch 1/5, ValAcc: 1.94%, TrainLoss: 4.4995, ValLoss: 4.4863, LR: 0.001
[2025-07-25 00:07:15,007] [INFO] Epoch 2/5, ValAcc: 1.91%, TrainLoss: 4.4901, ValLoss: 4.4853, LR: 0.001
[2025-07-25 00:07:42,721] [INFO] Epoch 3/5, ValAcc: 1.75%, TrainLoss: 4.4690, ValLoss: 4.5018, LR: 0.001
[2025-07-25 00:08:10,668] [INFO] Epoch 4/5, ValAcc: 1.82%, TrainLoss: 4.4052, ValLoss: 4.5496, LR: 0.001
[2025-07-25 00:08:34,237] [INFO] Epoch 5/5, ValAcc: 1.48%, TrainLoss: 4.2728, ValLoss: 4.7549, LR: 0.001
[2025-07-25 00:08:36,716] [INFO] Namespace(path=['meta-free-apps/meta-tcp_chksum/meta-tcp_chksum.csv'], pktcount=500, importance=False, kfold=1, model=['lstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_chksum.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_chksum.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='chksum', name='tcpchksum_token_lstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0128,0.0042,0.0040,0.0129
[2025-07-25 00:09:40,644] [INFO] Feature 0 normalized using token
[2025-07-25 00:09:40,644] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-25 00:09:40,713] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(65537, 128)
  )
  (rnn_layers): ModuleList(
    (0): LSTM(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-25 00:09:40,714] [INFO] Training...
[2025-07-25 00:10:23,689] [INFO] Epoch 1/5, ValAcc: 2.00%, TrainLoss: 4.5002, ValLoss: 4.4856, LR: 0.001
[2025-07-25 00:11:06,802] [INFO] Epoch 2/5, ValAcc: 2.22%, TrainLoss: 4.4887, ValLoss: 4.4860, LR: 0.001
[2025-07-25 00:11:50,078] [INFO] Epoch 3/5, ValAcc: 1.81%, TrainLoss: 4.4617, ValLoss: 4.4977, LR: 0.001
[2025-07-25 00:12:33,724] [INFO] Epoch 4/5, ValAcc: 1.23%, TrainLoss: 4.3921, ValLoss: 4.5548, LR: 0.001
[2025-07-25 00:13:17,237] [INFO] Epoch 5/5, ValAcc: 1.25%, TrainLoss: 4.2013, ValLoss: 4.8841, LR: 0.0005
[2025-07-25 00:13:21,907] [INFO] Namespace(path=['meta-free-apps/meta-tcp_chksum/meta-tcp_chksum.csv'], pktcount=500, importance=False, kfold=1, model=['bilstm'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_chksum.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_chksum.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='chksum', name='tcpchksum_token_bilstm_500_32_5_0.001_128_128_3_0.3_128_128'),0.0128,0.0038,0.0047,0.0124
[2025-07-25 00:14:25,805] [INFO] Feature 0 normalized using token
[2025-07-25 00:14:25,806] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-25 00:14:25,875] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(65537, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=128, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-25 00:14:25,875] [INFO] Training...
[2025-07-25 00:14:42,194] [INFO] Epoch 1/5, ValAcc: 1.50%, TrainLoss: 4.5122, ValLoss: 4.5096, LR: 0.001
[2025-07-25 00:14:53,572] [INFO] Epoch 2/5, ValAcc: 1.48%, TrainLoss: 4.5070, ValLoss: 4.5036, LR: 0.001
[2025-07-25 00:15:04,832] [INFO] Epoch 3/5, ValAcc: 1.72%, TrainLoss: 4.5003, ValLoss: 4.4938, LR: 0.001
[2025-07-25 00:15:16,097] [INFO] Epoch 4/5, ValAcc: 1.89%, TrainLoss: 4.4951, ValLoss: 4.4920, LR: 0.001
[2025-07-25 00:15:27,344] [INFO] Epoch 5/5, ValAcc: 1.76%, TrainLoss: 4.4926, ValLoss: 4.4887, LR: 0.001
[2025-07-25 00:15:28,274] [INFO] Namespace(path=['meta-free-apps/meta-tcp_chksum/meta-tcp_chksum.csv'], pktcount=500, importance=False, kfold=1, model=['rnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_chksum.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_chksum.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='chksum', name='tcpchksum_token_rnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0182,0.0016,0.0009,0.0183
[2025-07-25 00:16:32,081] [INFO] Feature 0 normalized using token
[2025-07-25 00:16:32,081] [INFO] Train shape: (59143, 500), Val shape: (8450, 500), Test shape: (16899, 500)
[2025-07-25 00:16:32,148] [INFO] Classifier: VRScannerModel(
  (input_modules): ModuleList(
    (0): Embedding(65537, 128)
  )
  (rnn_layers): ModuleList(
    (0): RNN(128, 128, num_layers=3, batch_first=True, dropout=0.3, bidirectional=True)
  )
  (attn_nets): ModuleList(
    (0): Sequential(
      (0): Linear(in_features=256, out_features=64, bias=True)
      (1): Tanh()
      (2): Linear(in_features=64, out_features=1, bias=True)
    )
  )
  (projection_layers): ModuleList(
    (0): Linear(in_features=256, out_features=128, bias=True)
  )
  (feature_attn_net): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=91, bias=True)
  )
)
[2025-07-25 00:16:32,148] [INFO] Training...
[2025-07-25 00:16:50,058] [INFO] Epoch 1/5, ValAcc: 0.97%, TrainLoss: 4.5126, ValLoss: 4.5121, LR: 0.001
[2025-07-25 00:17:07,943] [INFO] Epoch 2/5, ValAcc: 1.04%, TrainLoss: 4.5111, ValLoss: 4.5119, LR: 0.001
[2025-07-25 00:17:25,828] [INFO] Epoch 3/5, ValAcc: 1.04%, TrainLoss: 4.5100, ValLoss: 4.5107, LR: 0.001
[2025-07-25 00:17:43,720] [INFO] Epoch 4/5, ValAcc: 0.98%, TrainLoss: 4.5110, ValLoss: 4.5121, LR: 0.001
[2025-07-25 00:18:03,600] [INFO] Epoch 5/5, ValAcc: 0.98%, TrainLoss: 4.5111, ValLoss: 4.5124, LR: 0.001
[2025-07-25 00:18:05,092] [INFO] Namespace(path=['meta-free-apps/meta-tcp_chksum/meta-tcp_chksum.csv'], pktcount=500, importance=False, kfold=1, model=['birnn'], norm=['token'], attention=False, input_dim=128, hidden_size=128, num_layers=3, dropout=0.3, fusion_dim=128, fc_hidden_size=128, batch_size=32, epoch=5, lr=0.001, debug_path='output/meta-free-apps/step2/step2_meta_tcp_chksum.debug', leaderboard_path='output/meta-free-apps/step2/step2_meta_tcp_chksum.csv', step1=False, step2=True, step3=False, train=False, longitudinal_evaluation=False, openworld_evaluation=False, device=device(type='cuda'), metadata='chksum', name='tcpchksum_token_birnn_500_32_5_0.001_128_128_3_0.3_128_128'),0.0102,0.0002,0.0001,0.0110
[2025-07-25 00:18:06,089] [INFO] best(chksum): gru, accuracy: 0.0139, f1: 0.0048, precision: 0.0045, recall: 0.0137
=== Step2. Script Execution Finished at Fri Jul 25 12:18:07 AM UTC 2025 ===
